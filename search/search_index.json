{"config":{"lang":["fr"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Services Web","text":"<p>Bienvenue sur le site du cours de Services Web de l'hiver 2024 du c\u00e9gep de Victoriaville. Cette plateforme se veut un compl\u00e9ment au groupe Teams du m\u00eame cours. Vous y retrouverez les notes de cours et les diff\u00e9rents exercices. Nous ajoutons continuellement du nouveau contenu, assurez-vous donc de revenir nous voir souvent.</p>"},{"location":"#pour-joindre-votre-enseignant","title":"Pour joindre votre enseignant","text":"<p>Mathieu Fr\u00e9chette</p><p>frechette.mathieu@cegepvicto.ca</p>"},{"location":"#un-peu-dhumour","title":"Un peu d'humour","text":""},{"location":"evaluation/epreuve_finale/","title":"\u00c9preuve finale","text":""},{"location":"evaluation/epreuve_finale/#enonce-de-lepreuve","title":"\u00c9nonc\u00e9 de l\u2019\u00e9preuve","text":"<p>Vous devez d\u00e9velopper seul un service web selon les sp\u00e9cifications d\u00e9crites plus bas et l\u2019int\u00e9grer dans un site Web cod\u00e9 avec React.</p>"},{"location":"evaluation/epreuve_finale/#contexte-de-realisation","title":"Contexte de r\u00e9alisation","text":"<ul> <li>Le d\u00e9veloppement se fera durant le temps en classe et hors classe.</li> <li>Date limite de remise : Jeudi le 11 mai \u00e0 17:05</li> <li>La remise se fera par Github. Vous pouvez me faire un repo pour le service web et un autre pour le site ou bien me jumeler les deux dans le m\u00eame.</li> <li>Pour la base de donn\u00e9es, me faire un dump avec cr\u00e9ation de tables et inclure le   fichier dans le projet du service web.</li> </ul>"},{"location":"evaluation/epreuve_finale/#specification-de-lepreuve","title":"Sp\u00e9cification de l\u2019\u00e9preuve","text":""},{"location":"evaluation/epreuve_finale/#le-service-web","title":"Le service Web","text":"<p>Le sujet du service web est \u00e0 votre choix, mais il doit r\u00e9pondre aux crit\u00e8res suivants.</p> <ol> <li>Le d\u00e9veloppement doit se faire en PHP avec le framework SLIM.</li> <li>La structure du projet doit respecter une s\u00e9paration entre la logique et les donn\u00e9es.</li> <li>Vous devez cr\u00e9er des routes pour couvrir les m\u00e9thodes HTTP suivantes: GET, POST, PUT, DELETE.</li> <li>Les routes doivent retourner le bon code d\u2019\u00e9tat selon leur m\u00e9thode et la situation. (200, 201,    403, etc.). Fiez-vous aux notes de cours pour la convention qu'on utilise dans le cours.</li> <li>Toutes les routes cr\u00e9\u00e9es doivent \u00eatre document\u00e9es selon la norme openAPI qu\u2019on a vue en    classe.</li> <li>Les routes doivent \u00eatre prot\u00e9g\u00e9es par un syst\u00e8me d\u2019authentification par \"bearer token\" avec cl\u00e9 d'api. La cl\u00e9 d'api doit \u00eatre associ\u00e9 \u00e0 un usager dans votre base de donn\u00e9e.</li> <li>Cr\u00e9ez une route qui permettra, en envoyant un code d'usager et un mot de passe encod\u00e9, de g\u00e9n\u00e9rer une nouvelle cl\u00e9 api si l'usager existe dans votre base de donn\u00e9es et que le mot de passe est valide. </li> </ol>"},{"location":"evaluation/epreuve_finale/#le-client-web","title":"Le client Web","text":"<ol> <li>Le client web doit utiliser React pour l\u2019affichage et la gestion des    op\u00e9rations avec le service web.</li> <li>Il permettra de se connecter \u00e0 votre service web et d\u2019interagir avec les routes.</li> <li>L\u2019utilisateur devra pouvoir utiliser votre site web pour interagir avec les routes que vous avez d\u00e9finies dans votre service web. Encore une fois vous devez au minimum permettre interaction avec une route GET, POST, PUT et DELETE. </li> <li>Le site web doit aussi utiliser une seconde API que vous n\u2019avez pas d\u00e9velopp\u00e9e. \u00c7a peut    \u00eatre une API publique (m\u00e9t\u00e9o, \"Random User\", \"Unsplash\", etc.) ou bien l\u2019api d\u2019un autre \u00e9l\u00e8ve.</li> <li>Ajouter une section \u00e0 votre page o\u00f9 l'usager pourra inscrire un code usager et un mot de passe. Ensuite, en cliquant sur un bouton, un appel sera fait \u00e0 votre route pour g\u00e9n\u00e9rer une nouvelle cl\u00e9 et elle sera affich\u00e9e dans votre page.</li> <li>L\u2019aspect esth\u00e9tique ne sera pas \u00e9valu\u00e9, je veux que \u00e7a fonctionne avant tout.</li> </ol>"},{"location":"evaluation/epreuve_finale/#grille-de-correction","title":"Grille de correction","text":"Crit\u00e8res pond\u00e9ration Partie #1 - Le service Web /60 Une route est cr\u00e9\u00e9, est fonctionnelle et retourne le bon code d'\u00e9tat pour chacune des m\u00e9thodes suivantes : GET, POST, PUT, DELETE (10 points par route) /40 Toutes les routes sont document\u00e9es selon la norme openAPI. /5 Toutes les routes sont prot\u00e9g\u00e9es par un syst\u00e8me d\u2019authentification de votre choix par cl\u00e9 d'api. /5 Une route permet de demander une nouvelle cl\u00e9 en sp\u00e9cifiant un code usager et un mot de passe valide. /10 Partie #2 - Client React /40 \u00c0 l'aide de votre site web, l'utilisateur peut interagir avec les routes que vous avez d\u00e9finies dans votre service web. (6 points par route) /24 Le site web utilise une seconde API que vous n\u2019avez pas d\u00e9velopp\u00e9. /6 L'interface permet de g\u00e9n\u00e9rer une nouvelle cl\u00e9 pour un usager /10 Total /100"},{"location":"exercices/01_utilisation_api/","title":"Exercice 01 - Utilisation d\u2019un service web","text":"<p>Utilisez Postman et la documentation en lien pour faire les requ\u00eates suivantes. </p>"},{"location":"exercices/01_utilisation_api/#1-bored-api","title":"1 Bored API","text":"<p>Documentation : https://www.boredapi.com/documentation</p> <p>Requ\u00eates</p> <ul> <li> Affichez l\u2019activit\u00e9 dont la cl\u00e9 est 6482790</li> <li> Affichez une activit\u00e9 de type \u00ab cooking \u00bb avec 2 participants</li> </ul>"},{"location":"exercices/01_utilisation_api/#2-chucknorrisio","title":"2 Chucknorris.io","text":"<p>Documentation : https://api.chucknorris.io/</p> <p>Requ\u00eates</p> <ul> <li> Combien il y a de cat\u00e9gorie au total?</li> <li> Combien de blagues contiennent le mot \"beer\"?</li> </ul>"},{"location":"exercices/01_utilisation_api/#3-imgflip","title":"# 3 ImgFlip","text":"<p>Documentation : https://imgflip.com/api</p> <p>Note</p> <p>Vous devez vous cr\u00e9er un compte sur imgflip pour pouvoir utiliser l'api.</p> <p>Requ\u00eates</p> <ul> <li> Cr\u00e9ez un meme de votre choix.</li> <li> Enregistrez votre chef d'oeuvre sous le format NomPrenom.jpg et t\u00e9l\u00e9versez le sur Teams dans le dossier de l'exercice 01 dans le groupe du cours. </li> </ul> <p>Astuce</p> <ul> <li>Commencez par trouver l'identifiant de l'image de base (template_id) que vous allez utiliser (il y a une route pour \u00e7a)</li> <li>Utilisez la route /caption_image pour cr\u00e9er votre meme en utilisant les bonnes informations</li> <li>Attention \u00e0 la m\u00e9thode de la route</li> <li>Les informations doivent \u00eatre envoy\u00e9es dans le corps de la requ\u00eate au format x-www-form-urlencoded</li> </ul> <p></p>"},{"location":"exercices/02_serverweb_node/","title":"Exercice 02 - Serveur web avec Node.js","text":"<p>Cr\u00e9ez un serveur web en Node.js, vous pouvez vous inspirer des exemples dans les notes de cours.</p> <p>Le serveur doit pouvoir r\u00e9cup\u00e9rer la valeur du param\u00eatre <code>code</code> dans l'url envoy\u00e9. Par exemple si j'envoie <code>localhost:3000/?code=1</code> la valeur est 1.</p> <p>Ajoutez l'objet JavaScript suivant \u00e0 votre code : </p> <pre><code>const professeurs = {\n    1: { nom: \"Fr\u00e9chette\", prenom: \"Mathieu\"},\n    2: { nom: \"Lagac\u00e9\", prenom: \"Christiane\" },\n    3: { nom: \"Trottier\", prenom: \"S\u00e9bastien\" },\n    4: { nom: \"Tousignant\", prenom: \"Simon\" },\n    5: { nom: \"Mercier\", prenom: \"Fran\u00e7ois\" },\n    6: { nom: \"Croteau\", prenom: \"Carine\" },\n    7: { nom: \"Taleb\", prenom: \"Fr\u00e9d\u00e9rik\" },\n    8: { nom: \"Ouellet\", prenom: \"Alexandre\" },\n}\n</code></pre> <p>Maintentant quand le serveur re\u00e7oit une url : </p> <ul> <li>Si le param\u00e8tre <code>code</code> est pr\u00e9sent, affichez le pr\u00e9nom et le nom du professeur correspondant \u00e0 sa valeur. Le texte retourn\u00e9 sera \"Bonjour pr\u00e9nom nom\" dans une balise H1 et le code de statut sera 200.</li> <li>Si le param\u00e8tre est absent ou bien que la valeur n'est pas pr\u00e9sente dans l'objet, affichez \"Professeur non trouv\u00e9\" dans une balise H1. Le code de statut sera 404.</li> </ul> <p>Changez la valeur du Content-Type pour que le format de la r\u00e9ponse soit du html.</p> <p>Installez nodemon et configurez votre projet pour pouvoir le lancer avec la commande <code>npm dev</code>.</p> <p>Installer le module dotenv et modifiez votre code pour que la valeur du port \u00e0 utiliser soit stock\u00e9e dans un fichier .env.</p>"},{"location":"exercices/02_serverweb_node/#gestion-des-routes","title":"Gestion des routes","text":"<p>Maintenant que vous avez un serveur web qui fonctionne, on va l'am\u00e9liorer un peu avec une gestion basique de route.</p> <ul> <li>Quand on n'entre que l'h\u00f4te ou bien la route <code>/</code>, affichez en html \"Bienvenue \u00e0 mon premier api\" dans une balise h1</li> <li>Quand on entre la route <code>/professeurs</code>, reprenez le code de la premi\u00e8re partie. Donc si j'entre <code>localhost:3000/professeurs?code=1</code> la r\u00e9ponse sera \"Bonjour Mathieu Fr\u00e9chette\" dans une balise H1.</li> <li>Quand j'entre la route <code>/professeurs/tous</code> je retourne en json l'objet professeurs.</li> </ul> <p>Astuce</p> <p>Utilisez la fonction JSON.stringify() pour convertir un objet en JSON. Dans les notes de cours sur le format JSON vous avez des exemples.</p>"},{"location":"exercices/03_hello_world_api/","title":"Exercice 03 - HelloWorldApi","text":"<p>On va cr\u00e9er notre premi\u00e8re api en PHP avec le framework en partant d'un template github. Quoi de mieux qu'un Hello World pour commencer...</p>"},{"location":"exercices/03_hello_world_api/#installation","title":"Installation","text":"<ul> <li>Devilbox</li> <li>Composer - https://getcomposer.org/</li> </ul>"},{"location":"exercices/03_hello_world_api/#description-des-routes","title":"Description des routes","text":"M\u00e9thode Route Description GET / Message de bienvenue GET /greetings Afficher une salutation al\u00e9atoire"},{"location":"exercices/03_hello_world_api/#creation-du-repertoire-du-projet","title":"Cr\u00e9ation du r\u00e9pertoire du projet","text":"<p>Cr\u00e9ez un nouveau d\u00e9p\u00f4t \u00e0 partir de celui-ci : https://github.com/Services-Web-Victo/ex03-helloworldapi. Clonez le ensuite dans le r\u00e9pertoire www de devilbox et faites le n\u00e9cessaire pour que \u00e7a fonctionne. En entrant l'url de votre projet vous devriez avoir un message de bienvenue.</p>"},{"location":"exercices/03_hello_world_api/#creation-de-la-base-de-donnees-et-insertion-des-donnees","title":"Cr\u00e9ation de la base de donn\u00e9es et insertion des donn\u00e9es","text":"<ol> <li>Dans le r\u00e9pertoire resources/sql roulez le fichier helloworld_insertdata.sql dans la base de donn\u00e9e </li> </ol>"},{"location":"exercices/03_hello_world_api/#ajout-des-informations-de-connexion","title":"Ajout des informations de connexion","text":"<p>Modifier les informations de connexion \u00e0 la base de donn\u00e9es dans le fichier config/settings.php</p>"},{"location":"exercices/03_hello_world_api/#point-1-route-a-ajouter","title":"Point #1 Route \u00e0 ajouter","text":"M\u00e9thode Route Description GET /languages Afficher la liste de toutes les langues <p>Ajoutez la route /languages qui va afficher la liste de toutes les langues pr\u00e9sentent dans la base de donn\u00e9es, avec le code de la langue et sa description. Ajoutez aussi le nombre de langues totales. La r\u00e9ponse devra est format\u00e9 comme suit : </p> <pre><code>{\n  \"langues\": [\n    {\n      \"code\": \"de\",\n      \"langue\": \"Allemand\"\n    },\n    {\n      \"code\": \"en\",\n      \"langue\": \"Englais\"\n    },\n    {\n      \"code\": \"es\",\n      \"langue\": \"Espagnol\"\n    },\n    {\n      \"code\": \"fr\",\n      \"langue\": \"Fran\u00e7ais\"\n    }\n  ],\n  \"total\": 4\n}\n</code></pre>"},{"location":"exercices/03_hello_world_api/#point-2-ajout-dun-parametre-a-une-route","title":"Point #2 Ajout d'un param\u00e8tre \u00e0 une route","text":"M\u00e9thode Route Description GET /greetings?language=[fr,en,es,de] Afficher une salutation al\u00e9atoire <p>En vous servant de la route /greetings ajoutez la possibilit\u00e9 d'inclure le param\u00e8tre language pour sp\u00e9cifier dans quelle langue on veut avoir notre message. Les valeurs possibles sont : </p> <ul> <li>fr : Fran\u00e7ais</li> <li>en : Anglais</li> <li>es : Espagnol</li> <li>de : Allemand</li> </ul> <pre><code>/greetings?langue=fr\n</code></pre> <p>Vous avez la m\u00e9thode pour r\u00e9cup\u00e9rer le param\u00e8tre dans les notes de cours ici</p> <p>Si l'usager entre un code inexistant, le message de retour sera \"Aucune salutation trouv\u00e9e, bonjour quand-m\u00eame\"</p> <p>La r\u00e9ponse devra \u00eatre format\u00e9e de la fa\u00e7on suivante (la valeur de code est la donn\u00e9e extrait de la base de donn\u00e9es et non du param\u00e8tre, m\u00eame si elle est pareil):  <pre><code>{\n    \"code\":\"fr\",\n    \"message\":\"Bonjour le monde\"\n}\n</code></pre></p>"},{"location":"exercices/03_hello_world_api/#point-3-ajouter-une-salutation","title":"Point #3 Ajouter une salutation","text":"<p>Ajoutez la route suivante qui va permettre d'ajouter une salutation dans la base de donn\u00e9es.</p> M\u00e9thode Route Description POST /greetings Afficher une salutation al\u00e9atoire <p>Les donn\u00e9es seront envoy\u00e9es en param\u00e8tre dans le corps de la requ\u00eate. <pre><code>{\n  \"code\" : \"fr\",\n  \"message\" : \"Ceci est mon nouveau message en fran\u00e7ais\"\n}\n</code></pre></p> <p>Si le code de la langue n'est pas pr\u00e9sent dans la base de donn\u00e9es, annuler l'ajout et retournez le message suivant :  <pre><code>{\n  \"id\" : null,\n  \"erreur\" : \"Le code de la langue est inexistant\"\n}\n</code></pre></p> <p>Si l'ajout du message fonctionne, retournez la r\u00e9ponse suivante :  <pre><code>{\n  \"id\" : Le id du nouvel enregistrement,\n  \"code\" : \"Le code de la langue du message\",\n  \"message\" : \"Le message ajout\u00e9\" \n}\n</code></pre></p> <p>Extrait de code pour vous aider avec le point #3</p> <p>Fonction pour ajouter le message dans la base de donn\u00e9es et retourner le id <pre><code>/**\n  * Ajoute un message de salutation\n  * \n  * @param int $langueId Le id du code de langue \n  * @param string $message Le message \u00e0 ajouter\n  *\n  * @return int Le id du message ajout\u00e9\n  */\npublic function insertGreeting(int $langueId, string $message): int\n{\n    $row = [\n        'langue_id' =&gt; $langueId,\n        'message' =&gt; $message\n    ];\n\n    $sql = \"INSERT INTO salutations SET \n            langue_id=:langue_id, \n            message=:message\";\n\n    $this-&gt;connection-&gt;prepare($sql)-&gt;execute($row);\n\n    return (int)$this-&gt;connection-&gt;lastInsertId();\n}\n</code></pre></p>"},{"location":"exercices/03_hello_world_api/#corrige","title":"Corrig\u00e9","text":"<ul> <li>Voici ma version de l'exercice : https://github.com/Services-Web-Victo/ex03-helloworldapi_final</li> </ul>"},{"location":"exercices/04_imdb/","title":"Exercice 04 - IMDB","text":"<p>Pour cet exercice nous allons travailler avec les 1000 films les mieux not\u00e9s sur IMDB. M\u00eame si le sujet est assez simple, nous allons cr\u00e9er une api un peu plus \u00e9toffer gr\u00e2ce au framework SLIM. Cet exercice va \u00eatre utiliser sur plusieurs cours, on va y int\u00e9grer petit \u00e0 petit plusieurs notions essentielles, alors il est important de suivre chaque \u00e9tape et de les compl\u00e9ter.</p>"},{"location":"exercices/04_imdb/#prerequis","title":"Pr\u00e9requis","text":"<ul> <li>Devilbox, Ampps ou une autre \"stack\" incluant au minimum Apache, MySQL et PHP) -  https://ampps.com/</li> <li>Composer - https://getcomposer.org/</li> </ul>"},{"location":"exercices/04_imdb/#installation","title":"Installation","text":"<ul> <li>Cr\u00e9ez un nouveau d\u00e9p\u00f4t \u00e0 partir de celui-ci : https://github.com/Services-Web-Victo/ex04-depart</li> <li>Roulez la commande <code>composer update</code> dans le r\u00e9pertoire de votre projet.</li> <li>Cr\u00e9ez le fichier config/env.php en copiant le fichier config/env.exemple.php et modifiez les informations de connexion \u00e0 la base de donn\u00e9es dans le fichier config/env.php.</li> <li>Roulez le script <code>ressource/sql/insertData.sql</code> dans la base de donn\u00e9es que vous allez utiliser pour l'exercice.</li> </ul>"},{"location":"exercices/04_imdb/#test-de-linstallation","title":"Test de l'installation","text":"<p>Vous devriez avoir acc\u00e8s maintenant aux routes suivantes. Testez les avec Postman et un navigateur pour la route de la documentation.</p> M\u00e9thode Route Description GET / Message de bienvenue GET /docs Documentation de l'api GET /film Liste de tous les films"},{"location":"exercices/04_imdb/#structure-du-projet","title":"Structure du projet","text":"<ul> <li>/config</li> <li>Bootstrap.php<ul> <li>Point d\u2019entr\u00e9e</li> </ul> </li> <li>Routes.php<ul> <li>C\u2019est ici qu\u2019on va d\u00e9finir les routes </li> </ul> </li> <li>Settings.php et env.php<ul> <li>Constantes de configuration. Par exemple les informations pour se connecter \u00e0 la bd</li> </ul> </li> <li>Container.php<ul> <li>Fonctions \u201cinject\u00e9es\u201d dans le constructeur.</li> </ul> </li> <li> <p>Middleware.php</p> <ul> <li>Code qui s\u2019execute automatiquement avant ou apr\u00e8s les requ\u00eates. (Authentication)</li> </ul> </li> <li> <p>/src</p> </li> <li>/action<ul> <li>Les controlleurs, un fichier par \u201caction\u201d</li> </ul> </li> <li>/domain<ul> <li>/nom_du_modele</li> <li>S\u00e9parer la logique application de l\u2019acc\u00e8s aux donn\u00e9es</li> <li>/Repository<ul> <li>Acc\u00e8s aux donn\u00e9es</li> </ul> </li> <li>/Service<ul> <li>Logique de l\u2019api.</li> <li>Chaque classe doit n\u2019avoir qu\u2019une seule responsabilit\u00e9e</li> </ul> </li> </ul> </li> </ul> <p>La route appelle une classe action, ensuite le bon service est appel\u00e9. Le service va chercher les donn\u00e9es avec la classe repository correspondante.</p>"},{"location":"exercices/04_imdb/#exercices","title":"Exercices","text":""},{"location":"exercices/04_imdb/#premiere-partie-routes","title":"Premi\u00e8re partie - Routes","text":"<p>Cr\u00e9ez les routes suivantes pour agr\u00e9menter la gestion de films. Voir plus bas pour le format de chaque r\u00e9ponse : </p> M\u00e9thodes Route Description GET /film/{id} Lister seulement le film avec le id en param\u00e8tre POST /film Ajouter un film avec les informations dans le \"body\" de la requ\u00eate PUT /film/{id} Modifier un film avec le id en param\u00e8tre et les informations dans le \"body\" DELETE /film/{id} Supprimer le film avec le id en param\u00e8tre <ul> <li>Pour chaque route, cr\u00e9ez une classe \"action\", \"service\" et \"repository\". </li> <li>Retourner aussi les bons codes de statut, voir la section \"Utiliser les codes de statut HTTP\" dans les bonnes pratiques.</li> <li>Testez ensuite vos routes avec Postman.</li> </ul> <p>Film \u00e0 utiliser pour l'ajout</p> <p>Vous pouvez utiliser les informations suivantes pour cr\u00e9er un nouveau film (Attention : augmenter la taille de la colonne genre \u00e0 varchar(200)): </p> <pre><code>{\n  \"poster_link\": \"https://www.imdb.com/title/tt0091369/mediaviewer/rm2649548544/?ref_=tt_ov_i\",\n  \"series_title\": \"Labyrinth\",\n  \"released_year\": 1986,\n  \"certificate\": \"PG\",\n  \"runtime\": \"101 min\",\n  \"genre\": \"Adventure, Family, Fantasy, Musical\",\n  \"imdb_rating\": 7.3,\n  \"overview\": \"Sixteen-year-old Sarah is given thirteen hours to solve a labyrinth and rescue her baby brother Toby when her wish for him to be taken away is granted by the Goblin King Jareth.\",\n  \"meta_score\": 50,\n  \"director\": \"Jim Henson\",\n  \"star1\": \"David Bowie\",\n  \"star2\": \"Jennifer Connelly\",\n  \"star3\": \"Toby Froud\",\n  \"star4\": \"Shelley Thompson\",\n  \"no_of_votes\": 140392,\n  \"gross\": \"13,915,874\"\n}\n</code></pre> <p>Format des r\u00e9ponses</p> <p>Pour les 4 routes \u00e0 ajouter, on va retourner l'objet \"film\" au complet apr\u00e8s l'op\u00e9ration faite. (ex. le film apr\u00e8s la modification, le film qui vient d'\u00eatre supprim\u00e9, etc.) <pre><code>{\n  \"id\": 1001,\n  \"poster_link\": \"https://m.media-amazon.com/images/M/MV5BMDFkYTc0MGEtZmNhMC00ZDIzLWFmNTEtODM1ZmRlYWMwMWFmXkEyXkFqcGdeQXVyMTMxODk2OTU@._V1_UX67_CR0,0,67,98_AL_.jpg\",\n  \"series_title\": \"The Shawshank Redemption\",\n  \"released_year\": 1994,\n  \"certificate\": \"A\",\n  \"runtime\": \"142 min\",\n  \"genre\": \"Drama\",\n  \"imdb_rating\": 9.3,\n  \"overview\": \"Two imprisoned men bond over a number of years, finding solace and eventual redemption through acts of common decency.\",\n  \"meta_score\": 80,\n  \"director\": \"Frank Darabont\",\n  \"star1\": \"Tim Robbins\",\n  \"star2\": \"Morgan Freeman\",\n  \"star3\": \"Bob Gunton\",\n  \"star4\": \"William Sadler\",\n  \"no_of_votes\": 2343110,\n  \"gross\": \"28,341,469\"\n}\n</code></pre></p>"},{"location":"exercices/04_imdb/#deuxieme-partie-filtre-et-pagination","title":"Deuxi\u00e8me partie - Filtre et pagination","text":"<p>\u00c0 l'aide des notes de cours sur les bonnes pratiques de conception d'un api, ajouter les options de filtre et de pagination pour la route <code>GET /film</code> qui affiche la liste de tous les livres.</p> <ul> <li>Le filtre se fera sur la colonne genre de la table imdb_top, ex <code>/film?genre=Fantasy</code></li> <li>Pour la pagination, l'usager ne pourra que choisir la page \u00e0 afficher. Par d\u00e9faut on va afficher 50 films par page et si aucun num\u00e9ro de page n'est fournis, on va afficher la page 1. Ex: <code>/film?page=2</code></li> <li>Bien sur on va pouvoir combiner les deux param\u00e8tres comme ceci : <code>/film?genre=Fantasy&amp;page=1</code></li> </ul> <p>Modifiez la r\u00e9ponse pour y ajouter les informations suivantes : </p> <ul> <li>genre : La valeur qu'on a pass\u00e9 en param\u00e8tre, si aucune laisser vide <code>\"genre\"  : \"\",</code></li> <li>nombreFilms : Le nombre total de films selon le filtre appliqu\u00e9.</li> <li>page : La valeur du param\u00e8tre, si aucun inscrire 1.</li> <li>totalPage : Le nombre de pages au total, le nombre de films total divis\u00e9 par le nombre de film par page (50) arrondis \u00e0 l'entier sup\u00e9rieur.</li> </ul> <pre><code>{\n    \"movies\" : [\n        {\n          ...\n        },\n        {\n          ...\n        }\n    ],\n    \"genre\" : \"Fantasy\",\n    \"nombreFilmsTotal\" : 66,\n    \"page\" : 1,\n    \"totalPage\" : 2\n}\n</code></pre> <p>Pour d\u00e9couper le r\u00e9sultat en page, vous pouvez utiliser LIMIT et OFFSET dans la requ\u00eate SQL ou bien array_slice sur le tableau de r\u00e9sultat de la requ\u00eate qui aurait d\u00e9j\u00e0 filtr\u00e9 les films. (Vous faites une requ\u00eate qui filtre les films selon le genre et ensuite utilisez array_slice sur le r\u00e9sultat en PHP).</p>"},{"location":"exercices/04_imdb/#troisieme-partie-utilisation-de-monolog","title":"Troisi\u00e8me partie - Utilisation de Monolog","text":"<p>\u00c0 l'aide des notes de cours sur l'utilisation de Monolog, faites en sorte qu'\u00e0 chaque fois qu'on supprime un film, un message d'\u00e9v\u00e9nement s'inscrit dans un fichier de log avec les configurations suivantes : </p> <ul> <li>Nom du fichier de log : MoviesLog</li> <li>Identification du message : deleteMovie</li> <li>Niveau de s\u00e9v\u00e9rit\u00e9 : INFO</li> <li>Message : \"Le film \"titre_du_film\" id [id_du_film] a \u00e9t\u00e9 supprim\u00e9.\"</li> </ul> <p>Exemple de r\u00e9sultat</p> <pre><code>[2022-02-11T06:43:08.169802+01:00] deleteMovie.INFO: Le film \"Labyrinth\" id [1001] a \u00e9t\u00e9 supprim\u00e9.\n</code></pre>"},{"location":"exercices/04_imdb/#quatrieme-partie-documentation","title":"Quatri\u00e8me partie - Documentation","text":"<p>Cr\u00e9ez la documentation pour les routes d\u00e9j\u00e0 existantes. \u00c0 partir de maintenant, pour chaque route que nous allons ajouter, on va cr\u00e9er en m\u00eame temps la documentation.</p> <ul> <li>Renommez le fichier de documentation resources/docs/base_slim_skeleton_v1.yaml pour imdb_api.yaml. C'est dans ce fichier que vous allez \u00e9crire la documentation. Il y a d\u00e9j\u00e0 du code dans se fichier que j'ai laiss\u00e9 en exemple. Vous pourrez le supprimer quand il ne vous sera plus n\u00e9cessaire.</li> <li>Modifiez le code du fichier src/Action/Docs/SwaggerUiAction.php pour que la variable $yamlFile fasse r\u00e9f\u00e9rence \u00e0 votre fichier renomm\u00e9.</li> <li>En vous inspirant de ce qui est d\u00e9j\u00e0 pr\u00e9sent dans le fichier de documentation et du site swagger.io, r\u00e9digez la documentation pour les 4 routes que vous avez cr\u00e9\u00e9 dans la premi\u00e8re partie.</li> <li>Une fois termin\u00e9 elle devrait apparaitre dans la page affich\u00e9 quand vous utilisez la route <code>/docs</code></li> </ul>"},{"location":"exercices/04_imdb/#cinquieme-partie-middleware","title":"Cinqui\u00e8me partie - Middleware","text":"<p>Faites le n\u00e9cessaire pour qu'\u00e0 chaque requ\u00eate HTTP vers votre projet, les informations suivantes soient inscrite dans un fichier de log (utilisez le nom de fichier que vous voulez): </p> <ul> <li>L'identificateur de la ligne sera RouteLogMiddleware</li> <li>Le niveau de s\u00e9v\u00e9rit\u00e9 est INFO</li> <li>Ensuite ajoutez la m\u00e9thode HTTP (GET, POST, PUT, PATCH, DELETE) utilis\u00e9e</li> <li>Suivra le nom de la route, les param\u00e8tres de la section \"query\" s'il y en a et le contenu du body</li> <li>Attention, l'appel \u00e0 votre middleware doit se faire avant la ligne <code>$app-&gt;addBodyParsingMiddleware();</code> dans le fichier <code>config\\middleware.php</code></li> </ul> <p>Exemple</p> <pre><code>[2023-03-01T21:08:01.186402+01:00] RouteLogMiddleware.INFO: [200] GET /   \n[2023-03-01T21:08:05.876724+01:00] RouteLogMiddleware.INFO: [200] GET /film/1074   \n[2023-03-01T21:08:09.243410+01:00] RouteLogMiddleware.INFO: [200] GET /film?page=1&amp;genre=Romance,Comedy   \n[2023-03-01T21:08:28.284023+01:00] RouteLogMiddleware.INFO: [200] PUT /film/2024 {\"poster_link\":\"https:\\/\\/www.imdb.com\\/title\\/tt0091369\\/mediaviewer\\/rm2649548544\\/?ref_=tt_ov_i\",\"series_title\":\"Labyrinth 2 - Return of the Goblin King\",\"released_year\":1986,\"certificate\":\"PG\",\"runtime\":\"101 min\",\"genre\":\"Adventure, Family, Fantasy, Musical\",\"imdb_rating\":7.3,\"overview\":\"Sixteen-year-old Sarah is given thirteen hours to solve a labyrinth and rescue her baby brother Toby when her wish for him to be taken away is granted by the Goblin King Jareth.\",\"meta_score\":50,\"director\":\"Jim Henson\",\"star1\":\"David Bowie\",\"star2\":\"Jennifer Connelly\",\"star3\":\"Toby Froud\",\"star4\":\"Shelley Thompson\",\"no_of_votes\":140392,\"gross\":\"13,915,874\"}  \n</code></pre> <p>Quelques pistes de solution</p> <ul> <li>Cr\u00e9er un fichier php dans le r\u00e9pertoire src/Middleware qui contiendra votre code</li> <li>Invoquer cette classe au niveau de l'application</li> <li>Dans votre classe \"middleware\", n'oubliez pas d'inclure un constructeur qui va initialiser le \"LoggerFactory\"</li> <li>La structure de la fonction <code>__invoke()</code> de la classe devrait ressembler \u00e0 ceci : </li> </ul> <p><pre><code>public function __invoke(\n    Request $request, \n    RequestHandler $handler): Response\n{\n    // Cette ligne ex\u00e9cute la requ\u00eate\n    $response = $handler-&gt;handle($request);\n\n    // Votre code pour r\u00e9cup\u00e9rer les informations\n    ...\n\n    // Vous logger ensuite les informations dans le fichier de log\n\n    return $response;\n}\n</code></pre> Les informations qu'on peut r\u00e9cup\u00e9rer de la requ\u00eate (m\u00e9thode HTTP, uri, contenu du \"body\") et de la r\u00e9ponse (code de statut)</p> <ul> <li>https://www.slimframework.com/docs/v4/objects/request.html</li> <li>https://www.slimframework.com/docs/v4/objects/response.html</li> </ul> <p>Pour que le contenu de la requ\u00eate soit affich\u00e9, vous devez l'encoder en json avant de l'ajouter dans le log : </p> <ul> <li><code>$contenuRequete = json_encode($request-&gt;getParsedBody());</code></li> </ul>"},{"location":"exercices/04_imdb/#corrige","title":"Corrig\u00e9","text":"<p>Vous pouvez consulter ma version de l'exercice ici : https://github.com/Services-Web-Victo/ex04-corrige. Je vais la mettre \u00e0 jour au fil des cours.</p>"},{"location":"exercices/05_apikey/","title":"Exercice 05 - S\u00e9curit\u00e9 avec cl\u00e9 API","text":"<p>Pour cet exercice, utilisez l'api que vous avez cr\u00e9\u00e9 \u00e0 l'exercice 4. Vous allez impl\u00e9menter une protection de sorte que pour certaines routes de votre api l'utilisateur devra inclure une cl\u00e9 api valide.</p>"},{"location":"exercices/05_apikey/#modification-a-la-base-de-donnees","title":"Modification \u00e0 la base de donn\u00e9es","text":"<p>Dans le but de nous simplifier le d\u00e9veloppement, on va prendre pour acquis qu'il y a d\u00e9j\u00e0 un syst\u00e8me de cr\u00e9ation d'usager en place. </p> <p>Cr\u00e9ez une nouvelle table dans la base de donn\u00e9es nommm\u00e9e users avec les champs suivants : </p> champs description id La cl\u00e9 primaire code Le code d'usager, une adresse courriel, doit \u00eatre UNIQUE non nulle password Le mot de passe hash\u00e9 (voir plus bas) un champ texte d'au moins 256 caract\u00e8res non nulle api_key Un champ texte d'au moins 256 caract\u00e8res qui peut \u00eatre nulle mais doit \u00eatre UNIQUE. <p>Ajoutez quelques usagers dans votre table en vous servant de l'extrait de code suivant pour \"hash\u00e9\" le mot de passe et g\u00e9n\u00e9rer le script d'insertion SQL : </p> <pre><code>&lt;?php\n\n// Le nom de votre table usager\n$nomTable = \"users\";\n// Liste des usagers \u00e0 ajouter\n$users = [\n        [\"code\" =&gt; \"frechette.mathieu@cegepvicto.ca\", \"password\" =&gt; \"qwerty\"],\n        [\"code\" =&gt; \"math.frechette@gmail.com\", \"password\" =&gt; \"1234\"],\n    ];\n\n\n$scriptSQL = \"INSERT INTO $nomTable(code, password, api_key) VALUES \";\n\nforeach($users as $user) {\n    $scriptSQL .= \"('\" . $user['code'] . \"', '\" . password_hash($user['password'], PASSWORD_DEFAULT) . \"', null),\";\n}\n\n\necho substr($scriptSQL, 0, -1) . \";\";\n</code></pre> <p>Je vous conseille de rouler ce code dans un \u00e9diteur de code PHP en ligne tel que https://onlinephp.io/ pour r\u00e9cup\u00e9rer facilement le r\u00e9sultat.</p>"},{"location":"exercices/05_apikey/#ajout-dune-route-pour-obtenir-une-cle-api","title":"Ajout d'une route pour obtenir une cl\u00e9 api","text":"<p>Maintenant qu'on a une table dans la base de donn\u00e9es avec une liste d'usager, on va cr\u00e9er une nouvelle route qui va permettre \u00e0 un usager de demander une cl\u00e9 api.</p> M\u00e9thode Route DEscription GET /cle?nouvelle=true Retourne la cl\u00e9 api de l'usager. S'il n'y en a pas de cr\u00e9\u00e9, en g\u00e9n\u00e8re une. Si le param\u00e8tre \"nouvelle\" est ajout\u00e9 et est \u00e9gale \u00e0 1, g\u00e9n\u00e8re une nouvelle cl\u00e9 m\u00eame s'il y en a d\u00e9j\u00e0 une. <ul> <li>Les informations de l'usager (nom d'usager et mot de passe) doivent \u00eatre incluses dans l'ent\u00eate de la requ\u00eate sous le format d'une authentification basique.(Voir les notes de cours sur les authentifications HTTP).</li> <li>Veillez \u00e0 encoder les informations en base64. (Regardez la fonction base64_encode en PHP) Encore une fois servez-vous d'un \u00e9diteur de PHP en ligne pour g\u00e9n\u00e9rer votre jeton encod\u00e9.</li> <li>Quand on g\u00e9n\u00e8re une cl\u00e9, on va l'enregistrer dans la table users \u00e0 la colonne api_key.</li> <li>Pour le format de la cl\u00e9, \u00e0 vous de choisir la fa\u00e7on dont vous allez la g\u00e9n\u00e9rer. Je vous rappelle parcontre qu'elle doit \u00eatre unique. </li> <li>Si la cl\u00e9 est cr\u00e9\u00e9 ou bien simplement affich\u00e9e, retournez le code de statut 200. Par contre si l'usager et/ou le mot de passe est invalide, retournez le code 403 et aucune r\u00e9ponse.</li> </ul> <p>La r\u00e9ponse en cas de succ\u00e8s sera la suivante: </p> <pre><code>{\n    \"api_key\" : \"la_valeur_de_ma_cle\"\n}\n</code></pre>"},{"location":"exercices/05_apikey/#protection-des-routes-par-un-middleware","title":"Protection des routes par un middleware","text":"<p>Cr\u00e9ez un middleware qui va s'assurer que la cl\u00e9 api qu'on envoie avec la requ\u00eate est valide. Dans votre api, toute les routes devront \u00eatre prot\u00e9g\u00e9 par le middleware \u00e0 l'exception de la route qui permet d'obtenir une cl\u00e9 que vous venez de cr\u00e9er. La cl\u00e9 devra \u00eatre incluse dans l'ent\u00eate de la requ\u00eate sous le format suivant : </p> <p><code>Authorization : api_key la_valeur_de_ma_cle</code></p> <ul> <li>Validez simplement que la cl\u00e9 existe bien dans la table users de la base de donn\u00e9es.</li> <li>Si la cl\u00e9 existe, laisser passer la requ\u00eate.</li> <li>Sinon, retourne le code de statut 403 et la r\u00e9ponse suivante : </li> </ul> <pre><code>{\n    \"erreur\" : \"La cl\u00e9 est invalide. Acc\u00e8s non autoris\u00e9\"\n}\n</code></pre>"},{"location":"exercices/05_apikey/#limiter-le-nombre-de-requetes-optionnel","title":"Limiter le nombre de requ\u00eates (optionnel)","text":"<p>Mettez en place un syst\u00e8me pour limiter le nombre de requ\u00eates par jour et par cl\u00e9 api. Si l'usager d\u00e9passe le nombre de requ\u00eates permise, retourner un message d'erreur avec le code de statut 403. La validation se fera uniquement sur les routes <code>GET /film</code> et <code>GET /film/{id}</code>.</p>"},{"location":"exercices/06_react_component/","title":"Exercice 06 - Composants et props","text":""},{"location":"exercices/06_react_component/#installation","title":"Installation","text":"<ul> <li>Cr\u00e9er un nouveau projet React nomm\u00e9 mybooks (en minuscule).</li> <li>Remplacez le code du fichier <code>App.js</code> par celui-ci</li> </ul> <p><pre><code>import logo from './logo.svg';\nimport './App.css';\nimport React from 'react';\n\nclass App extends React.Component {\n  render(){\n\n    return (\n      &lt;div className=\"App\"&gt;\n      &lt;header className=\"App-header\"&gt;\n          &lt;h1&gt;MyBooks&lt;/h1&gt;\n\n          &lt;h3&gt;Liste des livres&lt;/h3&gt;\n\n          &lt;table className=\"BooksTable\"&gt;\n            &lt;thead&gt;\n              &lt;tr&gt;\n                &lt;th&gt;id&lt;/th&gt;\n                &lt;th&gt;Titre&lt;/th&gt;\n              &lt;/tr&gt;\n            &lt;/thead&gt;\n            &lt;tbody&gt;\n              &lt;tr&gt;\n                &lt;td&gt;1&lt;/td&gt;\n                &lt;td&gt;Fondation&lt;/td&gt;\n              &lt;/tr&gt;\n              &lt;tr&gt;\n                &lt;td&gt;2&lt;/td&gt;\n                &lt;td&gt;Les montagnes hallucin\u00c3\u00a9es&lt;/td&gt;\n              &lt;/tr&gt;\n              &lt;tr&gt;\n                &lt;td&gt;3&lt;/td&gt;\n                &lt;td&gt;Blade Runner&lt;/td&gt;\n              &lt;/tr&gt;\n            &lt;/tbody&gt;\n          &lt;/table&gt;\n      &lt;/header&gt;\n    &lt;/div&gt;\n    );\n  }\n}\n\nexport default (App);\n</code></pre> - Au d\u00e9but de la fonction render() de la classe App, ajoutez le tableau suivant d'objets \"livre\".</p> <pre><code>const books = [\n    {id:1, titre:'Fondation'},\n    {id:2, titre:'Les montagnes hallucin\u00e9es'},\n    {id:3, titre:'Blade Runner'}\n];\n</code></pre> <ul> <li>Ajoutez les lignes suivante \u00e0 la fin du fichier <code>App.css</code> </li> </ul> <pre><code>.BooksTable th, .BooksTable td {\n  text-align: left;\n  padding-right: 15px;\n}\n</code></pre> <p>Maintenant lancer l'application avec la commande <code>npm start</code> et vous devriez avoir ce r\u00e9sultat</p> <p></p>"},{"location":"exercices/06_react_component/#a-faire-ensuite","title":"\u00c0 faire ensuite","text":"<ul> <li> <p>Cr\u00e9ez les composantes suivantes dans des fichiers s\u00e9par\u00e9s situ\u00e9s dans le r\u00e9pertoire <code>src/components</code></p> </li> <li> <p>Une composante <code>Titre</code> qui va remplacer la balise <code>&lt;h3&gt;</code> dans le fichier <code>App.js</code>. Elle recevra un param\u00e8tre <code>texte</code> qui sera le texte \u00e0 afficher. La composante retournera une balise <code>&lt;h3&gt;</code> avec la valeur du param\u00e8tre re\u00e7u.</p> </li> <li> <p>Une composante nomm\u00e9e  <code>Tableau</code>. Cette composante va remplacer la balise <code>&lt;table&gt;</code> dans le fichier <code>App.js</code>. Elle recevra un param\u00e8tre <code>livres</code> qui est le tableau de livres qu\u2019on a d\u00e9fini plus haut. Elle va retourner le code html pour afficher le tableau.</p> </li> <li> <p>Une composante <code>LigneTableau</code>. Cette composante va \u00eatre utilis\u00e9 dans la composante <code>Tableau</code> pour afficher une ligne du tableau. Elle recevra un param\u00e8tre <code>livre</code> qui repr\u00e9sente un objet du tableau livres. Elle va retourner le code html pour afficher un ligne du tableau (une balise <code>&lt;tr&gt;</code> et son contenu) avec les valeurs re\u00e7ues en param\u00e8tres.</p> </li> <li> <p>Modifiez le fichier <code>App.js</code> pour utiliser les composantes cr\u00e9\u00e9s.</p> </li> </ul>"},{"location":"exercices/07_react_state/","title":"Exercice 07 - L'\u00e9tat local","text":"<p>Pour mettre en pratique ce qu'on a vu \u00e0 propos de l'\u00e9tat local d'un composant (l'objet state), nous allons cr\u00e9er les trois composant suivant qui vont interagir entre eux en modifiant les titres de chacun.</p> <p></p>"},{"location":"exercices/07_react_state/#mise-en-place","title":"Mise en place","text":"<p>Vous devez cr\u00e9er les trois composants suivant : </p> <ul> <li>MainBox</li> <li>MiddleBox</li> <li>EditBox</li> </ul> <p>Chaque composante contient le suivant (MainBox est le parent de MiddleBox qui est lui-m\u00eame parent de EditBox). Je vous donne une partie du code HTML que la fonction render() va retourner ainsi que le style css.</p> <p>App.js</p> <pre><code>import './App.css';\nimport MainBox from './MainBox';\n\nfunction App() {\n  return (\n    &lt;div className=\"App\"&gt;\n        &lt;MainBox /&gt;\n    &lt;/div&gt;\n  );\n}\n\nexport default App;\n</code></pre> <p>MainBox.js</p> <pre><code>render() {\n    return (\n        &lt;div className='box'&gt;\n            &lt;h1&gt;{this.state.boxTitle}&lt;/h1&gt;\n            &lt;div className='box_saisie box_saisie_main'&gt;\n                &lt;label htmlFor='titreMainBox'&gt;Titre Box &lt;/label&gt;\n                &lt;input\n                    type=\"text\"\n                    id=\"titreMainBox\"\n                    name=\"titreMainBox\"\n                    /&gt;\n            &lt;/div&gt;\n\n            &lt;MiddleBox /&gt;\n\n        &lt;/div&gt;\n    );\n}\n</code></pre> <p>MiddleBox.js</p> <pre><code>render() {\n    return (\n        &lt;div className='box'&gt;\n            &lt;h2&gt;{this.state.boxTitle}&lt;/h2&gt;\n            &lt;div className='box_saisie box_saisie_middle'&gt;\n                &lt;label htmlFor='titreMiddleBox'&gt;Titre Box &lt;/label&gt;\n                &lt;input\n                    type=\"text\"\n                    id=\"titreMiddleBox\"\n                    name=\"titreMiddleBox\"\n                    /&gt;\n            &lt;/div&gt;\n\n            &lt;EditBox /&gt;\n        &lt;/div&gt;\n    );\n}\n</code></pre> <p>EditBox.js</p> <pre><code>render() {\n    return (\n        &lt;div className='box'&gt;\n            &lt;h3&gt;{this.state.boxTitle}&lt;/h3&gt;\n            &lt;div&gt;\n                &lt;div className='box_saisie'&gt;\n                    &lt;label htmlFor='titreMainBox'&gt;Titre MainBox &lt;/label&gt;\n                    &lt;input\n                        type=\"text\"\n                        id=\"titreMainBox\"\n                        name=\"titreMainBox\"\n                    /&gt;\n                &lt;/div&gt;\n\n                &lt;div className='box_saisie'&gt;\n                    &lt;label htmlFor='titreMiddleBox'&gt;Titre MiddleBox &lt;/label&gt;\n                    &lt;input\n                        type=\"text\"\n                        id=\"titreMiddleBox\"\n                        name=\"titreMiddleBox\"\n                    /&gt;    \n                &lt;/div&gt;\n\n                &lt;div className='box_saisie'&gt;\n                    &lt;label htmlFor='boxTitle'&gt;Titre EditBox &lt;/label&gt;\n                    &lt;input\n                        type=\"text\"\n                        id=\"boxTitle\"\n                        name=\"boxTitle\"\n                    /&gt;\n                &lt;/div&gt;\n            &lt;/div&gt;\n        &lt;/div&gt;\n    );\n}\n</code></pre> <p>App.css</p> <pre><code>.App {\n  text-align: center;\n  background-color: #282c34;\n  min-height: 100vh;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  font-size: calc(10px + 2vmin);\n  color: white;\n}\n\n.box {\n  border: 2px solid #61dafb;\n  padding: 10px;\n  border-radius: 5px;\n}\n\n.box_saisie {\n  display: flex;\n  justify-content: space-between;\n  padding-bottom: 2px;\n  gap: 10px\n}\n\n.box_saisie_main {\n  padding: 0 20px 10px 20px;\n}\n\n.box_saisie_middle {\n  padding: 0 10px 10px 10px;\n}\n\nh1, h2, h3 {\n  margin: 20px 0;\n}\n</code></pre>"},{"location":"exercices/07_react_state/#instruction","title":"Instruction","text":"<ul> <li>D\u00e8s qu'on modifie la valeur d'une des zones de saisie, le texte doit \u00eatre modifi\u00e9 dans tous les champs correspondants (zone de saisie, titre). Ex si je modifie dans le composant EditBox la valeur dans le champ de saisie pour le composant MainBox, la valeur sera aussi modifi\u00e9 dans le champ de saisie du composant MainBox ainsi que son titre.</li> <li>Compl\u00e9tez les fonctions render() de chaque composant avec ce qui manque et ajouter les fonctions de retour au bon endroit.</li> <li>Inspirez-vous des notes de cours, toutes les r\u00e9ponses y sont.</li> </ul>"},{"location":"exercices/08_axios/","title":"Exercice 08 - Consommer une api avec Axios","text":"<p>En vous inspirant de l'affichage pr\u00e9sent\u00e9 sur le site https://randomuser.me/, cr\u00e9ez une application React qui affichera certaines informations d'un utilisateur obtenu gr\u00e2ce \u00e0 un appel \u00e0 l'api du m\u00eame site.</p>"},{"location":"exercices/08_axios/#instructions","title":"Instructions","text":"<ul> <li>Cr\u00e9ez un nouveau projet avec Create React App que vous nommerez ex08_nom_prenom et faite le n\u00e9cessaire pour le relier \u00e0 un d\u00e9p\u00f4t Github sur votre compte personnelle.</li> <li>\u00c0 l'affichage et au rafraichissement de la page, votre application doit faire un appel \u00e0 l'api de RandomUser et afficher les informations obtenues dans un composant \"carte\".</li> <li>Je vous laisse \"d\u00e9couper\" la carte en composant comme bon vous semble mais \u00e7a vous prends minimalement les composants suivants : </li> <li><code>Card</code> : Le composant \"maitre\" qui va englober les autres et qui fera l'appel \u00e0 l'api de RandomUser.</li> <li><code>Avatar</code> : Il s'occupe d'afficher uniquement la photo.</li> <li> <p><code>Information</code> : La zone du bas o\u00f9 sont affich\u00e9 les informations de l'usager</p> </li> <li> <p>Le composant <code>Card</code> doit \u00eatre autonome, c'est-\u00e0-dire que si je l'inclus 2 fois dans la page, deux appels diff\u00e9rent \u00e0 l'api seront fait.</p> </li> <li>Consulter la documentation du site https://randomuser.me/api/ pour conna\u00eetre l'url \u00e0 utiliser et connaitre le format de la r\u00e9ponse.</li> <li>Dans la section information, affichez le message \"Salut, je m'appelle \" et en dessous le nom r\u00e9cup\u00e9r\u00e9 de l'api.</li> <li>Faites en sorte que lorque vous cliquez sur l'image de l'utilisateur, la carte se rafraichisse et affiche un nouvel utilisateur.</li> <li>(Optionnel) Ajoutez des icones comme sur l'image plus bas et quand on clique sur l'une d'elles, l'information affich\u00e9e sous la photo sera modifi\u00e9e en cons\u00e9quence. R\u00e9f\u00e9rez-vous \u00e0 l'affichage fait sur https://randomuser.me/.</li> <li>Une fois l'exercice termin\u00e9, poussez votre projet sur GitHub et retournez le devoir Teams associ\u00e9 avec l'url de votre d\u00e9p\u00f4t.</li> </ul> <p>Exemple de r\u00e9sultat</p> <p></p>"},{"location":"exercices/09_react_form/","title":"Exercice 9 - Les formulaires en React","text":"<p>\u00c0 partir de l'application React que vous avez cr\u00e9\u00e9 dans l'exercice 06 et de l'api que je vais vous fournir, vous allez cr\u00e9er un composant React de gestion de livre.</p>"},{"location":"exercices/09_react_form/#instructions","title":"Instructions","text":"<p>Modifiez le projet que vous aviez fait pour l'exercice 06 ou bien cr\u00e9ez un nouveau projet avec Create React App.</p>"},{"location":"exercices/09_react_form/#liste-des-routes-a-votre-disposition","title":"Liste des routes \u00e0 votre disposition","text":"<p>Voici les routes qui vous permettront de faire la gestion de la base de donn\u00e9e de livres. L'adresse du serveur est <code>https://api.mathieufrechette.ca/exreact</code></p> M\u00e9thode Route Description GET /livre La liste de tous les livres. POST /livre Ajouter un livre. PUT /livre/{id} Modification ou cr\u00e9ation d'un livre selon un id DELETE /livre/{id} Suppression d'un livre selon son id <p>Pour les routes POST et PUT, vous devez inclure les informations suivantes dans le corps de la requ\u00eate : </p> <pre><code>{\n    \"titre\" : \"Le titre du livre\"\n}\n</code></pre>"},{"location":"exercices/09_react_form/#creation-des-composants","title":"Cr\u00e9ation des composants","text":"<p>Vous devez segmenter l'interface de gestion des livres en composantes de la fa\u00e7on suivante : </p> <ul> <li>GestionLivre : Composante principale, c'est ici que les modifications \u00e0 la base de donn\u00e9es seront faites.</li> <li>FormGestionLivre : Composante \"formulaire\", affiche les contr\u00f4les n\u00e9cessaires \u00e0 l'ajout, la modification ou la suppression d'un livre.</li> <li>ListeLivre : Affiche la liste des tous les livres dans un tableau HTML. (Vous pourriez r\u00e9utiliser les composantes Tableau et LigneTableau que vous aviez cr\u00e9\u00e9 \u00e0 l'exercice 06)</li> </ul>"},{"location":"exercices/09_react_form/#composition-du-formulaire","title":"Composition du formulaire","text":"<p>Le formulaire du composant <code>FormGestionLivre</code> comporte trois boutons : Nouveau, Enregistrer, et Supprimer ainsi qu'un input pour saisir le titre du livre. </p> Bouton Comportement Nouveau Efface les donn\u00e9es pr\u00e9sentent dans les contr\u00f4les du formulaire. Enregistrer Cr\u00e9e ou modifie les donn\u00e9es selon le cas Supprimer On supprime l'enregistrement dans la base de donn\u00e9es"},{"location":"exercices/09_react_form/#fonctionnement-de-lapplication","title":"Fonctionnement de l'application","text":"<p>Quand on clique sur une des lignes de la liste des livres du composant <code>ListeLivre</code>, les donn\u00e9es s'affichent dans le formulaire. On peut ensuite les modifier ou supprimer l'enregistrement en cliquant sur les boutons appropri\u00e9s. La liste des livres doit se mettre \u00e0 jour automatiquement sans devoir refaire un appel \u00e0 l'api.</p>"},{"location":"exercices/09_react_form/#exemple-de-visuel","title":"Exemple de visuel","text":""},{"location":"exercices/09_react_form/#aide","title":"Aide","text":"<p>Voici pour vous aider la structure de mes composantes avec des commentaires sur le fonctionnement : </p> <ul> <li>GestionLivre.js</li> <li>FormGestionLivre.js</li> <li>Tableau.js</li> <li>LigneTableau.js</li> </ul>"},{"location":"exercices/09_react_form_aide/","title":"Exercice 9 - Les formulaires en React - Aide","text":"<p>Voici pour vous aider les diff\u00e9rentes composantes que j'ai utilis\u00e9 avec des commentaires sur le fonctionnement : </p> <p>GestionLivre.js <pre><code>import React from 'react';\nimport FormGestionLivre from './FormGestionLivre';\nimport Tableau from './Tableau';\nimport './GestionLivre.css';\n\n\nclass GestionLivre extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            // Un tableau d'objets qui va contenir tous les livres de la BD\n            livres: [],\n            // Un objet \"livre\" qui indique le livre pr\u00e9sentement s\u00e9lectionn\u00e9. Si le id est nulle alors aucun livre n'est s\u00e9lectionn\u00e9.\n            // Me sert \u00e0 d\u00e9terminer quelle action effectuer quand je clique sur enregistrer et quel livre supprimer quand on clique sur \n            // le bouton supprimer\n            livreSelect: {id: null, titre: \"\"}\n        };\n    }\n\n    componentDidMount() {\n        // S\u00e9lectionner la liste de livres par un appel \u00e0 l'api\n        // Sur un succ\u00e8s, mettre \u00e0 jour la liste de livres dans l'\u00e9tat\n    }\n\n    /**\n     * Change le livre qui est s\u00e9lectionn\u00e9\n     * @param {*} livre Objet qui contient la cl\u00e9 id et titre\n     */\n    changeLivreSelect = (livre) =&gt; {\n        // Changer la valeur de livreSelect dans l'\u00e9tat pour la valeur re\u00e7u en param\u00eatre\n    };\n\n    videLivreSelect = () =&gt; {\n        // Efface la valeur de livreSelect dans l'\u00e9tat (met la valeur de id \u00e0 null et le titre \u00e0 rien)\n    };\n\n    sauvegardeModification = () =&gt; {\n        // S'il y a un livre de s\u00e9lectionn\u00e9, lance la fonction de modification, sinon lance la fonction d'ajout d'un nouveau livre\n    }\n\n    ajouterUnLivre = () =&gt; {\n        // Ajout un nouveau livre dans la BD par un appel \u00e0 l'api\n        // Sur un succ\u00e8s, r\u00e9cup\u00e8re le nouveau livre dans la r\u00e9ponse de la requ\u00eate\n        // Ajoute se livre dans la liste de livres de l'\u00e9tat\n        // Efface la valeur de livreSelect dans l'\u00e9tat\n    }\n\n    modifierUnLivre = () =&gt; {\n        // Modifie le livre s\u00e9lectionn\u00e9 par un appel \u00e0 l'api\n        // Le id et le nouveau titre du livre \u00e0 modifier son d\u00e9j\u00e0 dans l'objet livreSelect de l'\u00e9tat\n        // Sur un succ\u00e8s, modifie l'item de listeLivre qui correspond au livre modifi\u00e9 par le nouveau titre\n        // Efface la valeur de livreSelect dans l'\u00e9tat\n    }\n\n    supprimerUnLivre = () =&gt; {\n        // Supprime le livre s\u00e9lectionn\u00e9 par un appel \u00e0 l'api\n        // Sur un succ\u00e8s, enl\u00e8ve le livre de la liste de livres de l'\u00e9tat\n        // Efface la valeur de livreSelect dans l'\u00e9tat\n    }\n\n\n    render() {\n\n        return (\n            &lt;section&gt;\n                {/* Composant avec le input box et les boutons */}\n                &lt;FormGestionLivre              \n                    // Valeur du livre s\u00e9lectionn\u00e9\n                    livreSelect={this.state.livreSelect}\n                    // La fonction pour modifier le livre s\u00e9lectionn\u00e9, je vais m'en servir \u00e0 chaque modification du input box\n                    changerLivreSelect={this.changeLivreSelect}\n                    // La fonction pour effacer la valeur du livre s\u00e9lectionn\u00e9, je vais la relier au bouton nouveau\n                    nouveau={this.videLivreSelect}\n                    // La fonction reli\u00e9e au bouton enregistrer\n                    sauvegarder={this.sauvegardeModification}\n                    // La fonction pour supprimer un livre\n                    supprimer={this.supprimerUnLivre} /&gt;\n\n                &lt;h3&gt;Liste des livres&lt;/h3&gt;\n\n                {/* Composant qui sert \u00e0 afficher la liste de livres sous forme de tableau */}\n                &lt;Tableau \n                    // La liste de livres de l'\u00e9tat\n                    livres={this.state.livres} \n                    // La fonction pour modifier le livre s\u00e9lectionn\u00e9, je vais m'en servir \u00e0 chaque fois que je clique sur une ligne de livre\n                    changerLivreSelect={this.changeLivreSelect} /&gt;    \n\n            &lt;/section&gt;\n        );\n    }\n}\n\nexport default GestionLivre;\n</code></pre></p>"},{"location":"exercices/10_meme_generator/","title":"Exercice 10 - G\u00e9n\u00e9rateur de meme","text":"<p>\u00c0 l'aide de l'api de ImgFlip vous devez creer un g\u00e9n\u00e9rateur de \"meme\" en react.</p>"},{"location":"exercices/10_meme_generator/#instructions","title":"Instructions","text":"<ul> <li>Cr\u00e9ez un nouveau projet avec Create React App pour cet exercice.</li> <li>Vous allez aussi devoir vous cr\u00e9er un compte gratuit sur le site de ImgFlip : https://imgflip.com/.</li> <li>Notez bien votre nom d'usager et votre mot de passe, vous allez en avoir besoin pour utiliser l'api.</li> <li>Consultez la documentation de l'api \u00e0 cette adresse : https://imgflip.com/api</li> <li>Pour le projet vous allez utiliser les routes <code>/get_memes</code> et <code>/caption_image</code>.</li> </ul>"},{"location":"exercices/10_meme_generator/#fonctionnement-de-lapplication","title":"Fonctionnement de l'application","text":"<ul> <li>Je vous laisse d\u00e9couper l'application en composante de la fa\u00e7on que vous jugez pertinante.</li> <li>Afficher \u00e0 l'utilisateur 10 images de meme parmi lesquelles il pourra choisir. Ces images seront r\u00e9cup\u00e9r\u00e9es depuis le r\u00e9sultat de la route <code>/get_memes</code>. Pour plus de simplicit\u00e9, ne retenez que les images avec la valeur <code>\"box_count\" : 2</code>.</li> <li>Ensuite ajoutez deux zones de saisies qui permettront d'ajouter deux textes \u00e0 votre image. </li> <li>Quand l'usager cliquera sur un bouton \"g\u00e9n\u00e9rer\", faites afficher l'image du r\u00e9sultat dans la page. L'image devra se rafraichir \u00e0 chaque clique du bouton sans r\u00e9afficher la page.</li> <li>Utilisez la route <code>/caption_image</code> pour g\u00e9n\u00e9rer l'image. Attention, la fa\u00e7on d'envoyer les donn\u00e9es dans le body est un peu diff\u00e9rente de ce qu'on a vu auparavant, voir la note plus bas pour plus de d\u00e9tail.</li> <li>Donc en r\u00e9sum\u00e9, l'utilisateur s\u00e9lectionne une des 10 images, inscrit ensuite un texte dans chacune des zones et clique sur le bouton \"G\u00e9n\u00e9rer\".</li> </ul>"},{"location":"exercices/10_meme_generator/#envoyer-des-valeurs-dans-le-corps-de-la-requetes","title":"Envoyer des valeurs dans le corps de la requ\u00eates","text":"<p>Jusqu'\u00e0 maintenant on a toujours utilis\u00e9 le format JSON pour envoyer des donn\u00e9es dans le \"body\" de nos requ\u00eates. L'api de ImgFlip accepte un autre format : <code>x-www-form-urlencoded</code>. Le format utilise aussi une syntaxe cl\u00e9/valeur mais la fa\u00e7on d'inclure les donn\u00e9es dans la requ\u00eate va diff\u00e9rer un peu.</p>"},{"location":"exercices/10_meme_generator/#sous-postman","title":"Sous Postman","text":"<p>Dans la section \"Body\", cochez l'option <code>x-www-form-urlencoded</code>. Ensuite entrez vos informations dans le tableau :  </p>"},{"location":"exercices/10_meme_generator/#avec-la-librairie-axios","title":"Avec la librairie Axios","text":"<p>Premi\u00e8rement on va utiliser la classe <code>URLSearchParams</code> pour cr\u00e9er une constante des donn\u00e9es qu'on veut envoyer. Ensuite dans notre appel avec axios on va modifier la valeur du \"content-type\" dans le \"header\" pour <code>application/x-www-form-urlencoded</code>. On va aussi joindre nos param\u00eatre sous la cl\u00e9 \"data\": </p> <pre><code>const params = new URLSearchParams({ \n    template_id : 181913649,\n    username : \"********\",\n    password : \"********\"\n});\n\naxios({\n    method: 'POST',\n    url: 'https://api.imgflip.com/caption_image',\n    // Section headers \u00e0 ajouter\n    headers: { \n        'content-type': 'application/x-www-form-urlencoded'\n    },\n    // On joint la liste des param\u00eatres ici\n    data: params\n})\n.then((resultat) =&gt; {\n    // Code lors d'un succ\u00e8s\n})\n</code></pre>"},{"location":"exercices/11_tests_cors/","title":"Exercices 11 - Tests unitaires et CORS","text":"<p>\u00c0 partir de l'api cr\u00e9er \u00e0 l'exercice 4 et des ajouts que vous y avez fait au cours des autres exercices, vous allez cr\u00e9er des tests unitaires pour vos routes et faire les modifications n\u00e9cessaires pour permettre les CORS.</p>"},{"location":"exercices/11_tests_cors/#instruction","title":"Instruction","text":"<ul> <li>Pour chaque route <code>/cle_api</code> que vous avez ajout\u00e9 \u00e0 l'exercice 10, cr\u00e9ez au moins deux tests unitaires pertinents avec PHPUnit. </li> <li>Pour chaque route <code>/users</code> cr\u00e9ez aussi au moins deux tests mais cette fois avec Postman.</li> <li>Faites aussi les modifications n\u00e9cessaires pour permettre les requ\u00eates provenant de n'importe quel origine. </li> </ul>"},{"location":"notes_de_cours/php_methode_magique/","title":"Les m\u00e9thodes magiques","text":""},{"location":"notes_de_cours/php_methode_magique/#__construct","title":"__construct()","text":""},{"location":"notes_de_cours/php_methode_magique/#__invoke","title":"__invoke()","text":"<p>https://www.php.net/manual/fr/language.oop5.magic.php</p> <p>https://www.phptutorial.net/php-oop/php-__invoke/</p>"},{"location":"notes_de_cours/api/auth_http/","title":"Sch\u00e9ma d'authentification HTTP","text":"<p>Le protocole HTTP a une structure permettant le contr\u00f4le d'acc\u00e8s et l'authentification. Plusieurs sch\u00e9ma d'authentification HTTP ont \u00e9t\u00e9 cr\u00e9e, nous verrons l'authentification basique (Basic) et par \"jeton\" (Bearer Token). Ces informations vont \u00eatre ajout\u00e9es dans l'ent\u00eate de la requ\u00eate HTTP sous la cl\u00e9 <code>Authorization</code>.</p>"},{"location":"notes_de_cours/api/auth_http/#authentification-basique-basic-authentification","title":"Authentification basique (Basic Authentification)","text":"<ul> <li>Le plus simple, mais le moins s\u00e9curitaire. </li> <li>On place un username et un mot de passe encod\u00e9 en Base64 dans l\u2019ent\u00eate de la requ\u00eate.</li> <li>On d\u00e9code ensuite du c\u00f4t\u00e9 serveur et on valide que les informations sont bonne.</li> <li>Si les informations sont invalide, on retourne le code de Statut HTTP 401. </li> <li>Pas besoin d\u2019utiliser de cookie, de page de connexion, de id de session, etc.</li> <li>Le standart pour l'ajout de l'information dans l'ent\u00eate est d'utiliser la forme suivante : </li> </ul> <p><pre><code>Authorization: Basic dXNlcm5hbWU6bWF0aCBwYXNzd29yZDp0ZXN0\n</code></pre> o\u00f9 <code>dXNlcm5hbWU6bWF0aCBwYXNzd29yZDp0ZXN0</code> repr\u00e9sente le mot de passe encod\u00e9 en base64 sous la forme </p> <pre><code>username:nomUtilisateur password:motDePasse\n</code></pre> <p>En PHP on utilise la fonction <code>base64_encode</code> pour encoder un texte. \u00c0 l'inverse <code>base64_decode</code> va nous redonner le texte original.</p> <pre><code>$token = base64_encode('username:nomUtilisateur password:motDePasse');\n</code></pre>"},{"location":"notes_de_cours/api/auth_http/#bearer-authentication","title":"Bearer Authentication","text":"<ul> <li>Utilise un \u00ab token \u00bb de s\u00e9curit\u00e9 appel\u00e9e \u00ab bearer token \u00bb</li> <li>Le token est g\u00e9n\u00e9r\u00e9 par le serveur en r\u00e9ponse \u00e0 une requ\u00eate de connexion.</li> <li>Le client doit ensuite inclure le token dans l\u2019ent\u00eate de ses requ\u00eates</li> <li>Exemple d\u2019ent\u00eate : </li> </ul> <pre><code>Authorization: Bearer 5bdd0b74e9a6c\n</code></pre> <p>Pour des raisons de s\u00e9curit\u00e9, ces deux types d\u2019authentification devraient toujours \u00eatre utilis\u00e9s en HTTPS</p>"},{"location":"notes_de_cours/api/auth_http/#les-cles-api","title":"Les cl\u00e9s API","text":"<ul> <li>Grandement utilis\u00e9 et pouvant m\u00eame \u00eatre consid\u00e9r\u00e9 comme un standard, m\u00eame si encore une fois ce n\u2019est pas la m\u00e9thode la plus s\u00e9curitaire.</li> <li>Une valeur unique est g\u00e9n\u00e9r\u00e9e \u00ab al\u00e9atoirement \u00bb pour chaque utilisateur ou application. </li> <li>Cette cl\u00e9 est ensuite ajout\u00e9e dans chaque requ\u00eate, \u00e0 diff\u00e9rent endroit selon l\u2019api.</li> </ul> <pre><code>Ent\u00eate : Authorization: Apikey 1234567890abcdef\nSection \u00ab query \u00bb de la requ\u00eate : www.monapi.com/books?apikey=1234567890abcdef\nBody : {\u00ab apikey \u00bb : \u00ab 1234567890abcdef \u00bb}\n</code></pre> <ul> <li>En fait l\u2019authentification par cl\u00e9 api est une forme d\u2019authentification par \u00ab bearer token \u00bb comme vu plus haut.</li> </ul>"},{"location":"notes_de_cours/api/auth_http/#envoyer-les-informations-dautorisation-avec-postman","title":"Envoyer les informations d'autorisation avec Postman","text":"<p>Dans la section Headers, ajoutez une cl\u00e9 nomm\u00e9e Authorization avec la valeur voulue. Conservez toutes les autres cl\u00e9s.</p> <p></p>"},{"location":"notes_de_cours/api/auth_http/#extraire-les-informations-dautorisation-avec-slim","title":"Extraire les informations d'autorisation avec SLIM","text":"<p>On va utiliser un middleware pour s'occupper de l'autorisation. Dans la fonction __invoke de notre classe on va recevoir en param\u00e8tre un objet <code>Psr\\Http\\Message\\ServerRequestInterface</code> (Request dans l'exemple plus bas) qui contient toutes les informations de la requ\u00eate. Avec la m\u00e9thode <code>getHeaderLine()</code> on peut r\u00e9cup\u00e9rer la valeur de la cl\u00e9 qu'on lui envoie en param\u00e8tre. </p> <p>Ex: Si j'envoie ceci <code>Authorization: Bearer 5bdd0b74e9a6c</code> et je fais la ligne <code>$token = $request-&gt;getHeaderLine('Authorization');</code> je vais avoir la valeur <code>Bearer 5bdd0b74e9a6c</code>. Ensuite je n'ai qu'\u00e0 s\u00e9parer la valeur par l'espace et de conserver uniquement la deuxi\u00e8me partie. </p> <p>Voici un extrait d'une fonction __invoke qui isole la valeur du token avec l'exemple donn\u00e9 plus haut.</p> <pre><code>public function __invoke(\n        Request $request, \n        RequestHandler $handler): ResponseInterface\n    {        \n        // Je r\u00e9cup\u00e8re la valeur de la cl\u00e9 Authorization\n        $valeurTokenBrut = $request-&gt;getHeaderLine('Authorization') ?? '';\n        // Avec explode, on s\u00e9pare la valeur s\u00e9par\u00e9e par des espaces en plusieurs items\n        // Ici je vais directement chercher le deuxi\u00e8me item avec le [1] \n        $tokenIsole = explode(' ', $valeurTokenBrut)[1];\n\n        // M\u00eame chose que plus haut, mais en tout sur une ligne.\n        $token = explode(' ', $request-&gt;getHeaderLine('Authorization'))[1] ?? '';\n\n        // ...\n    }\n</code></pre>"},{"location":"notes_de_cours/api/auth_http/#reference","title":"R\u00e9f\u00e9rence","text":"<ul> <li>https://blog.restcase.com/4-most-used-rest-api-authentication-methods/</li> <li>https://stackoverflow.blog/2021/10/06/best-practices-for-authentication-and-authorization-for-rest-apis/</li> <li>https://www.cqlcorp.com/insights/best-practices-for-securing-your-rest-api-authentication-options/</li> <li>https://restfulapi.net/security-essentials/</li> </ul>"},{"location":"notes_de_cours/api/bonnes_pratiques/","title":"Les bonnes pratiques dans la conception d'un API","text":""},{"location":"notes_de_cours/api/bonnes_pratiques/#utiliser-le-format-json","title":"Utiliser le format JSON","text":"<p>Le format \u00e0 pr\u00e9coniser pour recevoir et retourner de l'information de notre api est le format JSON. C'est de loin le plus utilis\u00e9 aujourd'hui et la grande majorit\u00e9 des langages de programmation on des fonctions natives pour le manipuler.</p> <p>Plus de d\u00e9tail dans cette section : Le format JSON</p>"},{"location":"notes_de_cours/api/bonnes_pratiques/#utiliser-des-noms-au-lieu-de-verbes-pour-les-routes","title":"Utiliser des noms au lieu de verbes pour les routes","text":"<p>Quand on nomme les routes de notre api, on ne devrait pas utiliser de verbe. L'emploi d'un nom significatif est \u00e0 privil\u00e9gier. Par exemple notre api nous permet de retourner une liste d'utilisateurs ou d'en cr\u00e9er un, on serait tent\u00e9 d'utiliser comme nom de route </p> <pre><code>https://monApi/getUtilisateurs\nhttps://monApi/createUtilisateurs\n</code></pre> <p>mais il est pr\u00e9f\u00e9rable d'utiliser dans les deux cas</p> <pre><code>https://monApi/utilisateurs\n</code></pre> <p>Une m\u00eame route peut avoir plus d'une fonctionnalit\u00e9, c'est la m\u00e9thode HTTP qui nous permet de les diff\u00e9renci\u00e9es.</p>"},{"location":"notes_de_cours/api/bonnes_pratiques/#utiliser-la-methode-http-pour-decrire-la-fonctionnalite-de-la-ressource","title":"Utiliser la m\u00e9thode HTTP pour d\u00e9crire la fonctionnalit\u00e9 de la ressource","text":"<p>En lien avec le point suivant, utilisez la bonne m\u00e9thode HTTP pour indiquer quelle est la fonctionnalit\u00e9 de la route. Il existe une m\u00e9thode qui correspondante \u00e0 chaque op\u00e9ration CRUD. </p> Op\u00e9ration dans la BD M\u00e9thode http Lire GET Ins\u00e9rer POST Modifier PUT Modifier partiellement PATCH Supprimer DELETE <p>Attention</p> <p>On ne doit jamais modifier une ressource avec une m\u00e9thode GET.</p> <p>Les actions de modification PUT et PATCH sont tr\u00e8s similaires, la diff\u00e9rence est que PUT est utilis\u00e9 pour modifier toutes les valeurs de la ressource alors que PATCH l'est pour une modification partielle. Autre distinction de PUT, si la ressource n'est pas trouv\u00e9, elle sera cr\u00e9\u00e9e. Prenons l'exemple suivant, on veut pouvoir modifier un utilisateur ayant ces informations </p> <pre><code>{\n    \"id\" : \"1\",\n    \"username\" : \"[username]\",\n    \"first_name\" : \"[first_name]\",\n    \"last_name\" : \"[last_name]\",\n    \"email\" : \"[email]\"\n}\n</code></pre> <p>Avec PUT on doit envoyer toutes ces informations dans la requ\u00eate, alors qu'avec PATCH on pourrait permettre seulement d'envoyer et de modifier le email.</p> <p>L'utilisation de la bonne m\u00e9thode HTTP nous permet d'utiliser la m\u00eame route pour plus d'une fonction.</p> M\u00e9thode Route Description GET /utilisateurs Retourne la liste de tous les utilisateurs POST /utilisateurs Cr\u00e9ation d'un utilisateur PUT /utilisateurs/21 Modification de l'utilisateur avec le id 21 DELETE /utilisateurs/21 Suppression de l'utilisateur avec le id 21 <p>voir Les m\u00e9thodes HTTP</p>"},{"location":"notes_de_cours/api/bonnes_pratiques/#utiliser-les-codes-de-statut-http","title":"Utiliser les codes de statut HTTP","text":"<p>Dans la r\u00e9ponse de la requ\u00eate \u00e0 votre API utilisez une code de statut HTTP appropri\u00e9 \u00e0 la situation.</p> <ul> <li>200 - 299 indique un succ\u00e8s</li> <li>400 - 499 Il y a eu une erreur c\u00f4t\u00e9 client</li> <li>500 - 599 Il y a eu une erreur c\u00f4t\u00e9 serveur</li> </ul>"},{"location":"notes_de_cours/api/bonnes_pratiques/#resume-des-methodes-avec-le-code-de-statut-suggere","title":"R\u00e9sum\u00e9 des m\u00e9thodes avec le code de statut sugg\u00e9r\u00e9","text":"M\u00e9thode GLOBAL (/utilisateurs) Sur un element (/utilisateurs/{id}) POST 201 Created - La ressource est cr\u00e9\u00e9e et est retourn\u00e9e dans la r\u00e9ponse - GET 200 OK 200 OK 404 Not Found - La ressource n'a pas \u00e9t\u00e9 trouv\u00e9e, ex: le id utilisateur est invalide. PUT 405 Method Not Allowed - On ne devrait pas permettre de modifier toutes les ressources en une action 200 OK - La ressource est modifi\u00e9e et est retourn\u00e9e dans la r\u00e9ponse. 201 Created - La ressource a \u00e9t\u00e9 cr\u00e9\u00e9 car elle etait inexistante. PATCH 405 Method Not Allowed - On ne devrait pas permettre de modifier toutes les ressources en une action 200 OK - La ressource est modifi\u00e9e et est retourn\u00e9e dans la r\u00e9ponse. 404 Not Found - La ressource \u00e0 modifier n'a pas \u00e9t\u00e9 trouv\u00e9e, ex: le id utilisateur est invalide. DELETE 405 Method Not Allowed - On ne devrait pas permettre de supprimer toutes les ressources en une action. Si oui utilisez le code 200. 204 No Content - La ressource a \u00e9t\u00e9 supprim\u00e9 et aucune information n'est retourn\u00e9e dans la r\u00e9ponse. 200 OK - La ressource est supprim\u00e9 et est retourn\u00e9e dans la r\u00e9ponse. 404 Not Found - La ressource \u00e0 supprimer n'a pas \u00e9t\u00e9 trouv\u00e9e, ex: le id utilisateur est invalide."},{"location":"notes_de_cours/api/bonnes_pratiques/#codes-a-utiliser-pour-les-erreurs","title":"Codes \u00e0 utiliser pour les erreurs","text":"Code Utilisation 401 - Unauthorized Le client ne s'est pas encore authentifier pour acc\u00e9der \u00e0 l'api. 403 - Forbidden Le client est authentifi\u00e9 mais n'a pas les autorisations pour acc\u00e9der \u00e0 la ressource. 404 - Not Found L'url utilis\u00e9 est invalide, le client demande une ressource qui n'existe pas. 500 - Internal Server Error Une erreur est survenu c\u00f4t\u00e9 serveur. Retournez de l'information sur l'erreur dans la r\u00e9ponse."},{"location":"notes_de_cours/api/bonnes_pratiques/#utiliser-limbrication-dans-les-routes","title":"Utiliser l'imbrication dans les routes","text":"<p>Quand des ressources de votre api peuvent \u00eatre reli\u00e9es, utilisez l'imbrication pour cr\u00e9er des urls significatifs. Par exemple un auteur peut avoir \u00e9crit plusieurs livres, on pourrait avoir une route nomm\u00e9e <code>/{auteurs}/livres</code> qui retourne tous les livres de l'auteur en param\u00e8tre.</p> <p>Il faut cependant faire attention \u00e0 ne pas trop surcharger la route en allant trop profond\u00e9ment avec l'imbrication.</p>"},{"location":"notes_de_cours/api/bonnes_pratiques/#permettre-les-filtres-le-tri-selection-des-champs-retournes-et-la-pagination","title":"Permettre les filtres, le tri, s\u00e9lection des champs retourn\u00e9s et la pagination","text":"<p>Pour permettre \u00e0 l'utilisateur un meilleur contr\u00f4le sur les donn\u00e9es r\u00e9cup\u00e9r\u00e9es, permettez l'utilisation de filtres, de tri et de pagination dans vos requ\u00eate. Les param\u00e8tres devraient \u00eatre situ\u00e9 dans la section \"requ\u00eate\" de l'url</p>"},{"location":"notes_de_cours/api/bonnes_pratiques/#filtre","title":"Filtre","text":"<p>Utilisez un nom de param\u00e8tre significatif. Pour saisir plusieurs valeurs, on doit les s\u00e9parer par une virgule.</p> <p>Exemple : </p> <ul> <li><code>/livres?categorie=roman</code> pour afficher tous les livres de la cat\u00e9gorie roman.</li> <li><code>/livres?categorie=roman,documentaire</code> pour afficher tous les livres de la cat\u00e9gorie roman et documentaire.</li> </ul>"},{"location":"notes_de_cours/api/bonnes_pratiques/#tri","title":"tri","text":"<p>Utilisez comme valeur du param\u00e8tre le nom du champ avec un code pr\u00e9d\u00e9fini en pr\u00e9fixe ( + et - par exemple) qui indiquera si le tri est ascendant ou descendant. Le tri sur plus d'un champ devrait aussi \u00eatre permis.</p> <p>Exemple : </p> <ul> <li><code>/livres?tri=+titre,-prix</code> pour trier par les livres titre de mani\u00e8re ascendante et par prix de mani\u00e8re descendante.</li> </ul>"},{"location":"notes_de_cours/api/bonnes_pratiques/#selection-des-champs-retournes","title":"S\u00e9lection des champs retourn\u00e9s","text":"<p>Il peut aussi \u00eatre pertinent de permettre au client de pouvoir s\u00e9lectionner uniquement les champs qu'il veut avoir dans la r\u00e9ponse \u00e0 la requ\u00eate. </p> <p>Exemple : </p> <ul> <li><code>/livres?champs=titre,isbn</code> retournera la liste de tous les livres mais seulement le titres et isbn de chacun.</li> </ul>"},{"location":"notes_de_cours/api/bonnes_pratiques/#pagination","title":"Pagination","text":"<p>Il n'est pas rare qu'une ressource comporte plusieurs centaines sinon milliers d'enregistrements. On devrait permettre au client de pouvoir s\u00e9lectionner seulement une partie des enregistrements en d\u00e9finissant un point de d\u00e9part (offset) et un nombre d'enregistrement (limit). Si on utilise la pagination, on devrait d\u00e9finir des valeurs par d\u00e9faut au param\u00e8tre offset et limit (g\u00e9n\u00e9ralement offset sera \u00e9gale \u00e0 0 pour le premier enregistrement). </p> <p>Exemple : </p> <ul> <li><code>/livres?limit=50&amp;offset=100</code> En partant du centi\u00e8me enregistrement, affiche les 50 livres suivants.</li> </ul> <p>Pour faciliter le traitement des donn\u00e9es, on devrait ajouter dans la r\u00e9ponse le nombre total d'enregistrements ainsi que les valeurs de limit et offset.</p> <p>Une autre technique est d'avoir un nombre d'enregistrement fixe par page et de seulement permettre \u00e0 l'usager de choisir la page qu'il veut afficher. Exemple, on d\u00e9cide d'afficher 30 enregistrements par page, l'url suivant va afficher les enregistrement 61 \u00e0 90 : </p> <ul> <li><code>/livres?page=3</code></li> </ul> <p>On peut bien sur combiner les deux m\u00e9thodes comme c'est souvent le cas dans les sites d'achats en lignes (On peut choisir la page et le nombre d'articles affich\u00e9s par page).</p>"},{"location":"notes_de_cours/api/bonnes_pratiques/#source","title":"Source","text":"<ul> <li>https://www.moesif.com/blog/api-guide/api-design-guidelines/</li> <li>https://www.freecodecamp.org/news/rest-api-best-practices-rest-endpoint-design-examples/</li> <li>https://medium.com/@mwaysolutions/10-best-practices-for-better-restful-api-cbe81b06f291</li> </ul>"},{"location":"notes_de_cours/api/cors/","title":"CORS (Cross-Origin Resource Sharing)","text":"<p>C\u2019est un m\u00e9canisme qui consiste \u00e0 ajouter des en-t\u00eates HTTP afin de permettre \u00e0 un agent utilisateur d'acc\u00e9der \u00e0 des ressources d'un serveur situ\u00e9 sur une autre origine que le site courant.</p> <p>Pour des raisons de s\u00e9curit\u00e9, les requ\u00eates HTTP multi-origine \u00e9mises depuis les scripts sont restreintes. </p> <p></p> <p>Les requ\u00eates GET et POST simple (sans ajout d\u2019informations d\u2019ent\u00eate) sont accept\u00e9es, sinon il y a une requ\u00eate OPTIONS qui est envoy\u00e9 vers la ressource de l'autre domaine afin de d\u00e9terminer quelle requ\u00eate peut \u00eatre envoy\u00e9e de fa\u00e7on s\u00e9curis\u00e9e.</p> <p></p> <p>Dans cet exemple, on peut voir que j'ai envoy\u00e9 une requ\u00eate GET \u00e0 l'adresse <code>/books</code>. Une requ\u00e8te OPTIONS a \u00e9t\u00e9 envoy\u00e9 en \"reconnaissance\" et a \u00e9t\u00e9 bloqu\u00e9 par le m\u00e9canisme CORS. Pour que la requ\u00eate puisse \u00eatre accept\u00e9e, il faut faire des modifications au niveau de la r\u00e9ponse qu'envoie le serveur en ajoutant certaines informations dans son ent\u00eate.</p>"},{"location":"notes_de_cours/api/cors/#access-control-allow-origin","title":"Access-Control-Allow-Origin","text":"<p>Ce param\u00eatre nous permet de contr\u00f4ler l'origine des requ\u00eates qui seront accept\u00e9e. Si l'information n'est pas pr\u00e9sente, toutes les requ\u00eates outre que les GET et POST simple seront refus\u00e9. C'est exactement le probl\u00e8me de l'exemple plus haut. </p> <p>On peut d\u00e9cider d'accepter toutes les origines en utilisant le jeton *</p> <pre><code>Access-Control-Allow-Origin: *\n</code></pre> <p>Ou bien sp\u00e9cifier un domaine qui sera accept\u00e9</p> <pre><code>Access-Control-Allow-Origin: https://mathprof.ca\n</code></pre> <p>Si on veut permettre une liste de domaine sans les permettre tous, il faudra le g\u00e9rer dans le code de notre serveur. On commence par r\u00e9cup\u00e9rer le domaine de la requ\u00eate entrante, on v\u00e9rifie s'il est pr\u00e9sent dans la liste de domaines qu'on permet et si oui on ajouter se domaine en valeur \u00e0 la cl\u00e9 Access-Control-Allow-Origin dans l'ent\u00eate de la r\u00e9ponse.</p> <p>Pour plus de d\u00e9tail : https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Origin</p>"},{"location":"notes_de_cours/api/cors/#access-control-allow-methods","title":"Access-Control-Allow-Methods","text":"<p>Ce param\u00eatre va indiquer quels sont les m\u00e9thodes HTTP (GET, POST, DELETE, etc.) qui sont accept\u00e9es. Encore une fois on peut utiliser le jeton * pour permettre toutes les m\u00e9thodes ou bien lister seulement celle voulue en les s\u00e9parant par une virgule.</p> <pre><code>Access-Control-Allow-Methods: *\n</code></pre> <pre><code>Access-Control-Allow-Methods: POST, GET, OPTIONS\n</code></pre> <p>Pour plus de d\u00e9tail : https://developer.mozilla.org/fr/docs/Web/HTTP/Headers/Access-Control-Allow-Methods</p>"},{"location":"notes_de_cours/api/cors/#modification-a-apporter-dans-le-template-slim","title":"Modification \u00e0 apporter dans le template SLIM","text":""},{"location":"notes_de_cours/api/cors/#creation-dun-middleware-pour-ajouter-linformation-requise-en-entete","title":"Cr\u00e9ation d'un middleware pour ajouter l'information requise en ent\u00eate","text":"<p>Pour ajouter les informations requises nous allons cr\u00e9er un middleware. Dans le r\u00e9pertoire <code>src/Middleware</code> cr\u00e9ez le fichier <code>CorsMiddleware.php</code> et copiez-y le code suivant : </p> <pre><code>&lt;?php\n\n/**\n * Source : Slim 4 - eBook par Daniel Opitz\n * \n * Published by Daniel Opitz\n * \u00a9 Copyright Daniel Opitz 2020-2021\n * https://odan.github.io/\n * \n */\n\nnamespace App\\Middleware;\n\nuse Psr\\Http\\Message\\ResponseInterface;\nuse Psr\\Http\\Message\\ServerRequestInterface;\nuse Psr\\Http\\Server\\MiddlewareInterface;\nuse Psr\\Http\\Server\\RequestHandlerInterface;\nuse Slim\\Routing\\RouteContext;\n/**\n* CORS middleware.\n*/\nfinal class CorsMiddleware implements MiddlewareInterface\n{\n    /**\n    * Invoke middleware.\n    *\n    * @param ServerRequestInterface $request The request\n    * @param RequestHandlerInterface $handler The handler\n    * \n    * @return ResponseInterface The response\n    */\n    public function process(\n        ServerRequestInterface $request,\n        RequestHandlerInterface $handler\n    ): ResponseInterface {\n        $routeContext = RouteContext::fromRequest($request);\n        $routingResults = $routeContext-&gt;getRoutingResults();\n        $methods = $routingResults-&gt;getAllowedMethods();\n        $requestHeaders = $request-&gt;getHeaderLine('Access-Control-Request-Headers');\n\n        $response = $handler-&gt;handle($request);\n\n        $response = $response\n            // Permet toutes les origines\n            -&gt;withHeader('Access-Control-Allow-Origin', '*')\n            // Ajoute la ou les m\u00e9thodes de la requ\u00eate\n            -&gt;withHeader('Access-Control-Allow-Methods', implode(', ', $methods))\n            -&gt;withHeader('Access-Control-Allow-Headers', $requestHeaders ?: '*');\n\n        // Optional: Allow Ajax CORS requests with Authorization header\n        $response = $response-&gt;withHeader('Access-Control-Allow-Credentials', 'true');\n\n        return $response;\n    }\n}\n</code></pre> <p>Maintenant dans le fichier <code>config/middleware.php</code> ajoutez la ligne suivante</p> <pre><code>$app-&gt;add(\\App\\Middleware\\CorsMiddleware::class);\n</code></pre> <p>juste avant la ligne </p> <pre><code>$app-&gt;addRoutingMiddleware();\n</code></pre>"},{"location":"notes_de_cours/api/cors/#ajout-de-route-pour-les-requetes-options","title":"Ajout de route pour les requ\u00eates OPTIONS","text":"<p>On va aussi ajouter une route qui va \"attraper\" toutes les requ\u00eates de la m\u00e9thode OPTIONS. Dans le fichier <code>route.php</code>, ajouter la route suivante \u00e0 la toute fin. C'est important que \u00e7a soit la derni\u00e8re route de votre fichier.</p> <pre><code>$app-&gt;options('/{routes:.*}', \\App\\Action\\PreflightAction::class);\n</code></pre> <p>Ensuite, cr\u00e9ez le fichier <code>PreflightAction.php</code> dans le r\u00e9pertoire <code>src/Action</code> et copiez-y le code suivant : </p> <pre><code>&lt;?php\n\nnamespace App\\Action;\n\nuse Psr\\Http\\Message\\ResponseInterface;\nuse Psr\\Http\\Message\\ServerRequestInterface;\n\nfinal class PreflightAction\n{\n    public function __invoke(\n        ServerRequestInterface $request,\n        ResponseInterface $response\n    ): ResponseInterface {\n        return $response;\n    }\n}\n</code></pre> <p>C'est normal que la classe ne fasse que retourner la r\u00e9ponse de la requ\u00eate sans la modifier. En fait, le but est que les requ\u00eates OPTIONS soit trait\u00e9e aussi par le middleware <code>CorsMiddleware</code>.</p>"},{"location":"notes_de_cours/api/cors/#pour-aller-plus-loin","title":"Pour aller plus loin","text":"<ul> <li>CORS in 100 Seconds</li> <li>Documentation SLIM</li> <li>Documentation Mozilla</li> </ul>"},{"location":"notes_de_cours/api/documentation_api/","title":"Documentation de l'API","text":"<p>Comme il est destin\u00e9 \u00e0 \u00eatre utilis\u00e9 par des utilisateurs externes, il est primordial de bien documenter notre API. Il existe plusieurs fa\u00e7ons de faire, la plus simple \u00e9tant de seulement lister toutes les routes possibles en indiquant leur fonction. Nous allons y aller de fa\u00e7on plus professionnel en utilisant le standard OpenAPI.</p> <p>OpenAPI nous permet de d\u00e9crire l\u2019api dans son ensemble, les routes (endpoints), les requ\u00eates et les formats de r\u00e9ponse, la m\u00e9thode d\u2019authentification, etc. Le d\u00e9finition peut \u00eatre \u00e9crite en JSON ou YAML, nous allons pour notre projet utiliser le format YAML.</p>"},{"location":"notes_de_cours/api/documentation_api/#utilisation-de-swaggerio","title":"Utilisation de Swagger.io","text":"<p>On va utiliser les services du site Swagger.io qui nous offre un \u00e9diteur OpenAPI gratuit. </p> <ul> <li>Cr\u00e9ez vous un compte gratuit sur https://swagger.io/</li> <li>Ensuite dans myHub, cr\u00e9ez un nouvel api avec les configurations suivantes : </li> <li>OpenApiVersion : 3.0.0</li> <li>Template : none</li> <li>Name, Title, description : Ce que vous voulez</li> <li>Version : 1.0.0</li> <li>Auto Mock API : Off</li> </ul> <p>Une fois la documentation r\u00e9dig\u00e9e dans l'\u00e9diteur de Swagger, vous pouvez l'exporter dans plusieurs format ou simplement la recopier dans le fichier YAML de votre projet.</p>"},{"location":"notes_de_cours/api/documentation_api/#le-format-openapi","title":"Le format OpenAPI","text":"<p>Voici un exemple de la documentation d'un API en OpenAPI sur Swagger.io : https://app.swaggerhub.com/apis/MathFrechette/libAPI/1.0.0. Les exemples qui suivent utiliseront cette documentation. Dans notre projet il y a d\u00e9j\u00e0 un template de page web pour afficher la documentation de fa\u00e7on bien format\u00e9e.</p> <p>Le fichier de documentation est divis\u00e9 en plusieurs sections (info, servers, paths et components) qu'on va d\u00e9crire plus bas. Chose importante \u00e0 savoir, dans un fichier yaml l'indentation est tr\u00e8s importante (un peu comme en Python).</p>"},{"location":"notes_de_cours/api/documentation_api/#info-et-servers","title":"info et servers","text":"<p>On va y d\u00e9clarer les informations g\u00e9n\u00e9rales de notre API</p> <pre><code>info:\n  version: 1.0.0\n  title: LibAPI\n  description: Un API de livres cr\u00e9\u00e9 dans le cadre du cours Services Web H2021\nservers: \n  - url: http://localhost/libapi\n</code></pre> <ul> <li>version : La version de l'api, \u00e0 votre guise pour l'instant on ne versionne pas notre projet.</li> <li>title : Le titre de notre api</li> <li>description : Une courte description de notre api</li> <li>url : L'url de base de votre api</li> </ul> <p></p>"},{"location":"notes_de_cours/api/documentation_api/#paths","title":"paths","text":"<p>Dans cette section nous allons d\u00e9crire toutes les routes qui composent notre API <pre><code>paths:\n  /books:\n    get:\n      tags:\n        - Livre\n      summary: Affiche la liste de tous les livres.\n      parameters:\n        - name: titre\n          in: query\n          name: titre\n          schema:\n            type: string\n          required: false\n          description: Une valeur pour filter par le titre\n      responses:\n        '200': \n          description: Un tableau de livres\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/Livres'\n</code></pre></p> <ul> <li>/books: Le nom de la route</li> <li>get: La m\u00e9thode utilis\u00e9 par la route</li> <li>tags: Un mot-cl\u00e9 pour regrouper des routes similaires</li> <li>summary: Une courte description de la route</li> </ul> <p>parameters</p> <p>Les diff\u00e9rents param\u00e8tres de la route (chaque bloc de param\u00e8tre commence par le symbole -)</p> <ul> <li>name: Le nom utilis\u00e9 pour le param\u00e8tre.</li> <li>in: query ou path (est-ce que le param\u00e8tre est situ\u00e9 dans la section query de l'url ou dans le chemin)</li> <li>schema: On va d\u00e9finir le type de valeur attendu (string, integer) avec type:</li> <li>required: Est-ce que le param\u00e8tre est requis ou optionnel</li> <li>description: Une description de l'utilit\u00e9 du param\u00e8tre.</li> </ul> <p>responses</p> <p>Les informations sur le format de la r\u00e9ponse. On peut en d\u00e9finir plus d'une, comme par exemple en cas de succ\u00e8s ou d'\u00e9chec de la requ\u00eate.</p> <ul> <li>'200': Le code de statut HTTP retourn\u00e9</li> <li>description: Une description du contenu de la r\u00e9ponse.</li> <li>application/json: Le format de la r\u00e9ponse, dans notre cas on va toujours utiliser ce format.</li> <li>schema: Une description du contenu de la r\u00e9ponse et un exemple de r\u00e9sultat. Dans l'exemple on utilise un sch\u00e9ma pr\u00e9d\u00e9fini qu'on va voir plus loin. On aurait aussi pu le d\u00e9crire ici, en voici un exemple : </li> </ul> <pre><code>schema:\n  type: object\n    properties:\n      id:\n        type: integer\n        format: int64\n      genreId:\n        type: integer\n        format: int64\n      titre:\n        type: string\n      isbn:\n        type: string\n    example:\n        id: 1\n        genreId : 1\n        titre: Fondation\n        isbn: '9782070463619'\n</code></pre> <p></p>"},{"location":"notes_de_cours/api/documentation_api/#components","title":"components","text":"<p>Ici on peut d\u00e9finir un mod\u00e8le de donn\u00e9es qu'on va pouvoir r\u00e9utiliser dans plus d'une route.</p> <pre><code>components:\n  schemas:\n\n    Livre:\n      type: object\n      required:\n        - genreId\n        - titre\n        - isbn\n      properties:\n        id:\n          type: integer\n          format: int64\n        genreId:\n          type: integer\n          format: int64\n        titre:\n          type: string\n        isbn:\n          type: string\n      example:\n          id: 1\n          genreId : 1\n          titre: Fondation\n          isbn: '9782070463619'\n</code></pre> <ul> <li>Livre: Le nom du sch\u00e9ma, c'est ce nom qu'on va utiliser dans l'url de la propri\u00e9t\u00e9 $ref dans la d\u00e9finition de la route. (voir exemple plus haut)</li> <li>type: Le type de donn\u00e9e</li> <li>required: Les champs requis s'il y en a</li> <li>properties: Une description des champs requis</li> <li>id: Le nom du champs.</li> <li>format: Le type de donn\u00e9e</li> <li>format: optionnel, pour pr\u00e9ciser le type de donn\u00e9e</li> <li>exemple: Un exemple de donn\u00e9es avec le nom des champs et une valeur pour chacun</li> </ul>"},{"location":"notes_de_cours/api/documentation_api/#source","title":"Source","text":"<p>Pour plus d'informations je vous invite \u00e0 consulter ces deux sites : </p> <ul> <li>https://oai.github.io/Documentation/start-here.html</li> <li>https://swagger.io/docs/specification/about/</li> </ul>"},{"location":"notes_de_cours/api/introduction/","title":"Introduction","text":""},{"location":"notes_de_cours/api/introduction/#cest-quoi-un-service-web-api","title":"C'est quoi un service web (API)?","text":"<p>L'acronyme API signifie en anglais Application Programming Interface. On peut d\u00e9finir une api comme un interface qui permet d\u2019\u00e9changer de l\u2019informations avec d\u2019autres applications, peut importe le langage de programmation et le syst\u00e8me d\u2019exploitation.</p> <p>Il existe plusieurs types d'architectures d'api. Nous allons choisir l'architecture REST qui se base sur les standarts du web et le protocole HTTP. </p>"},{"location":"notes_de_cours/api/introduction/#court-resume-en-4-minutes","title":"Court r\u00e9sum\u00e9 en 4 minutes","text":""},{"location":"notes_de_cours/api/introduction/#fonctionnement-general","title":"Fonctionnement g\u00e9n\u00e9ral","text":"<p>Donc si on r\u00e9sume notre api va recevoir des requ\u00eates HTTP qu'il traitera selon les param\u00eatres envoy\u00e9s et retourner une r\u00e9ponse \u00e0 la requ\u00eate.</p> <p> </p> Source : https://www.altexsoft.com/blog/rest-api-design/ <p>Une requ\u00eate \u00e0 un api REST va toujours \u00eatre compos\u00e9e de quatre parties essentielles:</p> <ul> <li>Une m\u00e9thode HTTP: GET, POST, PUT, PATCH, DELETE.</li> <li>Une porte d'entr\u00e9e (endpoint), le plus souvent sous la forme d'une url.</li> <li>Une ent\u00eate \u00e0 la requ\u00eate HTTP qui contient plusieurs informations comme les informations de l'usager et une cl\u00e9 d'api. </li> <li>Un \"corps\" qui peut contenir des informations a envoy\u00e9 \u00e0 l'api.</li> </ul> <p> </p> Source : https://www.apinewbies.com/api-request/"},{"location":"notes_de_cours/api/introduction/#envoyer-une-requete","title":"Envoyer une requ\u00eate","text":"<p>On peut simplement envoyer une requ\u00eate \u00e0 un api avec n'importe quel navigateur mais on n'aura pas de contr\u00f4le sur les informations envoy\u00e9 et on sera limit\u00e9 \u00e0 la m\u00e9thode GET.</p> <p>Il existe plusieurs outils qui nous permettent une utilisation plus pouss\u00e9 des apis, Postman en est un bon exemple. Sinon on peut incorpor\u00e9 le tout dans une application ou page web, la pluppart des langages de programmation prennent en charge les requ\u00eates HTTP.</p>"},{"location":"notes_de_cours/api/json/","title":"Le format JSON","text":"<p>JSON (JavaScript Object Notation) est un format cr\u00e9\u00e9 pour faciliter l'\u00e9change de donn\u00e9es entre diff\u00e9rents syst\u00e8mes. Bien que grandement inspir\u00e9 de la notation objet de JavaScript le format JSON est ind\u00e9pendant de tout langage et peut \u00eatre interpr\u00e9ter par la majorit\u00e9 des diff\u00e9rents langage de programmation.</p>"},{"location":"notes_de_cours/api/json/#structure-de-base","title":"Structure de base","text":"<p>Les deux structures suivantes sont utilis\u00e9es pour construire notre JSON : </p>"},{"location":"notes_de_cours/api/json/#lobjet","title":"L'objet","text":"<p>Une suite d'\u00e9l\u00e9ments cl\u00e9/valeurs, s\u00e9rar\u00e9s par une virgule. L'objet sera entour\u00e9 par des accolades. <pre><code>{\n    \"cle1\" : \"valeur1\",\n    \"cle2\" : \"valeur2\"\n}\n</code></pre> </p>"},{"location":"notes_de_cours/api/json/#le-tableau","title":"Le tableau","text":"<p>Une suite d'\u00e9l\u00e9ments ordonn\u00e9s, s\u00e9par\u00e9e par une virgule et entour\u00e9e par des crochets [ ] <pre><code>[\"valeur1\", \"valeur2\"]\n</code></pre> </p> <p>On peut m\u00e9langer les deux structures sans probl\u00e8me (un tableau d'objet, une valeur de l'objet est un tableau, etc.) <pre><code>{\n    \"cle1\" : [\n        \"valeur1\", \n        \"valeur2\"\n    ],\n    \"cle2\" : \"valeur2\"\n}\n</code></pre></p> <p>Il est aussi possible d'avoir un objet ou un tableau vide, qu'on notera respectivement {} et [].</p>"},{"location":"notes_de_cours/api/json/#liste-des-valeurs-possibles","title":"Liste des valeurs possibles","text":"<ul> <li>String : du texte entour\u00e9 de guillemets \"</li> <li>Nombre : sans les guillemets, on peut utiliser les d\u00e9cimales avec le point et les exposants avec le caract\u00e8re e.</li> <li>objet : comme vu plus haut, liste de cl\u00e9/valeur entour\u00e9es par des accolades</li> <li>tableau : liste d'items entour\u00e9s de crochet</li> <li>bool\u00e9an : utilisez true ou false sans guillemets et en minuscule</li> <li>valeur nulle : null sans guillemets et en minuscule</li> </ul> <p>Note sur les dates : Le format date n'\u00e9tant pas pleinenement support\u00e9, on devrait par pr\u00e9caution les convertir en texte.</p>"},{"location":"notes_de_cours/api/json/#valider-un-texte-au-format-json","title":"Valider un texte au format JSON","text":"<p>JSONLint est un petit outils en ligne tr\u00e8s pratique pour valider qu'un texte respecte le format JSON : www.jsonlint.com</p>"},{"location":"notes_de_cours/api/json/#utilisation-en-javascript","title":"Utilisation en JavaScript","text":""},{"location":"notes_de_cours/api/json/#jsonstringify","title":"JSON.stringify()","text":"<p>La m\u00e9thode la plus simple pour envoyer des donn\u00e9es au format JSON est de convertir un objet JavaScript avec la fonction <code>JSON.stringify</code>.</p>"},{"location":"notes_de_cours/api/json/#jsonparse","title":"JSON.parse()","text":"<p>Les donn\u00e9es qu'on re\u00e7oit au format JSON sont sous forme de texte. Pour les utiliser facilement en JavaScript on va les convertir en objet avec la fonction <code>JSON.parse()</code>.</p> JSON.js<pre><code>// Objet JavaScript \u00e0 convertir en JSON\nconst usager = {prenom: \"Mathieu\", nom: \"Frechette\", age:43, cours:[\"Services Web\", \"Conception de syst\u00e8mes\"]};\n// Convertir l'objet JavaScript en JSON avec JSON.stringify()\nconst jsToJSON = JSON.stringify(usager);\n\nconsole.log('reponseJson: ', jsToJSON); // {\"prenom\":\"Mathieu\",\"nom\":\"Frechette\",\"age\":43,\"cours\":[\"Services Web\",\"Conception de syst\u00e8mes\"]}\n\n// Convertir le JSON en objet JavaScript avec JSON.parse()\nconst objJS = JSON.parse(jsToJSON);\n\nconsole.log('Nom: ', objJS.prenom + ' ' + objJS.nom); // Nom: Mathieu Frechette\n</code></pre>"},{"location":"notes_de_cours/api/json/#sources","title":"Sources","text":"<ul> <li>Toutes les images proviennent du site www.json.org</li> <li>ECMA-404 The JSON Data Interchange Standard.</li> <li>www.json.org</li> <li>Standart de l'ECMA en version PDF</li> </ul>"},{"location":"notes_de_cours/api/unit_test/","title":"Tester notre API","text":""},{"location":"notes_de_cours/api/unit_test/#pourquoi-tester-notre-application","title":"Pourquoi tester notre application?","text":"<p>D\u00e8s qu\u2019on ajoute du code \u00e0 notre application, on ouvre la porte \u00e0 ajouter aussi de possible erreurs ou comportement qu\u2019on avait pas pr\u00e9vu. Pour s\u2019assurer d\u2019avoir une application solide et plus facilement modifiable, c\u2019est une bonne pratique de programmer des tests qu\u2019on pourra lancer au besoin par un script. </p> <p>Plusieurs possibilit\u00e9s s\u2019offrent \u00e0 nous comme plate-forme de tests si on ne veut pas tout programmer nous-m\u00eame. Dans le cadre du cours on va en voir 2 : </p> <ul> <li>Postman, qui offre la possibilit\u00e9 d\u2019inclure des tests script\u00e9s en javascript.</li> <li>PHPUnit, un framework php</li> </ul>"},{"location":"notes_de_cours/api/unit_test/#tester-avec-postman","title":"Tester avec Postman","text":"<p>Dans l'interface de postman, on peut scripter des tests dans l'onglet Tests d'une requ\u00eate.</p> <p></p> <p>Les scripts de tests sont cod\u00e9s en javascript et seront lanc\u00e9s une fois la r\u00e9ponse de l\u2019appel \u00e0 l\u2019api re\u00e7u. Chaque test aura la structure suivante : </p> <pre><code>pm.test(\"Description du test\", function() {\n    // Le script du test\n})\n</code></pre> <p>Le r\u00e9sultat des tests se retrouvent dans la section Response sous l\u2019onglet Test Results.</p> <p></p>"},{"location":"notes_de_cours/api/unit_test/#exemple-dune-serie-de-test","title":"Exemple d'une s\u00e9rie de test","text":"<pre><code>/* Structure de la r\u00e9ponse\n[\n    {\n        \"id\": \"54\",\n        \"genreId\": \"1\",\n        \"titre\": \"Fondation\",\n        \"isbn\": \"9782070463619\"\n    },\n]\n*/\n\n// La constante jsonData va contenir un objet json de la r\u00e9ponse\nconst jsonData = pm.response.json();\n\npm.test(\"La r\u00e9ponse retourne le code 200\", function () {\n    pm.response.to.have.status(200);\n});\n\npm.test(\"La r\u00e9ponse est un tableau\", function () {\n    pm.expect(jsonData).to.be.an(\"array\");\n})\n\npm.test(\"Les items du tableau de la r\u00e9ponse ont les bonnes cl\u00e9s\", function() {\n    if(jsonData.length &gt; 0){\n        // Valide que le premier item du tableau books contient les cl\u00e9s id, genreId, titre et isbn\n        pm.expect(jsonData[0]).to.have.all.keys('id', 'genreId', 'titre','isbn');\n    }\n})\n\npm.test(\"Les items du tableau de la r\u00e9ponse ont les bons types\", function() {\n    if(jsonData.length &gt; 0){\n        pm.expect(jsonData[0].id).to.be.a(\"string\");\n        pm.expect(jsonData[0].genreId).to.be.a(\"string\");\n        pm.expect(jsonData[0].titre).to.be.a(\"string\");\n        pm.expect(jsonData[0].isbn).to.be.a(\"string\");\n    }\n})\n</code></pre>"},{"location":"notes_de_cours/api/unit_test/#notre-premier-test","title":"Notre premier test","text":"<p>\u00c0 l'aide de la route <code>https://api.chucknorris.io/jokes/random</code> testez que les cl\u00e9s url ou value soient bien pr\u00e9sente dans la r\u00e9ponse.   </p> <p>Pour plus d'information et d'exemples, consultez la documentation de Postman :</p> <ul> <li>https://learning.postman.com/docs/writing-scripts/script-references/test-examples/</li> </ul>"},{"location":"notes_de_cours/api/unit_test/#tester-avec-phpunit","title":"Tester avec PHPUnit","text":""},{"location":"notes_de_cours/api/unit_test/#installation-et-integration-dans-un-projet","title":"Installation et int\u00e9gration dans un projet","text":"<p>Faites l\u2019installation de PHPUnit comme d\u00e9pendance de d\u00e9veloppement avec la commande suivante</p> <pre><code>composer require phpunit/phpunit --dev\n</code></pre> <p>Chaque tests sera une classe PHP qui sera pr\u00e9sente dans le r\u00e9pertoire tests/TestCase/ de notre application</p> <ul> <li>Cr\u00e9er le r\u00e9pertoire ./tests/TestCase/ \u00e0 la racine de l\u2019application</li> <li>Avec git bash vous pouvez faire la commande mkdir \u2013p tests/TestCase</li> </ul> <p>Ouvrez de fichier composer.json et ajoutez les lignes suivantes \u00e0 la suite du fichier <pre><code>\"scripts\": {\n    \"test\": \"phpunit --configuration phpunit.xml --testdox\",\n    \"test:coverage\": \"phpunit --configuration phpunit.xml --coverage-clover build/logs/clover.xml --coverage-html build/coverage\"\n}\n</code></pre></p>"},{"location":"notes_de_cours/api/unit_test/#configuration-de-phpunit","title":"Configuration de PHPUnit","text":"<p>Cr\u00e9ez le fichier phpunit.xml \u00e0 la racine de l\u2019application. La configuration de PHPUnit se fera dans ce fichier. Copiez le code suivant dans le fichier.</p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;phpunit \n    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" \n    bootstrap=\"vendor/autoload.php\" \n    colors=\"true\" \n    backupGlobals=\"false\" \n    backupStaticAttributes=\"false\" \n    xsi:noNamespaceSchemaLocation=\"https://schema.phpunit.de/9.3/phpunit.xsd\"&gt;\n  &lt;coverage processUncoveredFiles=\"false\"&gt;\n    &lt;include&gt;\n      &lt;directory suffix=\".php\"&gt;src&lt;/directory&gt;\n    &lt;/include&gt;\n    &lt;exclude&gt;\n      &lt;directory&gt;vendor&lt;/directory&gt;\n      &lt;directory&gt;build&lt;/directory&gt;\n    &lt;/exclude&gt;\n  &lt;/coverage&gt;\n  &lt;testsuites&gt;\n    &lt;testsuite name=\"Tests\"&gt;\n      &lt;directory suffix=\"Test.php\"&gt;tests&lt;/directory&gt;\n    &lt;/testsuite&gt;\n  &lt;/testsuites&gt;\n&lt;/phpunit&gt;\n</code></pre> <p>Modifiez le fichier .gitignore pour ajouter la ligne suivante <code>build/</code>.</p>"},{"location":"notes_de_cours/api/unit_test/#executer-les-tests","title":"Ex\u00e9cuter les tests","text":"<p>Pour lancer les tests, faire la commande suivante dans un terimal \u00e0 la racine de l\u2019application <pre><code>composer test\n</code></pre></p> <p>Pour lancer les tests avec une couverture du code, faire la commande suivante <pre><code>composer test:coverage\n</code></pre></p> <p>Apr\u00e8s avoir lanc\u00e9 <code>composer test:coverage</code>, vous aurez acc\u00e8s \u00e0 deux pages html de r\u00e9sum\u00e9 des tests dans le r\u00e9pertoire build/coverage. </p>"},{"location":"notes_de_cours/api/unit_test/#erreur-avec-la-commande-testcoverage","title":"Erreur avec la commande test:coverage","text":"<p>Si vous utilisez AMPPS et que vous rencontrez l\u2019erreur suivante <code>Error: No code coverage driver is available</code> , il vous faut \u00e9diter le fichier php.ini de la fa\u00e7on suivante : </p> <pre><code>// Modifiez ces lignes\n;Xdebug\n;zend_extension=\"{$path}\\php-7.3\\lib\\php_xdebug.dll\"\n// Comme ceci\n[Xdebug]\nzend_extension=\"{$path}\\php-7.3\\lib\\php_xdebug.dll\"\n// Et ajoutez les deux lignes suivantes \u00e0 la suite\nxdebug.remote_autostart = 1\nxdebug.remote_enable = 1\n</code></pre> <p>Pour acc\u00e9der rapidement au fichier php.ini, affichez le tableau de bord de Ammps et \u00e0 la ligne PHP cliquez sur Settings et ensuite Configuration.</p>"},{"location":"notes_de_cours/api/unit_test/#ajouter-un-trait-a-notre-projet","title":"Ajouter un \"trait\" \u00e0 notre projet","text":"<p>Un trait est une sorte de classe abstraite qui nous permet de regrouper des fonctionnalit\u00e9s  pour ensuite les utiliser dans des classes. On va ajouter un trait \u00e0 notre projet pour faciliter l'execution des tests. </p> <ul> <li>Dans votre projet, cr\u00e9ez le r\u00e9pertoire <code>tests\\Traits</code></li> <li>T\u00e9l\u00e9chargez le fichier AppTestTrait.php et copiez-le dans le r\u00e9pertoire nouvellement cr\u00e9\u00e9.</li> </ul> <p>Comme vous pouvez voir, le fichier contient d\u00e9j\u00e0 sont lots de fonctions qu'on va pouvoir utiliser pour l'\u00e9x\u00e9cution de nos tests. Vous n'avez pas besoin de \"comprendre\" tous les fonctions, le but ici \u00e9tant de se concentrer sur l'\u00e9criture des tests. </p>"},{"location":"notes_de_cours/api/unit_test/#notre-premier-test-unitaire","title":"Notre premier test unitaire","text":"<p>Un test unitaire est un test effectu\u00e9 sur une seule classe PHP. </p> <p>Supposons une classe Calculator.php situ\u00e9 dans <code>src/Support/</code>. Notre classe \u00e0 une seule fonction <code>add()</code> qui prends en param\u00eatre deux entiers et les additionne : </p> <pre><code>&lt;?php\n\nnamespace App\\Support;\n\nclass Calculator\n{\n    public function add(int $a, int $b): int\n    {\n        return $a + $b;\n    }\n}\n?&gt;\n</code></pre> <p>On va cr\u00e9er une classe qui contiendra nos tests dans le r\u00e9pertoire <code>tests/TestCase/Support/CalculatorTest.php</code>. Par convention on va respecter l\u2019arborescence des r\u00e9pertoires (/Support) et le nom de la classe test va \u00eatre le m\u00eame que celui de la classe test\u00e9e \u00e0 laquelle on ajoute le suffixe Test (Calculator deviendra CalculatorTest). La classe doit \"\u00e9tendre\" (extends) TestCase qui, une classe de PHPUnit qui nous permettra de faire nos test. Voici un exemple de test o\u00f9 l'on s'assure que la fonction <code>add()</code> retourne le bon r\u00e9sultat.</p> <pre><code>&lt;?php\n// CalculatorTest.php\nnamespace App\\Test\\TestCase\\Support;\n\nuse App\\Support\\Calculator;\nuse PHPUnit\\Framework\\TestCase;\n\n// Oubliez pas d'ajouter extends TestCase\nclass CalculatorTest extends TestCase\n{\n    public function testAddReturnValidSum(): void\n    {\n        // Cr\u00e9ation d'un objet Calculator\n        $calculator = new Calculator();\n        // Ex\u00e9cution de la fonction add\n        $result = $calculator-&gt;add(30, 12);\n\n        // Ici on \"assert\" que la fonction add de la \n        // classe Calculator retourne la bonne valeur\n        $this-&gt;assertEquals(42, $result);\n    }\n}\n</code></pre> <p>Et maintenant pour lan\u00e7ons notre test avec la commande <code>composer test</code> \u00e0 partir d'une console \u00e0 la racine de notre projet. </p> <p>R\u00e9sultat positif</p> <p>Si on lance le test avec notre exemple, on va avoir le r\u00e9sultat suivant. On peut voir que la fonction <code>testAddReturnValidSum</code> retourne un r\u00e9sultat valide.</p> <p></p> <p>C\u2019est le nom de la fonction qui est utilis\u00e9 comme titre dans le r\u00e9sultat des tests. Il faut qu\u2019elle commence par test et qu\u2019on utilise le \u00ab CamelCase \u00bb testAddReturnValidSum =&gt; Add return valid sum.</p> <p>R\u00e9sultat n\u00e9gatif</p> <p>Si on modifie la valeur de la ligne 17 de CalculatorTest.php pour 421 au lieu de 42 (pour simuler un erreur dans notre fonction), on aura le r\u00e9sultat suivant : </p> <p></p>"},{"location":"notes_de_cours/api/unit_test/#tests-unitaires-de-nos-routes","title":"Tests unitaires de nos routes","text":"<p>On va cr\u00e9er une classe par route qu\u2019on veut tester. Elle sera cr\u00e9er dans le r\u00e9pertoire tests/TestCase/[La m\u00eame structure que la classe \u00e0 tester]</p> <p>Exemple d'une classe test</p> <p>Je veux un test qui couvre la classe <code>src/Action/Book/BookViewByIdAction.php</code>, je vais cr\u00e9er ma classe test dans le r\u00e9pertoire <code>tests/TestCase/Action/Book</code>. On pourrait seulement la cr\u00e9er dans tests/TestCase mais la premi\u00e8re structure permet de garder le code claire, surtout si on a beaucoup de tests \u00e0 cr\u00e9er.</p> <ul> <li>La classe test va porter le m\u00eame nom que la classe test\u00e9 en y ajoutant Test \u00e0 la fin. </li> <li>Je veux tester BookViewByIdAction, ma classe test va donc se nommer BookViewByIdActionTest.</li> <li>La classe va \u00ab extends \u00bb TestCase et utiliser AppTestTrait (voir code exemple plus loin).</li> <li>Ensuite on va cr\u00e9e une ou des fonctions qui vont contenir nos tests.</li> <li>Le nom de la fonction doit obligatoirement commencer par test.</li> <li>Le nom de la fonction sera ce qui est affich\u00e9 dans le r\u00e9sultat. Le mot test du d\u00e9but sera supprim\u00e9 et le caract\u00e8re _ deviendra un espace.</li> <li><code>testBookViewById_Retourne_les_bonnes_valeurs</code> devient BookViewById Retourne les bonnes valeurs</li> </ul> <pre><code>&lt;?php\n\nnamespace App\\Test\\TestCase\\Action\\Book;\n\nuse App\\Test\\Traits\\AppTestTrait;\nuse PHPUnit\\Framework\\TestCase;\n\nclass BookViewByIdActionTest extends TestCase\n{\n    // On inclus ici une r\u00e9f\u00e9rence au trait qu'on a cr\u00e9\u00e9 plus haut\n    use AppTestTrait;\n\n    public function testBookViewById_Retourne_les_bonnes_valeurs(): void\n    {\n        // Les valeurs de retour attendues\n        $expected = [\n            [\n                \"id\" =&gt; \"74\",\n                \"genreId\" =&gt; \"1\",\n                \"titre\" =&gt; \"Blade Runner\",\n                \"isbn\" =&gt; \"9782290314944\"\n            ]\n        ];\n\n        // On cr\u00e9e la requ\u00eate en faisant un appel \u00e0 la route \u00e0 tester\n        // la fonction createJsonRequest provient du trait AppTestTrait\n        $request = $this-&gt;createJsonRequest('GET', '/books/74');\n        // On effectue la requ\u00eate et r\u00e9cup\u00e8re le r\u00e9sultat\n        $response = $this-&gt;app-&gt;handle($request);\n\n        // C'est ici qu'on fait nos affirmations (assert)\n        // J'affirme que le code de statut de la r\u00e9ponse est 200\n        $this-&gt;assertSame(200, $response-&gt;getStatusCode());\n        // J'affirme que les valeurs de retour correspondent \u00e0 ce qui est attendu\n        $this-&gt;assertJsonData($expected, $response);\n    }\n}\n</code></pre>"},{"location":"notes_de_cours/api/unit_test/#references","title":"R\u00e9f\u00e9rences","text":"<p>Postman</p> <ul> <li>https://learning.postman.com/docs/writing-scripts/test-scripts/</li> <li>https://learning.postman.com/docs/writing-scripts/script-references/test-examples/</li> </ul> <p>PHPUnit</p> <ul> <li>https://phpunit.de/getting-started/phpunit-9.html</li> <li>https://phpunit.readthedocs.io/fr/latest/</li> </ul>"},{"location":"notes_de_cours/heroku/heroku/","title":"H\u00e9bergement d'un api avec Heroku","text":"<p>Heroku est une plateforme permettant de d\u00e9ployer rapidement nos applications web pour pouvoir les tester gratuitement. Nous allons utiliser ses services dans le cadre du cours pour mettre en ligne nos api ainsi que les clients qu'on va d\u00e9velopper pour les interroger. </p>"},{"location":"notes_de_cours/heroku/heroku/#marche-a-suivre","title":"Marche \u00e0 suivre","text":"<ol> <li>Cr\u00e9ation d'un compte Heroku</li> <li>Connexion \u00e0 Heroku depuis un terminal</li> <li>Cr\u00e9ation d'un projet Heroku</li> <li>Mise en ligne du projet</li> <li>Configuration de la base de donn\u00e9es MySQL</li> </ol>"},{"location":"notes_de_cours/heroku/heroku/#test-du-deploiement","title":"Test du d\u00e9ploiement","text":"<p>\u00c0 partir de maintenant vos application devrait \u00eatre fonctionnelles. Vous pouvez acc\u00e9der \u00e0 vos route depuis postman ou un navigagteur en modifiant le nom de domaine de l'url.</p> <p></p>"},{"location":"notes_de_cours/heroku/heroku_compte/","title":"Cr\u00e9ation d'un compte Heroku","text":"<ul> <li>Cr\u00e9ez-vous un compte gratuit sur le site de Heroku</li> <li>T\u00e9l\u00e9charger ensuite le CLI Heroku</li> <li>Une fois connect\u00e9 \u00e0 votre compte, vous avez un lien \u00ab documentation \u00bb \u00e0 cliquer dans le bas de la page. </li> <li>Ensuite dans la section Heroku Essentials, cliquez sur \u00ab The Heroku CLI \u00bb. </li> <li>S\u00e9lectionnez le bon installateur selon votre syst\u00e8me d\u2019exploitation.</li> <li>Une fois le client install\u00e9, lancer la commande <code>heroku -v</code> depuis un terminal pour valider l\u2019installation.</li> </ul> <pre><code>$ heroku -v\n</code></pre>"},{"location":"notes_de_cours/heroku/heroku_connexion/","title":"Connexion \u00e0 Heroku depuis un terminal","text":"<ul> <li>Dans la console, faire la commande <code>heroku login</code></li> </ul> <pre><code>$ heroku login\n</code></pre> <ul> <li>Apr\u00e8s avoir appuy\u00e9 sur une touche, un \u00e9cran de connexion s\u2019ouvrira dans votre navigateur.</li> <li>Une fois connect\u00e9 depuis le navigateur, une confirmation s\u2019affichera dans la console.</li> </ul>"},{"location":"notes_de_cours/heroku/heroku_creation_projet/","title":"Cr\u00e9ation d'un projet Heroku","text":"<ul> <li>Dans la console \u00e0 la racine de votre application, entrez la commande suivant <code>heroku create</code></li> </ul> <pre><code>$ heroku create\n</code></pre> <ul> <li>Une adresse url de votre projet sera g\u00e9n\u00e9r\u00e9e automatiquement.</li> <li>Un d\u00e9p\u00f4t Git sera aussi cr\u00e9\u00e9 sur les serveurs de Heroku. Ce d\u00e9p\u00f4t sera utilis\u00e9 pour mettre en ligne votre projet.</li> </ul> <ul> <li>Url du projet (en bleu) : <code>https://secret-escarpment-53166.herokuapp.com/</code></li> <li>Url du d\u00e9p\u00f4t (en vert) : <code>https://git.heroku.com/secret-escarpment-53166.git</code></li> </ul> <p>Vous pouvez valider que le d\u00e9p\u00f4t git de Heroku est bien associ\u00e9 \u00e0 votre projet en faisant la commande <code>git remote -v</code></p> <p> </p>"},{"location":"notes_de_cours/heroku/heroku_creation_projet/#modifier-lurl-du-projet-et-du-depot-git","title":"Modifier l'url du projet et du d\u00e9p\u00f4t git","text":"<p>Vous pouvez modifier l'url de votre projet depuis le tableau de bord du site de Heroku.</p> <ul> <li>Depuis le tableau de bord, s\u00e9lectionnez votre projet</li> <li>Cliquez sur l'onglet Settings</li> <li>Dans la section App Information, modifiez la valeur de App Name pour le nouveau nom de votre projet et cliquez sur Save</li> <li>Attention, vous devrez ensuite modifier l'url du \"remote\" sur votre branche locale de git.</li> <li>Copier le nouveau url g\u00e9n\u00e9r\u00e9, il est affich\u00e9 dans la m\u00eame section sous Heroku git URL</li> <li>Dans le terminal \u00e0 la racine de votre projet faites la commande <code>git remote set-url heroku votre-url-heroku</code></li> <li>Revalidez ensuite avec la commande <code>git remote -v</code>, les urls associ\u00e9s \u00e0 heroku devrait avoir \u00e9t\u00e9 chang\u00e9.</li> </ul>"},{"location":"notes_de_cours/heroku/heroku_mise_en_ligne/","title":"Mise en ligne du projet","text":"<p>Dans la console \u00e0 la racine de votre application, entrez la commande suivante</p> <pre><code>$ git push heroku main\n</code></pre> <ul> <li>Selon la configuration de votre repository GitHub, \u00e7a pourrait \u00eatre aussi Master au lieu de main.</li> <li>Apr\u00e8s l\u2019installation de votre application (le premier git push), vous pourrez voir les changements en acc\u00e9dant \u00e0 l\u2019url que Heroku vous a g\u00e9n\u00e9r\u00e9. (pour l\u2019instant la bd MySQL n\u2019est pas configur\u00e9e, donc l\u2019acc\u00e8s \u00e0 vos routes ne fonctionnera pas. Mais la route pour la documentation sera fonctionnel.)</li> </ul> <p>\u00c0 partir de maintenant, pour d\u00e9ployer notre projet, on relance la commande <code>git push heroku main</code>. </p> <p>Quand on a cr\u00e9\u00e9 le projet Heroku, un repository git s\u2019est cr\u00e9er pour heroku. Il faudra garder \u00e0 l\u2019esprit qu\u2019il est s\u00e9par\u00e9 de notre repo github. Donc quand on fait <code>git push heroku main</code>, on pousse les changements sur le d\u00e9p\u00f4t pour le projet Heroku mais pas sur notre github. Une bonne fa\u00e7on de proc\u00e9der est de continuer \u00e0 \u00ab pusher \u00bb sur notre github et quand on est pr\u00eat \u00e0 mettre le code en ligne, on \u00ab push \u00bb sur Heroku.</p>"},{"location":"notes_de_cours/heroku/heroku_mysql/","title":"Configuration de la base de donn\u00e9es MySQL","text":"<p>Pour permettre l'utilisation d'une base de donn\u00e9e MySQL avec Heroku, il faut ajouter l'Add-on ClearDB \u00e0 notre projet.</p> <ul> <li>Acc\u00e9dez \u00e0 la section account settings sur le site de heroku (cliquez sur la photo de profil pour ouvrir le menu)</li> <li>M\u00eame si le service qu\u2019on utilise est gratuit, vous allez devoir entrer les informations d\u2019une carte de cr\u00e9dit dans l\u2019onglet billing</li> <li>Une fois la carte de cr\u00e9dit saisie, acc\u00e9der \u00e0 la page de votre projet en revenant au tableau de bord (page principale) et en cliquant sur le nom du projet</li> <li>Dans la section installed add-ons cliquez sur configure add-ons</li> <li>Faites une recherche pour clearDB mysql et choisissez ignite-free comme plan et cliquez sur Submit Order Form</li> <li>Une fois l'ajout termin\u00e9, vous devriez avoir ClearDB dans les add-ons</li> </ul> <p> </p>"},{"location":"notes_de_cours/heroku/heroku_mysql/#recuperer-des-informations-de-connexion","title":"R\u00e9cup\u00e9rer des informations de connexion","text":"<p>Dans la console \u00e0 la racine de votre application, entrez la commande suivante <pre><code>$ heroku config\n</code></pre></p> <p>R\u00e9sultat de la commande</p> <p></p> <p>\u00c0 la ligne CLEARDB_DATABASE_URL vous trouverez les informations de connexion \u00e0 la BD. Les diff\u00e9rentes valeurs ont une position bien pr\u00e9cise dans la cha\u00eene de texte.</p> Variable Position dans la cha\u00eene Valeur selon l'exemple username entre // et : b4692d61f95260 password entre : et @ 06aee1da host entre @ et / us-cdbr-east-05.cleardb.net database entre / et ? heroku_330c927d2db0d16 <p>Vous pouvez maintenant cr\u00e9er une connexion avec un gestionnaire de base de donn\u00e9es (workbench, dbeaver, etc\u2026)</p>"},{"location":"notes_de_cours/heroku/heroku_mysql/#importer-une-base-de-donnees","title":"Importer une base de donn\u00e9es","text":"<p>Dans un terminal lancez la commande suivante pour faire un backup de la base de donn\u00e9es MySQL</p> <pre><code>$ mysqldump -h localhost -u root -pmysql --opt --routines --triggers libapi &gt; db_create.sql\n</code></pre> <p></p> <ul> <li>Modifier les valeurs de l'usager (root), du mot de passe (mysql) et du nom de la base de donn\u00e9es (libapi) selon votre configuration</li> <li>Le fichier db_create.sql va \u00eatre cr\u00e9\u00e9 dans le r\u00e9pertoire o\u00f9 vous avez lanc\u00e9 la commande.</li> <li>Ensuite encore en console on peut faire la commande suivante pour importer le script sql dans notre base de donn\u00e9es en ligne.</li> </ul> <pre><code>$ mysql -u b5ca43976743b6 -h us-cdbr-east-03.cleardb.com -p3fba289e heroku_85142f7d498789b &lt; db_create.sql\n</code></pre> <p>En modifiant selon les informations de connexion obtenues auparavant avec la commande <code>heroku config</code>.</p> <p></p> <p>Si vous avez l'erreur suivante</p> <pre><code>ERROR 1071 (42000) at line 25: Specified key was too long; max key length is 767 bytes\n</code></pre> <p>modifiez dans la base de donn\u00e9es le type de donn\u00e9es du champs <code>username</code> de la table <code>users</code> pour <code>varchar(50)</code> au lieu de <code>varchar(255)</code></p>"},{"location":"notes_de_cours/heroku/heroku_mysql/#stocker-les-informations-de-connexion","title":"Stocker les informations de connexion","text":"<p>Pour nous simplifier la vie, on va stocker les informations dans un fichier php qui selon une constante retournera les bonnes valeurs. </p>"},{"location":"notes_de_cours/heroku/heroku_mysql/#creation-du-fichier-envphp","title":"Cr\u00e9ation du fichier env.php","text":"<ul> <li>Dans le r\u00e9pertoire <code>config</code>de votre projet cr\u00e9ez les fichier <code>env.php</code></li> <li>Entrez ensuite vos informations de connexion \u00e0 la base de donn\u00e9es MySQL en local et sur heroku</li> <li>La structure du fichier est la suivante</li> </ul> <pre><code>&lt;?php \n\n// Constante du mode de l'application\n// dev : variables utilis\u00e9es en local\n// prod : pour le d\u00e9ploiement de l'api en production\ndefine(\"MODE\", \"prod\");\n\nswitch (MODE) {\n    case \"dev\":\n        // Configuration BD en local\n        $_ENV['host'] = 'localhost';\n        $_ENV['username'] = 'root';\n        $_ENV['database'] = 'libapi';\n        $_ENV['password'] = 'mysql';\n        break;\n\n    case \"prod\":\n        // Configuration BD pour Heroku\n        $_ENV['host'] = 'us-cdbr-east-05.cleardb.net';\n        $_ENV['username'] = 'b4692d61f95260';\n        $_ENV['database'] = 'heroku_330c927d2db0d16';\n        $_ENV['password'] = '06aee1da';\n        break;\n};\n</code></pre> <p>Vous n'avez ensuite quand changer la valeur de la constante <code>MODE</code> \u00e0 la ligne 6 selon les valeurs que vous voulez utiliser. </p> <ul> <li>dev pour la base de donn\u00e9es local</li> <li>prod pour la base de donn\u00e9es Heroku</li> </ul>"},{"location":"notes_de_cours/heroku/heroku_mysql/#modification-au-fichier-bootstrapphp","title":"Modification au fichier bootstrap.php","text":"<p>Pour charger les variables d\u2019environnements du fichier <code>env.php</code>, ajoutez la ligne suivante dans le fichier <code>config/bootstrap.php</code>.</p> <pre><code>&lt;?php\n\nuse DI\\ContainerBuilder;\nuse Slim\\App;\n\nrequire_once __DIR__ . '/../vendor/autoload.php';\n// Chargement des variables d'environnement\nrequire_once __DIR__ . '/env.php'; // Ligne \u00e0 ajouter\n\n$containerBuilder = new ContainerBuilder();\n</code></pre>"},{"location":"notes_de_cours/heroku/heroku_mysql/#modification-au-fichier-settingsphp","title":"Modification au fichier settings.php","text":"<p>Modifier la section db du fichier <code>config/settings.php</code> pour utiliser les variables d\u2019environnement.</p> <pre><code>// ...\n\n// Database settings\n$settings['db'] = [\n    'driver' =&gt; 'mysql',\n    'host' =&gt; $_ENV['host'],\n    'username' =&gt; $_ENV['username'],\n    'database' =&gt; $_ENV['database'],\n    'password' =&gt; $_ENV['password'],\n    'charset' =&gt; 'utf8',\n    'collation' =&gt; 'utf8_general_ci',\n    'flags' =&gt; [\n        // Turn off persistent connections\n        PDO::ATTR_PERSISTENT =&gt; false,\n        // Enable exceptions\n        PDO::ATTR_ERRMODE =&gt; PDO::ERRMODE_EXCEPTION,\n        // Emulate prepared statements\n        PDO::ATTR_EMULATE_PREPARES =&gt; true,\n        // Set default fetch mode to array\n        PDO::ATTR_DEFAULT_FETCH_MODE =&gt; PDO::FETCH_ASSOC,\n        // Set character set\n        PDO::MYSQL_ATTR_INIT_COMMAND =&gt; 'SET NAMES utf8 COLLATE utf8_general_ci'\n    ],\n];\n\n// ...\n</code></pre>"},{"location":"notes_de_cours/heroku/heroku_mysql/#source","title":"Source","text":"<ul> <li>https://devcenter.heroku.com/articles/cleardb</li> </ul>"},{"location":"notes_de_cours/node/introduction/","title":"Introduction \u00e0 Node.js","text":"<p>Javascript est un langage de programmation qui est interpret\u00e9 par le navigateur dans lequel il est ex\u00e9cut\u00e9. Avec Node.js on s'affranchit de cette d\u00e9pendance au navigateur en pouvant lancer du code JavaScript directement depuis notre machine. On peut donc programmer notre logique c\u00f4t\u00e9 serveur (backend) directement en JavaScript. Pour le dire autrement, Node.js nous fournit un environnement d'ex\u00e9cution (runtime environment) Javascript sans aucun lien avec les navigateurs.</p>"},{"location":"notes_de_cours/node/introduction/#installation-de-node","title":"Installation de Node","text":"<ul> <li>Node.js 20.11.0 LTS</li> <li>T\u00e9l\u00e9chargement de Node.js</li> </ul>"},{"location":"notes_de_cours/node/introduction/#executer-du-code-javascript-sur-un-serveur","title":"Ex\u00e9cuter du code JavaScript sur un serveur","text":"<ul> <li>Cr\u00e9ez un fichier .js qui va contenir votre code</li> <li>Lancez le fichier avec la commande <code>node nomFichier.js</code></li> </ul> hello.js<pre><code>console.log(\n    'J\u2019\u00e9cris directement dans la console! Je peux faire du code qui ne s\u2019ex\u00e9cute que sur le serveur'\n);\n\nvar fruits = ['pomme', 'orange', 'banane'];\n\nfruits.forEach(afficherElementTableau);\n\n/*\n* Affiche \u00e0 la console un \u00e9l\u00e9ment du tableau\n*\n* @param item - L'item \u00e0 afficher\n* @param index - La position de l'item dans le tableau\n*/\nfunction afficherElementTableau(item, index) {\n    console.log(index + ':' + item);\n}\n</code></pre>"},{"location":"notes_de_cours/node/introduction/#references","title":"R\u00e9f\u00e9rences","text":"<ul> <li>Introduction \u00e0 Node.js</li> <li>Documentation officielle node.js</li> </ul>"},{"location":"notes_de_cours/node/npm/","title":"npm","text":"<p>Npm est le gestionnaire de paquets (modules) officiel de Node.js. Celui-ci permet d\u2019ajouter des modules externes dans une application Node.js Depuis la version 0.6.3 de Node.js, npm fait partie de l'environnement et est donc automatiquement install\u00e9 par d\u00e9faut. npm fonctionne avec un terminal et g\u00e8re les d\u00e9pendances pour une application. Il permet \u00e9galement d'installer des applications Node.js disponibles sur le d\u00e9p\u00f4t npm.</p> <p>Manuel</p> <p>Documentation de npm js Wikipedia - Article sur npm </p>"},{"location":"notes_de_cours/node/npm/#npm-init","title":"npm init","text":"<p>La commande npm init permet d\u2019initialiser un projet Node.js dans le but de g\u00e9rer les modules associ\u00e9s au projet. </p> console<pre><code>npm init -y\n</code></pre> <p>Cette commande cr\u00e9e un fichier nomm\u00e9 package.json qui contiendra les configurations du projet ainsi que la liste des divers modules n\u00e9cessaires pour son bon fonctionnement. L'option -y va cr\u00e9er le fichier avec les informations par d\u00e9faut.</p> <p>Cette commande devrait toujours \u00eatre ex\u00e9cut\u00e9e avant de proc\u00e9der \u00e0 l\u2019installation de modules. </p> <p>Manuel</p> <p>npm init</p> package.json<pre><code>{\n  \"name\": \"AppName\",\n  \"version\": \"1.0.0\",\n  \"description\": \"\",\n  \"main\": \"index.js\",\n  \"scripts\": {\n    \"test\": \"echo \\\"Error: no test specified\\\" &amp;&amp; exit 1\"\n  },\n  \"keywords\": [],\n  \"author\": \"\",\n  \"license\": \"ISC\"\n}\n</code></pre>"},{"location":"notes_de_cours/node/npm/#npm-install","title":"npm install","text":"<p>La commande npm install permet d\u2019installer des modules dans un projet. Lors de l\u2019ajout d\u2019un premier module au projet, le dossier node_modules est automatiquement cr\u00e9\u00e9.  Pour installer un module dans un projet :</p> console<pre><code>npm install nomModule\n</code></pre> <p>Pour chaque installation de module : Un sous-dossier au nom du module est cr\u00e9\u00e9. Toutes les d\u00e9pendances sont \u00e9galement charg\u00e9es. Le module et ses d\u00e9pendances sont ajout\u00e9es dans le fichier package.json </p> <p>Partage et D\u00e9ploiement : Lorsqu\u2019on partage un projet, on ne fournit g\u00e9n\u00e9ralement pas le dossier node_modules car sa taille peut devenir relativement \u00e9lev\u00e9e et les versions de Node.js ne sont pas n\u00e9cessairement les m\u00eames.  La commande npm install (sans pr\u00e9ciser le nom du module) permet d\u2019installer automatiquement tous les modules manquants (npm se fie au fichier package.json pour identifier les modules \u00e0 installer)</p>"},{"location":"notes_de_cours/node/npm/#les-options","title":"Les options","text":"<p>Lors de l\u2019installation de modules, je recommande toujours d\u2019utiliser la commande disponible dans la proc\u00e9dure d\u2019installation du module.  Parfois, certaines options sont n\u00e9cessaires.  </p> <p>Manuel</p> <p>npm-install </p> <p>Les plus courantes :  </p> <ul> <li>--save ou -S : Ajoute le module \u00e0 la liste de d\u00e9pendances dans le fichier package.json. Cette option n\u2019est plus n\u00e9cessaire depuis la version npm 5.0.0, les modules \u00e9tant ajout\u00e9s par d\u00e9faut \u00e0 la liste de d\u00e9pendances. Vous verrez cependant r\u00e9guli\u00e8rement cette option dans les proc\u00e9dures d\u2019installation de modules officiels.  </li> <li>--global ou -g : Ajoute le module globalement sur votre PC. Je recommande peu cette option \u00e0 moins que le module ne soit pas implicitement impliqu\u00e9 dans le projet. npm global (If you are using npm 5.2 or higher, we recommend using\u00a0npx\u00a0to run packages globally).  </li> </ul>"},{"location":"notes_de_cours/node/npm/#npm-install-save-dev","title":"npm install --save-dev","text":"<p>Dans votre d\u00e9veloppement, c\u2019est possible que vous utilisiez des modules seulement pour aider le d\u00e9veloppement, mais qui ne sont pas n\u00e9cessaires en production.</p> <p>Dans ce cas, il faut utiliser npm install avec l\u2019option --save-dev ou -D.  </p> <p>Ex :   </p> console<pre><code>npm install nodemon --D\n</code></pre> <p>Dans packages.json \u00e7a donne :  </p> packages.json<pre><code>{\n  \"name\": \"AppName\",\n  \"version\": \"1.0.0\",\n  \"description\": \"\",\n  \"main\": \"index.js\",\n  \"scripts\": {\n    \"test\": \"echo \\\"Error: no test specified\\\" &amp;&amp; exit 1\"\n  },\n  \"keywords\": [],\n  \"author\": \"\",\n  \"license\": \"ISC\",\n  \"devDependencies\": {\n    \"nodemon\": \"^3.0.2\"\n  }\n}\n</code></pre>"},{"location":"notes_de_cours/node/npm/#modules-utiles-au-developpement","title":"Modules utiles au d\u00e9veloppement","text":""},{"location":"notes_de_cours/node/npm/#nodemon","title":"nodemon","text":"<p>Module qui observe les fichiers de votre projet et qui red\u00e9marre le programme automatiquement.</p> <p>Installation : </p> Console<pre><code>npm install nodemon -D\n</code></pre> <p>L'option -D (ou --save-dev) indique que le module sera install\u00e9 que pour le d\u00e9veloppement et qui n'est pas n\u00e9cessaire. C'est le cas ici pour nodemon</p> <p>Pour faciliter l\u2019utilisation de nodemon, ajoutez un script dans packages.json en ajustant le nom du fichier JavaScript \u00e0 lancer au d\u00e9marrage : </p> packages.json<pre><code>{\n  \"name\": \"AppName\",\n  \"version\": \"1.0.0\",\n  \"description\": \"\",\n  \"main\": \"index.js\",\n  \"scripts\": {\n    \"start\": \"nodemon fichier.js\"\n  },\n  \"keywords\": [],\n  \"author\": \"\",\n  \"license\": \"ISC\",\n  \"devDependencies\": {\n    \"nodemon\": \"^3.0.2\"\n  }\n}\n</code></pre> <p>Pour ex\u00e9cuter votre programme, il suffit de faire la commande :</p> console<pre><code>npm start\n</code></pre>"},{"location":"notes_de_cours/node/npm/#dotenv","title":"dotenv","text":"<p>Param\u00e9trer votre application directement dans le code est imprudent. Des informations confidentielles peuvent se retrouver dans votre repo GitHub \u00e0 la vue de tout le monde, ex :  </p> a_ne_pas_faire.js<pre><code>const cleAPI = \"FKSDKLJFKDSKLJF898FSDKJKSD898F9DSKLFDSKFSD\";\nconst utilisateurBD = \"admin\";\nconst motDePasse=\"password\";\n</code></pre> <p>Installation : </p> console<pre><code>npm install dotenv  \n</code></pre> <p>Pour plus de s\u00e9curit\u00e9 cr\u00e9\u00e9 un fichier nomm\u00e9 .env qui va contenir les informations sensibles. Ce fichier ne doit pas \u00eatre index\u00e9 dans votre d\u00e9pot Github, penser \u00e0 l'ajouter au fichier .gitignore.</p> <p>.env<pre><code>cleAPI=\"FKSDKLJFKDSKLJF898FSDKJKSD898F9DSKLFDSKFSD\"\nutilisateurBD=\"admin\"\nmotDePasse=\"password\"\n</code></pre> Ensuite dans le code import\u00e9 le fichier et vous pouvez r\u00e9cup\u00e9rer les informations de cette fa\u00e7on :   </p> a_faire.js<pre><code>const dotenv = require('dotenv');\n\ndotenv.config();\n\nconst cleAPI = process.env.cleAPI;\n</code></pre>"},{"location":"notes_de_cours/node/npm/#information-a-ajouter-dans-le-fichier-gitignore","title":"Information \u00e0 ajouter dans le fichier .gitignore","text":"<p>Il est essentiel de ne pas envoyer dans votre d\u00e9p\u00f4t git le dossier node_modules ainsi que le fichier .env si vous en avez un. Ajoutez ces lignes dans .gitignore : </p> .gitignore<pre><code>**/node_modules \n.env  \n</code></pre>"},{"location":"notes_de_cours/node/npm/#mise-a-jour-des-modules","title":"Mise \u00e0 jour des modules","text":"<p>Pour mettre \u00e0 jour les modules, on doit faire la commande </p> .gitignore<pre><code>npm update [-g] [&lt;pkg&gt;...]\n</code></pre> <p> </p> Le fonctionnement des versions <p>Explication du syst\u00e8me de version et des symboles utilis\u00e9s : npm version cheatsheet</p>"},{"location":"notes_de_cours/node/server_web/","title":"Introduction \u00e0 Node.js - Serveur Web","text":""},{"location":"notes_de_cours/node/server_web/#un-hello-world-dans-un-serveur-web","title":"Un Hello World dans un serveur web","text":"<p>Voici un petit exemple tout simple de serveur web qui affiche le message \"Hello World\". L'exemple est tir\u00e9 de la documentation de Node.js.</p> serveur_hello.js<pre><code>const http = require('node:http');\n\nconst hostname = '127.0.0.1';\nconst port = 3000;\n\nconst server = http.createServer((req, res) =&gt; {\n  res.statusCode = 200;\n  res.setHeader('Content-Type', 'text/plain; charset=utf-8');\n  res.end('Hello World\\n');\n});\n\nserver.listen(port, hostname, () =&gt; {\n  console.log(`Server running at http://${hostname}:${port}/`);\n});\n</code></pre> <ul> <li>Le module http de Node est inclus \u00e0 la premi\u00e8re ligne, c'est lui qui va \u00eatre en charge du serveur</li> <li>On d\u00e9finit ensuite une adresse d'h\u00f4te et un port pour notre serveur</li> <li>On cr\u00e9e un objet serveur \u00e0 la ligne 6. Dans la fonction de rappel les param\u00eatres repr\u00e9sentent des objets associ\u00e9s \u00e0 la requ\u00eate http qui est re\u00e7u (req) et la r\u00e9ponse retourn\u00e9e (res).</li> <li>Le statusCode est le code de statut retourn\u00e9, ici 200 pour un succ\u00e8s</li> <li>Le Content-Type d\u00e9fini le format de la r\u00e9ponse.</li> <li>Avec la fonction end() on envoi le texte de la r\u00e9ponse.</li> <li>La fonction listen \u00e0 la ligne 12 lance le serveur et le met en mode \"\u00e9coute\"</li> </ul> <p>Pour lancer le serveur</p> <ul> <li>Lancer le programme avec la commande <code>node serveur_hello.js</code> dans un terminal.</li> <li>Depuis un navigateur acc\u00e9d\u00e9 \u00e0 l'url <code>http://localhost:3000/</code></li> </ul>"},{"location":"notes_de_cours/node/server_web/#lurl-et-ses-parametres","title":"L'url et ses param\u00e8tres","text":"Comment extraire les parties d'un url <p>Deux modules \u00e0 ajouter pour utiliser les commandes de l'image</p> <pre><code>const url = require('url');\nconst querystring = require('node:querystring'); \n</code></pre> <p>On peut aussi simplifier l'acquisition des param\u00e8tres en ajoutant le param\u00e8tre true \u00e0 la fonction url.parse(). \u00c7a permet d'automatiquement convertir les param\u00e8tres de la requ\u00eate en objet. \u00c7a \u00e9vite l'utilisation de <code>querystring</code>.</p> <pre><code>const params = url.parse(req.url, true).query;\n</code></pre> <p>La variable params est un tableau associatif avec le nom des param\u00e8tres en cl\u00e9. Donc si je re\u00e7ois le param\u00e8tre page=1, je peux y acc\u00e8der avec comme ceci.</p> <pre><code>console.log(params[\"page\"]);  // La valeur affich\u00e9 sera 1\n</code></pre>"},{"location":"notes_de_cours/node/server_web/#exemple-de-serveur-web-avec-gestion-des-parametres","title":"Exemple de serveur web avec gestion des param\u00e8tres","text":"serveur_parametres.js<pre><code>const http = require('node:http');\nconst url = require('url');\n\nconst hostname = 'localhost';\nconst port = 3000;\n\nconst server = http.createServer((req, res) =&gt; {\n    // R\u00e9cup\u00e9ration des param\u00e8tres\n    const params = url.parse(req.url, true).query;\n    const route = url.parse(req.url).pathname;\n\n    // Affichage des valeurs de la requ\u00eate\n    console.log('Route : ' + route);\n    console.log('Param\u00e8tres : ' + JSON.stringify(params));\n\n    // Retourne les param\u00e8tres en JSON dans la r\u00e9ponse\n    res.statusCode = 200;\n    res.setHeader('Content-Type', 'application/json');\n    res.write(JSON.stringify(params));\n\n    res.end();\n});\n\nserver.listen(port, hostname, () =&gt; {\n    console.log(`Server running at http://${hostname}:${port}/`);\n});\n</code></pre> <p>Pour lancer le code, ex\u00e9cutez le fichier et entrez l'url  <code>http://localhost:3000/</code> dans un navigateur avec n'importe quels param\u00e8tres. Par exemple  <code>http://localhost:3000/param1=hello&amp;param2=world</code>. Le serveur va retourner les param\u00e8tres sous format JSON.</p>"},{"location":"notes_de_cours/node/server_web/#autre-exemple-avec-gestion-des-routes","title":"Autre exemple avec gestion des routes","text":"serveur_route.js<pre><code>const http = require('node:http');\nconst url = require('url');\nconst querystring = require('node:querystring'); \n\nconst hostname = 'localhost';\nconst port = 3000;\nconst server = http.createServer((req, res) =&gt; {\n  res.statusCode = 200;\n  res.setHeader('Content-Type', 'text/plain; charset=utf-8');\n\n  let page = req.url ? req.url : '/';\n  if (page == '/') {\n    res.write(\n      \"Bienvenue au jeu d'\u00e9vasion entrez dans la salle de regroupement.\"\n    );\n  } else if (page == '/salle-serveurs') {\n    res.write('Vous \u00eates dans la salles des serveurs, bonne chance !');\n  } else if (page == '/etage/1/prof') {\n    res.write('H\u00e9 ho, que fa\u00eetes-vous dans mon bureau !?!?!');\n  } else {\n    res.statusCode = 404;\n  }\n  res.end();\n});\n\nserver.listen(port, hostname, () =&gt; {\n  console.log(`Server running at http://${hostname}:${port}/`);\n});\n</code></pre> <p>\u00c0 la ligne 11 on r\u00e9cup\u00e8re le nom de la route dans l'url. Ensuite avec une s\u00e9rie de if..else on peut ex\u00e9cut\u00e9 un traitement diff\u00e9rent selon la route. Si la route est diff\u00e9rente de ceux qu'on a cod\u00e9, on retourne une erreur 404.</p>"},{"location":"notes_de_cours/php/02_revision_php/","title":"Exercice 02 - Revision PHP","text":"<ol> <li>Cr\u00e9er un fichier nomm\u00e9 exercice02.php et ajoutez la structure de base d'un fichier HTML. </li> <li>Cr\u00e9er une variable qui va contenir le texte \"J'adore le PHP!!!\" et afficher le contenu de la variable dans la une balise H1.</li> <li>Cr\u00e9ez un tableau associatif (cl\u00e9 - valeur) avec une dizaine de valeurs \u00e0 votre choix. </li> <li>Ajouter un nouvel \u00e9l\u00e9ment dans le tableau dont la cl\u00e9 se nommera \"sous-tableau\". La valeur de celui-ci sera un tableau sans cl\u00e9 avec les valeurs de votre choix.</li> <li>Modifier la valeur du dernier \u00e9l\u00e9ment du sous-tableau que vous venez d'ajouter.</li> <li>Ajouter 10 \u00e9l\u00e9ments dans le tableau de l'\u00e9l\u00e9ment \"sous-tableau\" \u00e0 l'aide d'une boucle.</li> <li>Supprimer le dernier \u00e9l\u00e9ment du tableau de l'\u00e9l\u00e9ment \"sous-tableau\".</li> <li>Afficher le contenu du tableau dans la page web sous la forme d'une liste \u00e0 puces. Les valeurs du tableau de l'\u00e9l\u00e9ment \"sous-tableau\" sera une sous-liste de la premi\u00e8re. </li> <li>Cr\u00e9ez un deuxi\u00e8me tableau associatif et ajoutez le au premier en les \"d\u00e9ballants\". Si vous n'avez pas la bonne version de PHP vous pouvez utiliser la fonction array_merge().</li> <li>Avec l'api de Random User, cr\u00e9ez une requ\u00eate GET qui retournera 50 utilisateurs al\u00e9atoire qui proviennent du Canada. Avec les fonction array_map() et array_filter() cr\u00e9ez un nouveau tableau avec uniquement les valeurs du nom, prenom, adresse courriel et nom d'usager de chacun des utilisateurs qui ont moins de 40 ans.</li> <li>Affichez le r\u00e9sultat dans la page HTML sous la forme d'un tableau. </li> <li>Convertissez le tableau obtenu au du point 11 en format json et validez le avec jsonlint. Pour r\u00e9cup\u00e9rer le r\u00e9sultat, inscrivez-le dans le fichier de log de PHP ou dans la page html.</li> <li>Remettez-moi le fichier exercice02.php une fois termin\u00e9 sur Teams.</li> </ol>"},{"location":"notes_de_cours/php/array/","title":"Les tableaux","text":""},{"location":"notes_de_cours/php/array/#declaration-dun-tableau","title":"D\u00e9claration d'un tableau","text":"<p>Pour d\u00e9clarer un tableau, on peut utiliser la fonction array() ou en notation courte utiliser []</p> <pre><code>&lt;?php\n// D\u00e9claration d'un tableau avec la fonction array()\n$monTableau = array(\"item1\", \"item2\", \"item3\");\n\n// D\u00e9claration d'un tableau avec la notation courte\n$monTableau = [\"item1\", \"item2\", \"item3\"];\n?&gt;\n</code></pre> <p>Chaque \u00e9l\u00e9ment du tableau est associ\u00e9 \u00e0 une cl\u00e9 (son index dans le tableau). Si la cl\u00e9 n'est pas sp\u00e9cifi\u00e9, comme dans l'exemple plus haut, elle sera autog\u00e9n\u00e9r\u00e9 de fa\u00e7on incr\u00e9mentiel (0, 1, 2, etc...). Il est aussi possible de d\u00e9finir la cl\u00e9 de chaque item.</p> <pre><code>&lt;?php\n$monTableau = array(\n    1 =&gt; \"item1\",\n    2 =&gt; \"item2\",\n    3 =&gt; \"item3\",\n);\n\n$monTableau = [\n    \"fruits\" =&gt; [\"banane\", \"pomme\", \"raisin\"],\n    \"legumes\" =&gt; [\"carotte\", \"patate\", \"navet\"],\n];\n?&gt;\n</code></pre>"},{"location":"notes_de_cours/php/array/#acces-aux-elements-dun-tableau","title":"Acc\u00e8s aux \u00e9l\u00e9ments d'un tableau","text":"<p>On acc\u00e8de \u00e0 la valeur d'un \u00e9l\u00e9ment du tableau par sa cl\u00e9 ou son index</p> <pre><code>&lt;?php\n$monTableau = [\"item1\", \"item2\", \"item3\"];\necho $monTableau[0]; // \"item1\"\n\n$monTableau = [\n    \"fruits\" =&gt; [\"banane\", \"pomme\", \"raisin\"],\n    \"legumes\" =&gt; [\"carotte\", \"patate\", \"navet\"],\n];\necho $monTableau[\"legumes\"][1]; // \"patate\"\n?&gt;\n</code></pre>"},{"location":"notes_de_cours/php/array/#ajoutermodifiersupprimer-un-element","title":"Ajouter/modifier/supprimer un \u00e9l\u00e9ment","text":"<pre><code>&lt;?php\n$monTableau = [\"item1\", \"item2\", \"item3\"];\n\n// Pour ajouter un \u00e9l\u00e9ment au tableau, on donne ou non une cl\u00e9 libre \n$monTableau[] = \"item4\";\n$monTableau[4] = \"item5\";\n\n// Pour modifier un \u00e9l\u00e9ment, on doit donner la cl\u00e9 de l'\u00e9l\u00e9ment \u00e0 modifier\n$monTableau[4] = \"item5 modifi\u00e9\"\n\n// On supprime un item avec la fonction unset en sp\u00e9cifiant la cl\u00e9 de l'\u00e9l\u00e9ment \u00e0 supprimer\nunset($monTableau[4]);\n// Attention, si aucune cl\u00e9 n'est donn\u00e9e, c'est tout le tableau qui sera supprim\u00e9\nunset($monTableau);\n?&gt;\n</code></pre>"},{"location":"notes_de_cours/php/array/#boucle-sur-un-tableau","title":"Boucle sur un tableau","text":"<p>Pour boucler sur les \u00e9l\u00e9ments d'un tableau, on utilise foreach</p> <pre><code>&lt;?php\n$monTableau = [\n    \"prenom\" =&gt; \"Mathieu\",\n    \"nom\" =&gt; \"Frechette\",\n];\n\nforeach($monTableau as $item) {\n    echo \"$item\\n\";\n}\n/*\nMathieu\nFrechette\n*/\n\n// On peut aussi r\u00e9cup\u00e9rer la cl\u00e9 de chaque \u00e9l\u00e9ment\nforeach($monTableau as $cle =&gt; $valeur) {\n    echo \"$cle = $valeur\\n\";\n}\n/*\nprenom = Mathieu\nnom = frechette\n*/\n?&gt;\n</code></pre>"},{"location":"notes_de_cours/php/array/#deballer-un-tableau","title":"D\u00e9baller un tableau","text":"<p>En pr\u00e9fixant le tableau par trois points ( ...$monTableau), le tableau sera \"d\u00e9ball\u00e9\" lors de se d\u00e9finition, c'est \u00e0 dire qu'on aura acc\u00e8s \u00e0 tous les \u00e9l\u00e9ments du tableau. (Disponible depuis PHP 7.4.0)</p> <pre><code>&lt;?php\n$monTableau = [\"item1\", \"item2\", \"item3\"];\n\n// Copier le tableau\n$tableau2 = [...$monTableau]; // [\"item1\", \"item2\", \"item3\"]\n// Ajouter des \u00e9l\u00e9ments au tableau;\n$tableau3 = [\"item0\", ...$monTableau, \"item4\"]; \n// [\"item0, \"item1\", \"item2\", \"item3\", \"item4\"]\n\n// Fusionner des tableaux\n$tableau4 = [...$tableau2, ...$tableau3]; \n// [\"item1\", \"item2\", \"item3\", \"item0, \"item1\", \"item2\", \"item3\", \"item4\"]\n\n// On peut aussi l'utiliser avec une fonction qui retourne un tableau\nfunction getTableau() {\n    return [\"item5\", \"item6\"];\n}\n$tableau5 = [...getTableau(), \"item7\"]; //[\"item5\", \"item6\", \"item7\"] \n?&gt;\n</code></pre>"},{"location":"notes_de_cours/php/array/#array_filterarray-function","title":"Array_filter(array, function())","text":"<p>La fonction array_filter() permet de filtrer les \u00e9l\u00e9ments d'un tableau et d'envoyer le r\u00e9sultat dans un nouveau tableau. Array_filter() prend en param\u00e8tre le tableau sur lequelle effectuer le traitement et une fonction de Callback. On peut appeler une fonction existante ou bien directement la d\u00e9clarer \u00e0 l'int\u00e9rieur de array_filter(). Si la fonction retourne True, l'item sera ajout\u00e9 au nouveau tableau. </p> <pre><code>&lt;?php\n// Soit le tableau de nombre suivant\n$nombres = [1, 2, 3, 4, 5];\n// On veut cr\u00e9er un nouveau tableau avec uniquement les nombres impairs\n$nombresImpair = array_filter($nombres,\n    // array_filter va parcourir le tableau $nombres un item \u00e0 la fois\n    // chaque item va \u00eatre assign\u00e9 \u00e0 la variable $nombre.\n    function ($nombre) {\n        return $nombre % 2 === 1;\n    }\n);\n// [1, 3, 5]\n?&gt;\n</code></pre>"},{"location":"notes_de_cours/php/array/#array_mapfunction-array","title":"Array_map(function(), array)","text":"<p>La fonction array_map() permet d'appliquer une fonction sur chaque \u00e9l\u00e9ment d'un tableau et de retourner un nouveau tableau du r\u00e9sultat. Array_map() prends en param\u00e8tre la fonction de Callback et le tableau sur lequelle effectuer le traitement. On peut appeler une fonction existante ou bien directement la d\u00e9clarer \u00e0 l'int\u00e9rieur de array_map().</p> <pre><code>&lt;?php\n    // Soit le tableau de nombre suivant\n    $nombres = [10,12,14,13];\n    // On veut cr\u00e9er un tableau avec de ces nombres doubl\u00e9s\n    $nombresDouble = array_map(function ($nombre) {\n        return $nombre * 2;\n    }, $nombres);\n    // [20, 22, 28, 26]\n?&gt;\n</code></pre>"},{"location":"notes_de_cours/php/array/#reference","title":"R\u00e9f\u00e9rence","text":"<ul> <li>www.php.net/manual/fr/language.types.array.php</li> <li>www.w3schools.com/php/php_ref_array.asp</li> <li>www.php.net/manual/fr/ref.array.php</li> </ul>"},{"location":"notes_de_cours/php/file_get_contents/","title":"Effectuer un appel GET \u00e0 un service web","text":"<p>On peut utiliser la fonction native file_get_contents() pour faire un appel GET \u00e0 un api avec un url.</p> <pre><code>&lt;?php\n\n$url = 'https://api.chucknorris.io/jokes/random';\n\n$reponseEnJson = file_get_contents($url);\n/*\n{\n    \"categories\": [],\n    \"created_at\": \"2020-01-05 13:42:29.296379\",\n    \"icon_url\": \"https://assets.chucknorris.host/img/avatar/chuck-norris.png\",\n    \"id\": \"bESHJ3YrTEW638ky0rr3Yg\",\n    \"updated_at\": \"2020-01-05 13:42:29.296379\",\n    \"url\": \"https://api.chucknorris.io/jokes/bESHJ3YrTEW638ky0rr3Yg\",\n    \"value\": \"Chuck Norris doesn't need an axe or saw to cut down a tree -- he needs only his foot, or his fist, or his glare.\"\n}\n*/\n$objetReponse = json_decode($reponseEnJson);\n\necho $objetReponse-&gt;value;\n// Chuck Norris doesn't need an axe or saw to cut down a tree -- he needs only his foot, or his fist, or his glare.\n?&gt;\n</code></pre>"},{"location":"notes_de_cours/php/json/","title":"Manipulation de donn\u00e9es en JSON","text":""},{"location":"notes_de_cours/php/json/#json_encode","title":"json_encode()","text":"<p>Pour encoder un tableau en format JSON, on utilisera la fonction json_encode().</p> <pre><code>&lt;?php\n$monTableau = [\n    \"prenom\" =&gt; \"Mathieu\",\n    \"nom\" =&gt; \"Frechette\",\n];\necho json_encode($monTableau);\n/* \n{\n    \"prenom\":\"Mathieu\",\n    \"nom\":\"Frechette\"\n}\n*/\n\n$monTableauPlusComplexe = [\n    \"Resultats\" =&gt; [\n        [\n            \"prenom\" =&gt; \"Mathieu\",\n            \"nom\" =&gt; \"Frechette\",\n        ],\n        [\n            \"prenom\" =&gt; \"Anthony\",\n            \"nom\" =&gt; \"Frechette\",\n        ],\n    ]\n];\necho json_encode($monTableauPlusComplexe);\n/* \n{\n    \"Resultats\":[\n        {\n            \"prenom\":\"Mathieu\",\n            \"nom\":\"Frechette\"\n        },\n        {\n            \"prenom\":\"Anthony\",\n            \"nom\":\"Frechette\"\n        }\n    ]\n}\n*/\n?&gt;\n</code></pre>"},{"location":"notes_de_cours/php/json/#json_decode","title":"json_decode()","text":"<p>\u00c0 l'inverse, pour convertir un objet JSON en un objet ou un tableau associatif (avec des cl\u00e9s d\u00e9finies) on utilisera la fonction  json_decode(). Elle prend en param\u00eatre l'objet Json \u00e0 convertir et optionnellement un valeur boolean qui indique si on veut que soit cr\u00e9e un tableau associatif ou non. Par d\u00e9faut ce param\u00eatre prend la valeur false, ce qui cr\u00e9e un objet.</p> <pre><code>&lt;?php\n$jsonData = '{\"prenom\":\"Mathieu\",\"nom\":\"Frechette\"}';\n\n$objetUsager = json_decode($jsonData);\necho $objetUsager-&gt;prenom; // Mathieu\n\n$tableauUsager = json_decode($jsonData, true);\necho $tableauUsager[\"prenom\"]; // Mathieu\n?&gt;\n</code></pre>"},{"location":"notes_de_cours/php/json/#reference","title":"R\u00e9f\u00e9rence","text":"<ul> <li>json_encode()</li> <li>json_decode()</li> </ul>"},{"location":"notes_de_cours/react/axios_crud/","title":"Op\u00e9ration CRUD avec Axios","text":""},{"location":"notes_de_cours/react/axios_crud/#principe-de-base","title":"Principe de base","text":"<p>Il y a plusieurs fa\u00e7on de g\u00e9rer les r\u00e9sultats d\u2019op\u00e9rations CRUD depuis un api. Les exemples que je vais vous donner ici sont bas\u00e9 sur un api de gestion d\u2019une liste de livres et d\u2019un client React qui permet d\u2019effectuer toutes les op\u00e9rations CRUD avec Axios.</p> <p>On va avoir en permanence dans l\u2019objet state un tableau qui contient tous les livres. D\u00e8s qu\u2019on va effectuer une op\u00e9ration avec l\u2019api, sur un succ\u00e8s de la requ\u00eate, on va simplement modifier se tableau pour y appliquer les changements.</p> <ul> <li><code>SELECT</code> : on remplace le tableau par le r\u00e9sultat.</li> <li><code>INSERT</code> : on ajoute le nouveau livre au tableau.</li> <li><code>UPDATE</code> : on modifie l\u2019item du tableau selon le id du livre.</li> <li><code>DELETE</code> : on enl\u00e8ve du tableau le livre supprim\u00e9.</li> </ul> <p>En liant le tableau de l\u2019object state \u00e0 une composante qui l\u2019affiche, la mise \u00e0 jour de la liste s\u2019effectuera automatiquement. </p>"},{"location":"notes_de_cours/react/axios_crud/#exemples-des-differentes-operations","title":"Exemples des diff\u00e9rentes op\u00e9rations","text":""},{"location":"notes_de_cours/react/axios_crud/#selectionner-la-liste-de-livres","title":"S\u00e9lectionner la liste de livres","text":""},{"location":"notes_de_cours/react/axios_crud/#ajouter-un-livre","title":"Ajouter un livre","text":""},{"location":"notes_de_cours/react/axios_crud/#modifier-un-livre","title":"Modifier un livre","text":"<p>L'exemple ici va modifier la liste seulement si le livre modifi\u00e9 \u00e9tait d\u00e9j\u00e0 pr\u00e9sent. Dans le cas o\u00f9 on ferait la cr\u00e9ation du livre si le id sp\u00e9cifi\u00e9 n'existe pas, il faudrait adapt\u00e9 un peu le code pour ajouter le livre au tableau s'il a \u00e9t\u00e9 cr\u00e9\u00e9. On pourrait r\u00e9cup\u00e9rer par exemple le code de statut de la r\u00e9ponse et faire le traitement appropri\u00e9 (200 pour une modification, 201 pour une cr\u00e9ation) </p>"},{"location":"notes_de_cours/react/axios_crud/#supprimer-un-livre","title":"Supprimer un livre","text":""},{"location":"notes_de_cours/react/bind_function/","title":"Lier une fonction","text":"<p>Attention, si vous utilisez une fonction \"classique\" il faudra \"l'associer\" dans le constructeur pour pouvoir utiliser this. Vous pouvez contouner ce probl\u00e8me en utilisant une fonction fl\u00e9ch\u00e9e.</p> <pre><code>import React from \"react\";\n\nclass EditName extends React.Component {\n    constructor(props) {\n        super(props);\n        // Liaison de la fonction avec this\n        this.handleNameChange = this.handleNameChange.bind(this)\n    }\n\n    // La fonction \u00e0 lier\n    handleNameChange = function (event) {\n        this.props.changeName(event.target.value);\n    }\n\n    // Cette fonction n'a pas \u00e0 \u00eatre li\u00e9e\n    handleNameChangeArrow = (event) =&gt; {\n        this.props.changeName(event.target.value);\n    }\n\n    render() {\n        return (\n            // ...\n        )\n    }\n}\n\nexport default (EditName);\n</code></pre>"},{"location":"notes_de_cours/react/bind_function/#pour-en-savoir-plus","title":"Pour en savoir plus","text":"<ul> <li>https://reactjs.org/docs/faq-functions.html</li> <li>https://codeburst.io/binding-functions-in-react-b168d2d006cb</li> </ul>"},{"location":"notes_de_cours/react/component/","title":"Les composantes","text":"<p>Une composante est un module r\u00e9utilisable qui \u00ab affiche \u00bb une partie de l\u2019application. Par exemple, un composant \u00ab Tableau \u00bb qui est form\u00e9 de composant \u00ab Ligne de d\u00e9tail \u00bb qui sont compos\u00e9es de texte et de composants \u00ab Boutons \u00bb d\u2019actions. En r\u00e9sum\u00e9, c\u2019est une classe qui retourne du code html \u00e9crit en JSX via une fonction render().</p> <p>Un nom de composante doit commencer par une lettre majuscule.</p> <p>La classe est compos\u00e9 de trois partie de \u00ab base \u00bb : </p> <ul> <li>Une section import</li> <li>Ex: Import React from \u2018react\u2019; , pour utiliser les commandes react avec l\u2019Alias React (React.component par exemple)</li> <li>La d\u00e9finition de la classe qui \u00ab extends \u00bb React.component et qui contient une fonction render(). On pourra aussi y d\u00e9finir d\u2019autres fonctions et d\u00e9clarer des variables selon nos besoin.</li> <li>Une section export qui rendra accessible la classe ailleurs dans l'application.</li> <li><code>export default (NomDeLaClasse);</code></li> </ul> <p>Attention, la fonction render() doit retourner qu'un \u00e9l\u00e9ment HTML \"parent\". Par contre cet \u00e9l\u00e9ment peut contenir plusieurs \"enfants\".</p> <pre><code>// le return est invalide car il y a deux \u00e9l\u00e9ment au m\u00eame niveau\nrender() {\n    return (\n        &lt;h1&gt;Hello World&lt;/h1&gt;\n        &lt;p&gt;Vive React!&lt;/p&gt;\n    )\n}\n\n// Un fa\u00e7on de r\u00e9gler le probl\u00e8me serait d'englober les deux \u00e9l\u00e9ments \n// dans un autre\nrender() {\n    return (\n        &lt;div&gt;\n            &lt;h1&gt;Hello World&lt;/h1&gt;\n            &lt;p&gt;Vive React!&lt;/p&gt;\n        &lt;/div&gt;\n    )\n}\n</code></pre> <p>Pour utiliser une composante, on doit l'importer dans le fichier o\u00f9 on veut l'utiliser avec la commande import en d\u00e9but de fichier.</p> <p><pre><code>import NomDeLaClasse from \"./NomDuFichier\";\n</code></pre> Apr\u00e8s le <code>import</code> on inscrit le nom de la classe, c'est aussi le nom qu'on va utiliser dans le fichier. La valeur qu'on inscrit apr\u00e8s le <code>from</code> est le chemin et le nom fichier JavaScript o\u00f9 se trouve la classe. Remarquez qu'on ne doit pas inscrire l'extension du fichier. (.js)</p> <p>Ensuite on \u00e9crit le nom de la classe sous la forme d'une balise html <code>&lt;NomDeLaClasse /&gt;</code></p> <p>Exemple d'une composante simple</p> <pre><code>// Fichier HelloWorld.js\nimport React from 'react';\n\nclass HelloWorld extends React.Component {\n    render() {\n        return (\n            &lt;h1&gt;Hello World&lt;/h1&gt;\n        )\n    }\n}\n\nexport default (HelloWorld);\n</code></pre> <p>Et de son utilisation dans un autre fichier</p> <pre><code>// Fichier App.js\nimport './App.css';\nimport React from 'react';\nimport HelloWorld from './HelloWorld';\n\nclass App extends React.Component {\n  render(){\n\n    return (\n      &lt;div className=\"App\"&gt;\n        &lt;header className=\"App-header\"&gt;\n          &lt;HelloWorld /&gt;\n        &lt;/header&gt;\n      &lt;/div&gt;\n    );\n  }\n}\n\nexport default (App);\n</code></pre>"},{"location":"notes_de_cours/react/creation_projet/","title":"Cr\u00e9ation d'un projet React","text":"<p>Il y a plusieurs fa\u00e7on d'utiliser React dans nos application web. Dans le cadre de ce cours nous allons utiliser Create React App qui va cr\u00e9er pour nous on projet de \"d\u00e9part\" \u00e0 partir duquel nous pourrons construire nos application React.</p>"},{"location":"notes_de_cours/react/creation_projet/#prerequis","title":"Pr\u00e9requis","text":"<ul> <li>node.js (disponible en t\u00e9l\u00e9chargement ici)</li> <li>un terminal qui permet d'utiliser des commandes plus avanc\u00e9es (Git bash)</li> </ul>"},{"location":"notes_de_cours/react/creation_projet/#initialiser-notre-application","title":"Initialiser notre application","text":"<p>La commande suivante vous permet de cr\u00e9er votre application. Notez qu'on utilise la commande npx et non npm ici. Npx va t\u00e9l\u00e9charger le paquet demand\u00e9, l'ex\u00e9cuter et ensuite le supprimer. Il ne restera aucune trace du paquet sur le disque. Petite note, le nom du projet doit \u00eatre uniquement en lettre minuscule, les majuscules ne sont pas support\u00e9es.</p> <pre><code>npx create-react-app nomDuProjet\n</code></pre> <p>Un r\u00e9pertoire nomm\u00e9e nomduprojet sera cr\u00e9\u00e9 \u00e0 l'endroit o\u00f9 la commande a \u00e9t\u00e9 lanc\u00e9 avec \u00e0 l'int\u00e9rieur les fichiers de base de l'application React. Ensuite dans le r\u00e9pertoire du projet, la commande <code>npm start</code> va lancer l\u2019application.</p>"},{"location":"notes_de_cours/react/creation_projet/#structure-du-projet","title":"Structure du projet","text":"<ul> <li>Le point d\u2019entr\u00e9e de l\u2019application est le fichier src/index.js</li> <li>La page public/index.html sert quand \u00e0 elle de \u00ab support \u00bb pour le projet.</li> <li>La majeur partie du d\u00e9veloppement de l\u2019application se fera dans le r\u00e9pertoire src/.</li> <li>On va entre autre y cr\u00e9er les fichiers de composantes, id\u00e9alement dans un r\u00e9pertoire d\u00e9di\u00e9, src/components par exemple.</li> <li>Le fichier app.js est le composant maitre, on peut le laisser o\u00f9 il est.</li> <li>Certains fichiers des r\u00e9pertoires public et src ne sont pas n\u00e9cessaire, mais src/index.js et public/index.html doivent \u00eatre pr\u00e9sent. Pour les autres, c\u2019est selon vos besoin mais pour l\u2019instant on va les laisser l\u00e0.</li> </ul>"},{"location":"notes_de_cours/react/creation_projet/#lancer-le-projet","title":"Lancer le projet","text":"<p>Pour lancer l'application React, entrez la commande suivante dans un terminal \u00e0 la racine du projet <pre><code>npm start\n</code></pre></p> <p>Attention, on ne peut avoir qu'une application React qui \"roule\" en m\u00eame temps.</p>"},{"location":"notes_de_cours/react/creation_projet/#quitter-lapplication","title":"Quitter l'application","text":"<p>Pour pouvoir fermer le serveur de d\u00e9veloppement en tout temps, on va ajouter un script dans le fichier <code>package.json</code>. Dans la section scripts ajouter la ligne suivante <code>\"stop\": \"taskkill -F -IM node.exe\"</code></p> <pre><code>\"scripts\": {\n    ...\n    \"stop\": \"taskkill -F -IM node.exe\" \n  }\n</code></pre> <p>Pour fermer le serveur de d\u00e9veloppement et \"quitter\" l'application, vous n'avez qu'\u00e0 faire ctrl+c dans la m\u00eame fen\u00eatre de terminal qui roule le serveur. Si vous n'avez plus acc\u00e8s au terminal qui \u00e0 lancer le serveur, ouvrez un nouveau terminal et faites la commande  <pre><code>npm stop\n</code></pre></p>"},{"location":"notes_de_cours/react/creation_projet/#references","title":"R\u00e9f\u00e9rences","text":"<ul> <li>Create React App</li> <li>npm vs npx</li> </ul>"},{"location":"notes_de_cours/react/cycle_de_vie/","title":"Le cycle de vie d'un composant","text":"<p>Chaque composante a un cycle de vie qu\u2019on peut diviser en trois grandes \u00e9tapes :</p> <ul> <li>Chargement (Mounting) : C\u2019est ici que les composantes sont ajout\u00e9es au DOM et affich\u00e9es dans la page.</li> <li>Mise-\u00e0-jour (Updating) : Cette \u00e9tape est lanc\u00e9e quand l\u2019objet state ou props de la composante est modifi\u00e9.</li> <li>D\u00e9chargement (Unmounting) : Si on enl\u00e8ve une composante du DOM, cette \u00e9tape est alors effectu\u00e9e.</li> </ul>"},{"location":"notes_de_cours/react/cycle_de_vie/#chargement-mounting","title":"Chargement (Mounting)","text":"<p>Il y a quatres m\u00e9thodes qui sont ex\u00e9cut\u00e9s dans cette ordre lors du chargement</p> <ul> <li><code>constructor(props)</code> : Le constructeur de la classe, on y d\u00e9fini entre autre les valeurs initiales de l\u2019objet state.</li> <li><code>getDerivedStateFromProps(props, state)</code> : Appel\u00e9 juste avant d\u2019afficher la composante dans le DOM. </li> <li><code>render()</code> : Affiche la composante dans la page.</li> <li><code>componentDidMount()</code> : Appel\u00e9 apr\u00e8s avoir affich\u00e9 la composante dans le DOM. On y place le traitement \u00e0 faire une fois que la composante fait partie du DOM.</li> </ul>"},{"location":"notes_de_cours/react/cycle_de_vie/#references","title":"R\u00e9f\u00e9rences","text":"<ul> <li>https://fr.reactjs.org/docs/state-and-lifecycle.html</li> <li>https://www.w3schools.com/react/react_state.asp</li> </ul>"},{"location":"notes_de_cours/react/fetch_api/","title":"Consommer un service Web en React","text":"<ul> <li>On consomme un service web au moyen d\u2019un appel Ajax (asynchronous JavaScript and XML).</li> <li>Il y a plusieurs biblioth\u00e8ques de disponibles qu\u2019on peut utiliser avec notre application React : Axios, Jquery Ajax et Fetch</li> <li>Axios est simple d\u2019utilisation et est tr\u00e8s complet. Il dispose \u00e9galement d\u2019une bonne couverture m\u00eame sur les navigateurs plus anciens. </li> </ul>"},{"location":"notes_de_cours/react/fetch_api/#utilisation-de-axios","title":"Utilisation de Axios","text":"<p>Pour l'installation de Axios, ouvrez un terminal et \u00e0 la racine du projet dans lequel vous voulez l'utiliser entrez la commande suivante : </p> <pre><code>npm install axios\n</code></pre> <p>Il faut ensuite importer axios dans les fichiers js o\u00f9 on veut l\u2019utiliser.</p> <pre><code>import axios from 'axios\u2019;\n</code></pre> <p>Voici un exemple de la structure d'un appel \u00e0 un \"endpoint\" d'un api avec Axios</p> <pre><code>axios.get('/maroute')\n    .then((response) =&gt; {\n    // Traitement si succ\u00e8s\n    })\n    .catch((error) =&gt; {\n    // Traitement si erreur\n    })\n    .then(() =&gt; {\n    // Traitement qui sera toujours ex\u00e9cut\u00e9\n    }) \n</code></pre>"},{"location":"notes_de_cours/react/fetch_api/#quand-faire-lappel-ajax","title":"Quand faire l\u2019Appel AJAX?","text":"<ul> <li>Quand on voudra obtenir nos informations pour les afficher dans une composantes. Habituellement on va le faire dans la m\u00e9thode componentDidMount.</li> <li>Une fois les donn\u00e9es r\u00e9cup\u00e9r\u00e9es, on va utiliser setState pour mettre \u00e0 jour la composante.</li> </ul> <p>Exemple de r\u00e9cup\u00e9ration de donn\u00e9es au chargement du composant</p> <ul> <li>On importe axios dans l\u2019ent\u00eate du fichier</li> <li>Dans le constructeur, on cr\u00e9e un tableau vide qui va recevoir le r\u00e9sultat de l\u2019appel.</li> <li>On ajoute la m\u00e9thode <code>componentDidMount()</code> qui va faire l\u2019appel via Axios.</li> <li>Quand l\u2019appel r\u00e9ussi, on utilise <code>setState()</code> pour mettre \u00e0 jour notre tableau et la composante. </li> </ul> <pre><code>import React from 'react';\n// On importe la biblioth\u00e8que Axios\nimport axios from \"axios\";\n\nclass ListeUtilisasteur extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            // On initialise ici un tableau vide qui va contenir notre r\u00e9sultat\n            utilisateurs : [],\n        }\n    }\n\ncomponentDidMount() {\n    axios.get('https://jsonplaceholder.typicode.com/users')\n        .then((response) =&gt; {\n            const utilisateurs = response.data;\n            // On r\u00e9cup\u00e8re les donn\u00e9es re\u00e7ues et on modifie le tableau dans l'\u00e9tat\n            this.setState({utilisateurs : utilisateurs})\n        })\n}\n</code></pre> <p>On a vu que les appels \u00e0 un api se font de mani\u00e8re asynchrone, on ne peut donc pas \u00eatre assur\u00e9 que les donn\u00e9es seront disponible lors du premier rendu du composant. Une m\u00e9thode pour se prot\u00e9ger de cette \u00e9ventualit\u00e9 est de tester dans la fonction render si nos valeurs existe dans l'\u00e9tat local, ou bien ajouter une variable bool\u00e9enne qui devient vrai au succ\u00e9s de l'appel \u00e0 l'api.</p> <pre><code>import React from 'react';\nimport axios from \"axios\";\n\nclass ListeUtilisasteur extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            // isLodad est faux tant que l'appel n'est pas termin\u00e9\n            isLoaded: false,\n            utilisateurs : [],\n        }\n    }\n\n    componentDidMount() {\n        axios.get('https://jsonplaceholder.typicode.com/users')\n            .then((response) =&gt; {\n                const utilisateurs = response.data;\n                this.setState({\n                    utilisateurs : utilisateurs,\n                    isLoaded: true\n                })\n            })\n    }\n\n    render() {\n        if(!this.state.idLoaded){\n            return (\n                // HTML \u00e0 retourner tant que l'appel n'est pas termin\u00e9, un message \n                // de chargement par exemple\n            )\n        }\n\n        return (\n            // Le code \"r\u00e9gulier\"\n        )\n    }\n</code></pre>"},{"location":"notes_de_cours/react/fetch_api/#syntaxe","title":"Syntaxe","text":"<p>Il y a deux syntaxes possible pour l'utilisation de Axios, c'est selon votre pr\u00e9f\u00e9rence</p> <p>M\u00e9thode #1</p> <pre><code>axios.post('urlDeLaRoute', {\n    // donn\u00e9es en param\u00eatre dans le body\n    titre: 'Nouveau livre',\n    isbn: '123456'\n})\n.then((resultat) =&gt; {\n    // Traitement si l'appel a r\u00e9ussi\n})\n</code></pre> <p>M\u00e9thode #2</p> <pre><code>axios({\n    method: 'post',\n    url: 'urlDeLaRoute',\n    data: {\n        titre: 'Nouveau livre',\n        isbn: '123456'\n    }\n})\n.then((resultat) =&gt; {\n    // Traitement si l'appel a r\u00e9ussi\n})\n</code></pre>"},{"location":"notes_de_cours/react/fetch_api/#ajouter-des-informations-dans-lentete-de-la-requete","title":"Ajouter des informations dans l'ent\u00eate de la requ\u00e8te","text":"<p>Pour ajouter des informations dans l\u2019ent\u00eate de la requ\u00eate, comme par exemple pour l\u2019authentification, il suffit d\u2019utiliser la cl\u00e9 headers.</p> <pre><code>axios({\n    method: 'post',\n    url: 'urlDeLaRoute',\n    data: {\n        titre: 'Nouveau livre',\n        isbn: '123456'\n    },\n    headers: {\n        Authorization : 'Bearer monToken'\n    }\n})\n.then((resultat) =&gt; {\n    // Traitement si l'appel a r\u00e9ussi\n})\n</code></pre>"},{"location":"notes_de_cours/react/fetch_api/#recuperer-les-resultats","title":"R\u00e9cup\u00e9rer les r\u00e9sultats","text":"<p>Peu importe la syntaxe que vous utilisez, la valeur de la r\u00e9ponse va \u00eatre contenu dans la variable que vous d\u00e9clarez en param\u00e8tre du then() de l'appel.</p> <pre><code>axios.get('https://jsonplaceholder.typicode.com/users')\n    // Toute la r\u00e9ponse se situe dans la variable response d\u00e9clar\u00e9 ici\n    .then((response) =&gt; {\n        // Ensuite pour aller chercher le \"body\" de la r\u00e9ponse (ce qui nous int\u00e9resse), on doit utiliser data qui nous retourne un objet.\n        const utilisateurs = response.data;\n        this.setState({\n            utilisateurs : utilisateurs,\n            isLoaded: true\n        })\n    })\n</code></pre> <p>Prenons l'exemple suivant, le r\u00e9sultat de la requ\u00eatre est structur\u00e9 de cette fa\u00e7on : </p> <pre><code>{\n    \"nom\" : \"Fr\u00e9chette\",\n    \"prenom\" : \"Mathieu\"\n}\n</code></pre> <p>Je peux acc\u00e9der aux valeurs de cette fa\u00e7on <pre><code>axios.get('https://superapi.wow/users')\n    .then((response) =&gt; {\n        // utilisateur repr\u00e9sente mon objet r\u00e9ponse qui a les attributs nom et prenom.\n        const utilisateur = response.data;\n        this.setState({\n            nom : utilisateur.nom,\n            prenom : utilisateur.prenom\n        })\n    })\n</code></pre></p>"},{"location":"notes_de_cours/react/fetch_api/#creer-une-instance-daxios","title":"Cr\u00e9er une instance d\u2019axios","text":"<ul> <li>Permet de ne sp\u00e9cifier par exemple qu\u2019une fois l\u2019url de base et d\u2019ensuite n\u2019ajouter que la route</li> <li>Cr\u00e9ez-vous un fichier Javascript qui contiendra le code de l\u2019instance, ex. utils/Api.js</li> </ul> <pre><code>// Api.js\nimport axios from \"axios\";\n\nexport default axios.create({\n    baseURL: \"https://swh2022-libapi.herokuapp.com\",\n    responseType: \"json\",\n})\n</code></pre> <ul> <li>Ensuite on importe le fichier et on peut qu\u2019ajouter la route lors de l\u2019appel</li> </ul> <pre><code>// La localisation du fichier est \u00e0 ajuster\nimport api from '../utils/Api';\n\n// ...\n\n    componentDidMount() {\n        // Ici on change axios pour api, le terme qu'on a d\u00e9fini dans le import\n        api({\n            method: 'post',\n            // c'est ici qu'on peut seulement entrer la derni\u00e8re partie de l'url qui\n            // repr\u00e9sente la route au lieu d'avoir \u00e0 \u00e9crire \n            // https://swh2022-libapi.herokuapp.com/livres\n            url: '/livres',\n            data: {\n                titre: 'Nouveau livre',\n                isbn: '123456'\n            }\n        })\n        .then((resultat) =&gt; {\n            // Traitement si l'appel a r\u00e9ussi\n        }) \n    }\n\n// ...\n</code></pre> <p>Votre code sera plus clair et lisible mais l'avantage majeur est que si l'api change de serveur, vous aurez \u00e0 changer l'information qu'\u00e0 un endroit dans le code.</p>"},{"location":"notes_de_cours/react/fetch_api/#pour-aller-plus-loin","title":"Pour aller plus loin","text":"<ul> <li>La documentation de Axios : https://axios-http.com/docs/intro</li> </ul>"},{"location":"notes_de_cours/react/form/","title":"Gestions des formulaires HTML avec React","text":"<p>Les formulaires html poss\u00e8de d\u00e9j\u00e0 leur propre \u00ab \u00e9tat \u00bb interne. Si on veut utiliser les donn\u00e9es saisies dans nos composants React, on va cr\u00e9er ce qu\u2019on appelle un \u00ab composant contr\u00f4l\u00e9 \u00bb. Quand le champ du formulaire sera modifi\u00e9, sur l\u2019\u00e9v\u00e8nement onChange par exemple, on va mettre \u00e0 jour une variable dans le state du composant qui va \u00eatre \u00ab li\u00e9e \u00bb au champ. Ensuite l\u2019\u00e9v\u00e8nement submit va aussi \u00eatre intercept\u00e9 et trait\u00e9 dans le composant avec les donn\u00e9es de l\u2019objet state.</p>"},{"location":"notes_de_cours/react/form/#exemple","title":"Exemple","text":"<p>J\u2019ai un composant ListeLivres qui affiche un formulaire d\u2019ajout de livre et un tableau avec tous les livres. Le formulaire est un composant ainsi que chaque ligne du tableau de livres (FormAjouterLivre, LigneLivre). Je veux pouvoir ajouter un livre par le formulaire et que la liste de livres se mettre \u00e0 jour automatiquement.</p> <p></p> <p>Dans le composant principal ListeLivre je vais avoir ma liste de livres dans un tableau nomm\u00e9 books d\u00e9fini dans l\u2019objet state et aussi une fonction <code>addBook()</code> qui prendra en param\u00eatre un objet book qui contient les informations extrait du formulaire. </p> <p>La fonction <code>addBook()</code> va s\u2019occuper de faire l\u2019appel \u00e0 l\u2019api pour ajouter le livre et mettre \u00e0 jour le tableau Books de l\u2019objet state, ce qui va aussi mettre \u00e0 jour l\u2019affichage de la liste de livre.</p> <p>Dans le constructeur du composant, le tableau books est d\u00e9clar\u00e9. On doit aussi \u00ab binder \u00bb les fonctions pour qu\u2019elles soient reconnues, c\u2019est ce qui est fait \u00e0 la ligne <code>this.addBook = this.addBook.bind(this);</code>.</p> <pre><code>// Extrait de la classe ListeLivre\nconstructor(props) {\n    super(props);\n    this.state = {\n        books: []\n    };\n\n    this.addBook = this.addBook.bind(this);\n}\n</code></pre> <p>Dans la fonction <code>addBook()</code>, on fait l\u2019appel \u00e0 l\u2019Api pour ajouter le livre et ensuite sur un r\u00e9sultat positif on ajoute le nouveau livre dans le tableau books de l\u2019objet state. Dans le r\u00e9sultat, on commence par ajouter le id du nouveau livre dans l\u2019objet book re\u00e7u en param\u00e8tre. Ensuite on cr\u00e9e un nouveau tableau avec le tableau books auquel on ajoute l\u2019objet book. Finalement on met le tableau books de l\u2019objet state \u00e0 jour.</p> <pre><code>// Extrait de la classe ListeLivre\naddBook(book) {\n    api({\n        method: 'POST',\n        url: '/books',\n        data: {\n            genreId: book.genreId,\n            titre: book.titre,\n            isbn: book.isbn\n        }\n    })\n        .then((resultat) =&gt; {\n            book.id = resultat.data.id;\n            const books = [...this.state.books, book];\n            this.setState({books: books});\n    });\n}\n</code></pre> <p>\u00c9tant donn\u00e9 que la gestion de l\u2019ajout se fait dans le composant ListeLivre et que la gestion du formulaire est dans FormAjouterLivre, quand on appelle FormAjouterLivre on doit lui passer en param\u00e8tre la fonction <code>addBooks()</code> pour pouvoir l\u2019utiliser.</p> <pre><code>&lt;FormAjouterLivre addBook={this.addBook}/&gt;\n</code></pre> <p>Dans le composant FormAjouterLivre, je d\u00e9finis les variables dans le state qui contiendront les valeurs du formulaire. Je me suis aussi cr\u00e9\u00e9 trois fonction : </p> <ul> <li><code>handleChange</code>, qui va modifier les variables du state quand un contr\u00f4le du formulaire sera modifi\u00e9.</li> <li><code>handleSubmit</code>, qui va appel\u00e9 la fonction addBook du composant ListeLivres re\u00e7u en props.</li> <li><code>clearImputs</code>, qui va simplement r\u00e9initialiser les variables state et en m\u00eame temps les contr\u00f4les du formulaire.</li> </ul> <p>Ensuite dans le formulaire, je relis la fonction <code>handleSubmit</code> \u00e0 l\u2019\u00e9v\u00e9nement onSubmit de la balise form et <code>handleChange</code> \u00e0 l\u2019\u00e9v\u00e9nement onChange de chaque input. Les variables titre, genreId et isbn vont contenir les valeurs des inputs du m\u00eame nom. Ensuite je bind les fonctions utilis\u00e9es.</p> <pre><code>// Constructeur de la classe FormAjouterLivre\nconstructor(props) {\n    super(props);\n    this.state = {\n        titre: '',\n        genreId: '',\n        isbn: '',\n    };\n\n    this.handleChange = this.handleChange.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.clearInput = this.clearInput.bind(this);\n}\n</code></pre> <p>Dans la fonction handleChange, le code suivant permet de mettre \u00e0 jour la variable de l\u2019objet state qui a le m\u00eame nom que le input du formulaire. Pour que \u00e7a fonctionne, il faut que la propri\u00e9t\u00e9 name du input soit du m\u00eame nom que la variable. On aurait aussi pu faire une fonction handleChange par input mais \u00e7a ajoute beaucoup de code pour rien. Ex. handleTitreChange qui met \u00e0 jour this.state.titre.</p> <pre><code>handleChange(event) {\n    const name = event.target.name;\n    const value = event.target.value;\n\n    this.setState({\n        [name]: value\n    });\n}\n</code></pre> <p>Dans la fonction handleSubmit, je cr\u00e9e un objet book avec les valeurs de l\u2019objet state et ensuite j\u2019appelle la fonction addBook re\u00e7u en param\u00e8tre. J\u2019emp\u00eache aussi le comportement par d\u00e9faut du submit avec <code>event.preventDefault();</code> </p> <pre><code>handleSubmit(event) {\n    const book = {\n        titre: this.state.titre,\n        genreId: this.state.genreId,\n        isbn: this.state.isbn,\n    };\n    this.props.addBook(book);\n\n    event.preventDefault();\n    this.clearInput();\n}\n</code></pre> <p>Finalement j\u2019appelle la fonction <code>clearInput</code> qui s\u2019occupe de r\u00e9initialiser les variables.</p> <pre><code>clearInput() {\n    this.setState({\n        titre: '',\n        genreId: '',\n        isbn: '',\n    });\n}\n</code></pre> <p>Voici une partie du formulaire </p> <pre><code>&lt;form onSubmit={this.handleSubmit}&gt;\n    &lt;table className='BooksTable'&gt;\n        &lt;tbody&gt;\n            &lt;tr&gt;\n                &lt;td&gt;&lt;label&gt;Titre :&lt;/label&gt;&lt;/td&gt;\n                &lt;td&gt;\n                    &lt;input\n                        type=\"text\"\n                        id=\"titre\"\n                        name=\"titre\"\n                        value={this.state.titre}\n                        onChange={this.handleChange}\n                        /&gt;\n                &lt;/td&gt;\n            &lt;/tr&gt;\n</code></pre> <p>Voil\u00e0 une fa\u00e7on de g\u00e9rer les formulaires et faire un ajout via un appel \u00e0 notre api. Les fichiers de mes composantes ListeLivres et FormAjouterLivre sont disponible ici pour consultation : </p> <ul> <li>ListeLivres.js</li> <li>FormAjouterLivre.js</li> </ul>"},{"location":"notes_de_cours/react/form/#source","title":"Source","text":"<ul> <li>https://fr.reactjs.org/docs/forms.html</li> <li>https://www.w3schools.com/react/react_forms.asp</li> </ul>"},{"location":"notes_de_cours/react/infinite_loop/","title":"Boucle infinie de la folie","text":"<p>Je vous expose ici un probl\u00e8me de boucle infinie qu'on a rencontr\u00e9 quand on code une application en React. En Javascript, quand on veut \"brancher\" une fonction \u00e0 un \u00e9v\u00e8nement, on utilise simplement le nom de la fonction sans les parenth\u00e8ses : </p> <pre><code>&lt;button className='bouton' onClick={this.incrementeCompteur}&gt;Cliquez-moi, svp&lt;/button&gt;\n</code></pre> <p>Ici la fonction incrementeCompteur sera ex\u00e9cut\u00e9e quand on cliquera sur le bouton. Par contre si on fait une erreur et qu'on inclus les parenth\u00e8ses \u00e0 notre nom de fonction elle sera ex\u00e9cut\u00e9e automatiquement au chargement de la page : </p> <pre><code>&lt;button className='bouton' onClick={this.incrementeCompteur()}&gt;Cliquez-moi, svp&lt;/button&gt;\n</code></pre> <p>Ensuite si dans la fonction on fait une modification \u00e0 l'\u00e9tat de notre composante React, avec par exemple this.setState({...}), la m\u00e9canique de React lancera un r\u00e9affichage de la page... et la fonction sera ex\u00e9cut\u00e9e \u00e0 nouveau. Par chance React se prot\u00e8ge contre ce cas particulier et une erreur lev\u00e9e indiquant le probl\u00e8me. </p> <p>Mais si dans la fonction on lance un traitement asynchrone, comme on le fait par exemple quand on lance une requ\u00eate \u00e0 un api, et qu'\u00e0 la fin du traitement on fait une modification \u00e0 l'\u00e9tat il se cr\u00e9e une boucle infinie. </p> <p>Pour stopper la boucle, fermez votre navigateur et arr\u00eatez le serveur React.</p> <p>Voici un exemple de code qui reproduit le probl\u00e8me : </p> <pre><code>  incrementeCompteur = () =&gt; {\n    // Pour l'exemple j'utilise un timout qui lance un traitement asynchrone\n    incrementeCompteur = () =&gt; {\n        setTimeout(() =&gt; {\n        this.setState({compteur: this.state.compteur + 1});\n        }, 250); \n    } \n  }\n\n  render() {\n    return (\n      &lt;section&gt;\n        &lt;div className='conteneur-principale'&gt;\n          &lt;h1&gt;Infinite loop of madness&lt;/h1&gt;\n          &lt;span className='compteur'&gt;{this.state.compteur}&lt;/span&gt;\n          &lt;button className='bouton' onClick={this.incrementeCompteur()}&gt;Cliquez-moi, svp&lt;/button&gt;\n        &lt;/div&gt;  \n      &lt;/section&gt;\n    );\n  }\n</code></pre> <p>Donc en r\u00e9sum\u00e9, jamais de parenth\u00e8se quand vous liez une fonction \u00e0 un \u00e9v\u00e9nement</p>"},{"location":"notes_de_cours/react/introduction/","title":"Introduction \u00e0 React","text":"<p>Une librairie \"front-end\"</p> <p>Essentiellement React est une librairie javascript \u00ab front-end \u00bb qui se concentre sur la gestion de l\u2019interface utilisateur. C\u2019est un projet \u00ab open-source \u00bb pilot\u00e9 par Facebook depuis 2013. Le concept g\u00e9n\u00e9ral de React est de permettre la cr\u00e9ation d'application web dont on peut \"rafraichir\" seulement le contenu d\u00e9sir\u00e9. </p> <p>React propose une approche bas\u00e9e sur des composantes</p> <p>Un application React sera en fait une arborescence de composants r\u00e9utilisables.</p> <p></p> <p>DOM virtuel</p> <p>Utilise le concept de DOM virtuel : les changements au DOM r\u00e9el ne sont appliqu\u00e9s qu\u2019au bon moment en minimisant le nombres d\u2019op\u00e9rations pour optimiser les performances.</p> <p>Applique le principe \u00ab Les donn\u00e9es descendent, l\u2019\u00e9tat remonte\u00bb</p> <p>Un composant parent peut \"passer\" des donn\u00e9es \u00e0 un composant enfant, mais le composant enfant ne peut faire \"remonter\" ces donn\u00e9es. On va utiliser plut\u00f4t utiliser des fonctions. </p> <p>React Developper Tools</p> <p>Pour vous aider dans le d\u00e9veloppement, installez l\u2019extension React Developper Tools pour votre navigateur.</p>"},{"location":"notes_de_cours/react/introduction/#references","title":"R\u00e9f\u00e9rences","text":""},{"location":"notes_de_cours/react/introduction/#documentation-officiel","title":"Documentation officiel","text":"<ul> <li>https://fr.reactjs.org/</li> </ul>"},{"location":"notes_de_cours/react/introduction/#tutoriels","title":"Tutoriels","text":"<ul> <li>https://developer.mozilla.org/en-US/docs/Learn/Tools_and_testing/Client-side_JavaScript_frameworks/React_getting_started</li> <li>https://www.w3schools.com/react/default.asp</li> <li>https://fr.reactjs.org/tutorial/tutorial.html</li> <li>https://www.freecodecamp.org/learn/front-end-development-libraries/react/</li> </ul>"},{"location":"notes_de_cours/react/introduction/#cours-en-ligne","title":"Cours en ligne","text":"<ul> <li>https://openclassrooms.com/fr/courses/4664381-realisez-une-application-web-avec-react-js/4664388-decouvrez-lutilite-et-les-concepts-cles-de-react</li> </ul>"},{"location":"notes_de_cours/react/liste_component/","title":"Afficher une liste de composantes identiques","text":""},{"location":"notes_de_cours/react/liste_component/#comment-afficher-une-serie-de-composants-au-moyen-dune-boucle","title":"Comment afficher une s\u00e9rie de composants au moyen d\u2019une boucle?","text":"<ul> <li>Quand on veut afficher une s\u00e9rie de composantes identiques, il est plus pertinent de le faire au moyen d\u2019une boucle que de r\u00e9p\u00e9ter x fois la balise du composant. C\u2019est d\u2019autant plus vrai quand on ne connait pas d\u2019avance le nombre de composants qu\u2019on voudra afficher.</li> <li>Le principe est de cr\u00e9er un tableau de composants et d\u2019ensuite l\u2019appeler quand on veut l\u2019afficher.</li> <li>Pour \u00ab remplir \u00bb le tableau, on peut utiliser une boucle for, foreach ou bien array.map selon la situation.</li> <li>On doit aussi ajouter un attribut key avec une valeur unique quand on ajoute la composante pour permettre \u00e0 React de bien les diff\u00e9rencier.</li> </ul> <p>Exemple </p> <pre><code>&lt;Todo id={task.id} name={task.name} completed={task.completed} key={task.id} /&gt;\n</code></pre> <p>L'erreur qui est affich\u00e9 si on ne donne pas le param\u00e8tre <code>key</code></p> <p></p>"},{"location":"notes_de_cours/react/liste_component/#creer-un-tableau-de-composantes","title":"Cr\u00e9er un tableau de composantes","text":"<p>Voici deux exemples, le premier avec une boucle forEach et le second avec la fonction array.map.</p> <pre><code>let lignesTableau = [];\n\n// La classe re\u00e7oit en param\u00e8tre un tableau livres\n// LigneTableau est une composante \nthis.props.livres.forEach(function(livre) {\n    lignesTableau.push(&lt;LigneTableau livre={livre} key={livre.id}/&gt;);\n});\n// ou avec une fonction fl\u00e9ch\u00e9e\nthis.props.livres.forEach(book =&gt; lignesTableau.push(&lt;LigneTableau livre={livre} key={livre.id}/&gt;));\n</code></pre> <pre><code>const lignesTableau = this.props.livres.map(livre =&gt; (&lt;LigneTableau book={livre} key={livre.id}/&gt;));\n</code></pre> <p>Dans les deux cas, on peut ensuite utiliser le tableau <code>lignesTableau</code> comme ceci</p> <pre><code>&lt;table className=\"BooksTable\"&gt;\n    &lt;thead&gt;\n        &lt;tr&gt;\n            &lt;th&gt;id&lt;/th&gt;\n            &lt;th&gt;Titre&lt;/th&gt;\n        &lt;/tr&gt;\n    &lt;/thead&gt;\n    &lt;tbody&gt;\n        {lignesTableau}\n    &lt;/tbody&gt;\n&lt;/table&gt;\n</code></pre>"},{"location":"notes_de_cours/react/materialui/","title":"Material UI","text":"<p>https://mui.com/</p>"},{"location":"notes_de_cours/react/props/","title":"Param\u00e8tres de composantes (props)","text":"<p>Les \u00ab props \u00bb sont des param\u00e8tres qu\u2019on \u00ab passe \u00bb aux composantes via des attributs html.</p> <pre><code>&lt;Helloworld name='Mathieu' /&gt; \n</code></pre> <p>La composante re\u00e7oit un objet props qui va contenir les attributs qu\u2019on lui envoie.</p> <pre><code>&lt;H1&gt;Hello, {this.props.name}&lt;/H1&gt;\n</code></pre> <p>Dans ces deux exemples, la balise H1 afficherait \"Hello, Mathieu\". Notez la syntaxe pour utiliser une variable avec JSX, il faut l\u2019entourer des caract\u00e8res { }.</p> <p>On peut envoyer ce qu\u2019on veut dans l\u2019objet prop : une variable, une constante, un tableau, un autre objet, une fonction, etc.</p> <p><pre><code>const infoUsager = {prenom: 'Mathieu', nom: 'Fr\u00e9chette'}\n// ...\n&lt;Helloworld usager={infoUsager} /&gt;\n</code></pre> et ensuite dans le composant HelloWorld</p> <pre><code>&lt;H1&gt;Hello, {this.props.usager.prenom} {this.props.usager.prenom}&lt;/H1&gt;\n</code></pre> <p>Si vous avez une fonction constructeur (constructor) dans votre classe composante, vous devez passer props en arguments de la fonction et utiliser la methode <code>super(props)</code>. <pre><code>constructor(props) {\n    super(props);\n    // ...\n}\n</code></pre></p> <p>Les props sont en lecture seule, on ne peut les modifier.</p>"},{"location":"notes_de_cours/react/react_notes/","title":"Notes sur React","text":"<ul> <li>Don't touch the dom</li> <li>Build website like lego blocks (component)</li> <li>Unidirectional data flow</li> <li>I'm just the UI, the rest is up to you</li> <li>Multiplatform, react native</li> </ul> <p>librairie de component</p> <ul> <li>Material</li> <li>Blueprint</li> </ul> <p>keywords</p> <ul> <li>Declarative</li> <li>JSX</li> <li>Components</li> <li>State</li> <li>Props</li> <li>Virtual Dom</li> </ul> <p>What make a good React Dev</p> <ul> <li>Decide on components</li> <li>Decide the state and where it lives</li> <li>What change when state changes</li> </ul> <p>npm vs npx</p> <ul> <li>npm t\u00e9l\u00e9charge et installe</li> <li>npx t\u00e9l\u00e9charge, ex\u00e9cute et supprimer ensuite, ne reste pas sur le disque</li> </ul> <p>Le point d'entr\u00e9e d'une application React est index.js</p>"},{"location":"notes_de_cours/react/react_notes/#installation","title":"Installation","text":"<ul> <li>Node 16.14.0 LTS (vient avec npm)</li> <li>gitbash</li> </ul>"},{"location":"notes_de_cours/react/react_notes/#create-react-app","title":"Create React App","text":"<p>https://fr.reactjs.org/docs/create-a-new-react-app.html</p>"},{"location":"notes_de_cours/react/react_notes/#react-scripts","title":"React-scripts","text":"<p>Pour se simplifier la vie, lance des scripts pour bien utiliser notre projet React. D\u00e9finie dans package.json sous \"scripts\", pour utiliser, on utilise npm ou yarn et le nom du script : <code>npm start</code>.</p> <ul> <li>start, lance l'application sur un serveur de d\u00e9veloppement local</li> <li>build, cr\u00e9e une version optimis\u00e9 de l'application, pour la distribuer et quelle soit la plus rapide possible.</li> <li>test, lance les fichiers \".test.js\"</li> <li>eject, pas touche!! Pour exclure des trucs du build? Je suis pas sur, mais c'est pas \u00e0 utiliser sauf dans des cas tr\u00e8s sp\u00e9cifique.</li> </ul>"},{"location":"notes_de_cours/react/react_notes/#classes-vs-hook","title":"Classes vs Hook","text":""},{"location":"notes_de_cours/react/remonter_data/","title":"Faire \"remonter\" des donn\u00e9es entre composant","text":"<p>On a vu qu'en React les \"donn\u00e9es descendent, l'\u00e9tat remonte\". En passant les donn\u00e9es en param\u00e8tre du composant parent au composant enfant on peut y acc\u00e9der avec l'objet props mais elles sont en lecture seule. Quand on veut faire remonter des donn\u00e9es dans l'autre sens on doit utiliser une fonction d\u00e9fini dans le composant parent et la passer elle aussi en param\u00e8tre au composant enfant. </p> <p>Prenons comme exemple l'affichage suivant qui est divis\u00e9 en deux composant parent / enfant : </p> <p></p> <p>La valeur du nom est stock\u00e9 dans l'\u00e9tat local de App.js. On veut pouvoir le modifier dans la zone de texte du composant EditName. Le composant App.js va passer en param\u00e8tre la valeur du nom mais il ne pourra pas \u00eatre modifi\u00e9 par le composant enfant car les props sont toujours en lecture seule. On va devoir cr\u00e9er une fonction dans App.js qui va modifier l'\u00e9tat de celui-ci et la passer en param\u00e8tre au composant EditName. Ensuite dans EditName on va associer une fonction \u00e0 l'\u00e9v\u00e9nement OnChange de la zone de saisie et dans cette fonction on va appeler la fonction re\u00e7u en param\u00e8tre par le composant App.</p> <p>App.js</p> <pre><code>import React from 'react';\nimport './App.css';\nimport EditName from './EditName';\n\nclass App extends React.Component {\n\n  constructor() {\n    super();\n    this.state = {\n      nom : \"World\"\n    };\n  }\n\n  // Fonction qui modifie la valeur de la variable nom de l'\u00e9tat local\n  handleChangeNameFromEdit = (nouveauNom) =&gt; this.setState({nom: nouveauNom});\n\n  render() {\n    return (\n      &lt;div className=\"App\"&gt;\n        &lt;h1&gt;Hello {this.state.nom}&lt;/h1&gt;\n        &lt;EditName \n          nom={this.state.nom}\n          // On transmet la fonction \u00e0 la composante EditName\n          changeName={this.handleChangeNameFromEdit} /&gt;\n      &lt;/div&gt;\n    )\n  }\n}\n\nexport default (App);\n</code></pre> <p>EditName.js</p> <pre><code>import React from \"react\";\n\nclass EditName extends React.Component {\n    constructor(props) {\n        super(props);\n    }\n\n    // La fonction va seulement ex\u00e9cuter la fonction re\u00e7u en param\u00eatre.\n    handleNameChange = (event) =&gt; {\n        this.props.changeName(event.target.value);\n    }\n\n    render() {\n        return (\n            &lt;div&gt;\n                &lt;label htmlFor='editName'&gt;Modifier le nom&lt;/label&gt;\n                &lt;input\n                    type=\"text\"\n                    id=\"editName\"\n                    name=\"editName\"\n                    value={this.props.nom}\n                    // On branche la fonctioni handleChangeName \u00e0 l'\u00e9v\u00e9nement onChange du editbox\n                    onChange={this.handleNameChange}\n                /&gt;    \n            &lt;/div&gt;\n        )\n    }\n}\n\nexport default (EditName);\n</code></pre> <p>Attention, si vous utilisez une fonction \"classique\" (pas une fonction fl\u00e8ch\u00e9e) il faudra \"l'associer\" dans le constructeur pour pouvoir utiliser this. </p> <pre><code>import React from \"react\";\n\nclass EditName extends React.Component {\n    constructor(props) {\n        super(props);\n        // Liaison de la fonction avec this\n        this.handleNameChange = this.handleNameChange.bind(this)\n    }\n\n    // La fonction \u00e0 lier\n    handleNameChange = function (event) {\n        this.props.changeName(event.target.value);\n    }\n\n    render() {\n        return (\n            &lt;div&gt;\n                &lt;label htmlFor='editName'&gt;Modifier le nom&lt;/label&gt;\n                &lt;input\n                    type=\"text\"\n                    id=\"editName\"\n                    name=\"editName\"\n                    value={this.props.nom}\n                    onChange={this.handleNameChange}\n                /&gt;    \n            &lt;/div&gt;\n        )\n    }\n}\n\nexport default (EditName);\n</code></pre>"},{"location":"notes_de_cours/react/routing/","title":"Routage","text":"<p>Source</p> <ul> <li>https://reactrouter.com/</li> <li>https://v5.reactrouter.com/web/guides/quick-start</li> <li>https://www.digitalocean.com/community/tutorials/how-to-handle-routing-in-react-apps-with-react-router</li> <li>https://medium.com/the-andela-way/understanding-the-fundamentals-of-routing-in-react-b29f806b157e</li> </ul>"},{"location":"notes_de_cours/react/snippet/","title":"Extraits de code utile pour React","text":"<p>Question d'acc\u00e9l\u00e9rer votre travail, voici un extrait de code que vous allez r\u00e9utiliser souvent : </p> <pre><code>import React from 'react';\n\n\nclass NomComponent extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {};\n    }\n\n    render() {\n        return (\n\n        );\n    }\n}\n\nexport default NomComponent;\n</code></pre>"},{"location":"notes_de_cours/react/state/","title":"L'\u00e9tat local d'un composant (state)","text":"<ul> <li>Chaque composant React \u00e0 un object state cr\u00e9\u00e9 par d\u00e9faut.</li> <li>Dans cet objet on va stocker les propri\u00e9t\u00e9s qui sont propre au composant. </li> <li>Quand l\u2019objet change, qu\u2019on change une de ces propri\u00e9t\u00e9s, le composant est r\u00e9afficher dans la page.</li> <li>On doit initialiser les propri\u00e9t\u00e9s de state dans le constructeur</li> </ul> <pre><code>constructor(props) {\n    super(props);\n    this.state = {titre: this.props.titre, note: 4};\n}\n</code></pre> <ul> <li>On y fait r\u00e9f\u00e9rence avec this : <code>this.state.titre</code></li> </ul>"},{"location":"notes_de_cours/react/state/#modification-de-letat","title":"Modification de l'\u00e9tat","text":"<p>Pour modifier la valeur de state on doit utiliser la fonction <code>setSate()</code></p> <pre><code>this.setState({note: 5});\n</code></pre> <p>On n\u2019est pas oblig\u00e9 d\u2019inclure toutes les propri\u00e9t\u00e9s de state, seulement celle que l\u2019on veut changer. Par contre on ne doit pas modifier directement une valeur de l'\u00e9tat sinon le composant ne sera pas r\u00e9affich\u00e9.</p> <pre><code>// \u00c0 ne pas faire\nthis.state.note = 5;\n</code></pre> <p>La fonction <code>setState()</code> peut aussi aussi accepter une fonction en param\u00e8tre au lieu d'un objet (notez ici qu'on n'est pas oblig\u00e9 d'utiliser this) : </p> <pre><code>// Dans cet exemple on voudrait augmenter la note d'une valeur re\u00e7u en \n// param\u00e8tre par le composant\nthis.setState((state, props) =&gt; ({\n        note: state.note + props.increment\n    }));\n</code></pre> <p>R\u00e9f\u00e9rences</p> <ul> <li>https://fr.reactjs.org/docs/state-and-lifecycle.html</li> <li>https://www.w3schools.com/react/react_state.asp</li> </ul>"},{"location":"notes_de_cours/slim/devilbox/","title":"Configurer un projet SLIM avec Devilbox","text":""},{"location":"notes_de_cours/slim/devilbox/#creation-du-virtual-host","title":"Cr\u00e9ation du \"Virtual Host\"","text":"<p>Cr\u00e9ez le r\u00e9pertoire qui va contenir votre projet dans le sous r\u00e9pertoire data/www de votre dossier Devilbox. Allez ensuite ajouter une entr\u00e9e dans le fichier hosts de Windows (C:\\Windows\\System32\\drivers\\etc\\hosts) avec le nom du dossier qui va conternir le projet suivi de .loc</p> <pre><code>127.0.0.1 nomDossierProjet.loc\n</code></pre>"},{"location":"notes_de_cours/slim/devilbox/#creation-dun-symlink","title":"Cr\u00e9ation d'un Symlink","text":"<p>Habituellement avec Devilbox on cr\u00e9e un sous-dossier htdocs qui contient notre fichier index.php. Avec Slim notre fichier index.php se retrouve dans le sous-r\u00e9pertoire public. Au lieu de cr\u00e9er un r\u00e9pertoire nomm\u00e9 htdocs on va cr\u00e9er \u00e0 la place un symlink du m\u00eame nom qui va pointer sur le r\u00e9pertoire public. En ligne de commande \u00e0 la racine de votre projet entrez la commande suivante </p> <pre><code>ln -s public/ htdocs\n</code></pre> <p>source</p>"},{"location":"notes_de_cours/slim/logger_factory/","title":"LoggerFactory.php","text":"<pre><code>&lt;?php\n\n// Source : https://odan.github.io/2020/05/25/slim4-logging.html\n\nnamespace App\\Factory;\n\nuse Monolog\\Formatter\\LineFormatter;\nuse Monolog\\Handler\\RotatingFileHandler;\nuse Monolog\\Handler\\StreamHandler;\nuse Monolog\\Logger;\nuse Psr\\Log\\LoggerInterface;\n\n/**\n * Factory.\n */\nfinal class LoggerFactory\n{\n    /**\n     * @var string\n     */\n    private $path;\n\n    /**\n     * @var int\n     */\n    private $level;\n\n    /**\n     * @var array&lt;mixed&gt; Handler\n     */\n    private $handler = [];\n\n    /**\n     * @var LoggerInterface|null\n     */\n    private $testLogger;\n\n    /**\n     * The constructor.\n     *\n     * @param array&lt;mixed&gt; $settings The settings\n     */\n    public function __construct(array $settings)\n    {\n        $this-&gt;path = (string)$settings['path'];\n        $this-&gt;level = (int)$settings['level'];\n\n        // This can be used for testing to make the Factory testable\n        if (isset($settings['test'])) {\n            $this-&gt;testLogger = $settings['test'];\n        }\n    }\n\n    /**\n     * Build the logger.\n     *\n     * @param string|null $name The logging channel\n     *\n     * @return LoggerInterface The logger\n     */\n    public function createLogger(string $name = null): LoggerInterface\n    {\n        if ($this-&gt;testLogger) {\n            return $this-&gt;testLogger;\n        }\n\n        $logger = new Logger($name ?: uuid_create());\n\n        foreach ($this-&gt;handler as $handler) {\n            $logger-&gt;pushHandler($handler);\n        }\n\n        $this-&gt;handler = [];\n\n        return $logger;\n    }\n\n    /**\n     * Add rotating file logger handler.\n     *\n     * @param string $filename The filename\n     * @param int|null $level The level (optional)\n     *\n     * @return self The logger factory\n     */\n    public function addFileHandler(string $filename, int $level = null): self\n    {\n        $filename = sprintf('%s/%s', $this-&gt;path, $filename);\n        $nbFileMax = 7; // Nb de fichiers de log qui seront cr\u00e9\u00e9 avant d'\u00eatre supprim\u00e9, 0 = illimit\u00e9\n        $rotatingFileHandler = new RotatingFileHandler($filename, $nbFileMax, $level ?? $this-&gt;level, true, 0777);\n\n        // The last \"true\" here tells monolog to remove empty []'s\n        $rotatingFileHandler-&gt;setFormatter(new LineFormatter(null, null, false, true));\n\n        $this-&gt;handler[] = $rotatingFileHandler;\n\n        return $this;\n    }\n\n    /**\n     * Add a console logger.\n     *\n     * @param int|null $level The level (optional)\n     *\n     * @return self The logger factory\n     */\n    public function addConsoleHandler(int $level = null): self\n    {\n        $streamHandler = new StreamHandler('php://stdout', $level ?? $this-&gt;level);\n        $streamHandler-&gt;setFormatter(new LineFormatter(null, null, false, true));\n\n        $this-&gt;handler[] = $streamHandler;\n\n        return $this;\n    }\n}\n</code></pre>"},{"location":"notes_de_cours/slim/middleware/","title":"Les Middlewares","text":"<p>En terme g\u00e9n\u00e9ral, un middleware est un logiciel qui est ex\u00e9cut\u00e9 durant la communication entre deux applications. Au niveau des services web, les middlewares seront utilis\u00e9s principalement pour manipuler la requ\u00eate en entr\u00e9e et la r\u00e9ponse en sortie. </p> <p>Un exemple d'utilisation serait un syst\u00e8me d'authentification qui ne laisserait \"passer\" la requ\u00eate HTTP \u00e0 notre api seulement si elle est authentifi\u00e9 ad\u00e9quatement. </p>"},{"location":"notes_de_cours/slim/middleware/#comment-utiliser-des-middlewares-avec-slim","title":"Comment utiliser des middlewares avec SLIM?","text":"<p>Les middlewares forment des couches concentriques autour de l\u2019application. En commen\u00e7ant par le plus r\u00e9cent, la requ\u00eate les traverses un a un jusqu\u2019\u00e0 l\u2019application pour ensuite refaire le chemin inverse avec la r\u00e9ponse.</p> <p></p> <p>Chaque middleware impl\u00e9mente l\u2019interface middleware de PSR-15</p> <ul> <li><code>Psr\\Http\\Message\\ServerRequestInterface</code> \u2013 L\u2019objet requ\u00eate PSR-7</li> <li><code>Psr\\Http\\Server\\RequestHandlerInterface</code> \u2013 L\u2019objet request handler PSR-15</li> </ul> <p>On peut faire ce qu\u2019on veut de ces objets, mais on doit absolument retourner une instance de  <code>Psr\\Http\\Message\\ResponseInterface</code>. Il est aussi \u00e0 noter qu'on ne peut pas modifier la r\u00e9ponse qu'on aura intercept\u00e9e. Si on veut la modifier on doit en recr\u00e9er une autre.</p>"},{"location":"notes_de_cours/slim/middleware/#exemple-dun-middleware","title":"Exemple d'un middleware","text":"<ul> <li>Dans votre projet, cr\u00e9ez le r\u00e9pertoire <code>src/Middleware</code> si ce n'est pas d\u00e9j\u00e0 fait.</li> <li>Cr\u00e9ez ensuite dans ce r\u00e9pertoire le fichier <code>ExampleBeforeMiddleware.php</code> et copiez-y le code suivant : </li> </ul> <pre><code>&lt;?php\n// Source : https://www.slimframework.com/docs/v4/concepts/middleware.html\nnamespace App\\Middleware;\n\nuse Psr\\Http\\Message\\ServerRequestInterface as Request;\nuse Psr\\Http\\Server\\RequestHandlerInterface as RequestHandler;\nuse Slim\\Psr7\\Response;\n\nclass ExampleBeforeMiddleware\n{\n    /**\n     * Example middleware invokable class\n     *\n     * @param  ServerRequest  $request PSR-7 request\n     * @param  RequestHandler $handler PSR-15 request handler\n     *\n     * @return Response\n     */\n    public function __invoke(Request $request, RequestHandler $handler): Response\n    {\n        $response = $handler-&gt;handle($request);\n        $existingContent = (string) $response-&gt;getBody();\n\n        $response = new Response();\n        $response-&gt;getBody()-&gt;write('Voici la r\u00e9ponse -&gt; ' . $existingContent);\n\n        return $response;\n    }\n}\n</code></pre>"},{"location":"notes_de_cours/slim/middleware/#comment-empecher-le-traitement-de-la-requete","title":"Comment emp\u00eacher le traitement de la requ\u00eate?","text":"<p>Dans la fonction <code>__invoke()</code>, la ligne de code suivante sert \u00e0 ex\u00e9cuter la requ\u00eate : </p> <pre><code>$response = $handler-&gt;handle($request);\n</code></pre> <p>Donc pour tant que cette ligne n'est pas ex\u00e9cut\u00e9, la requ\u00eate ne l'est pas non plus. Il faut se rappeler par contre qu'on doit retourner une instance de  <code>Psr\\Http\\Message\\ResponseInterface</code>. Voici un exemple d'une fonction de validation d'un authentification et qui retournerait un code 401 si les informations de connexion ne sont pas valides.</p> <pre><code>public function __invoke(\n    Request $request, \n    RequestHandler $handler): ResponseInterface\n{        \n    // Extraction du token encod\u00e9 de l'ent\u00eate\n    $token = explode(' ', $request-&gt;getHeaderLine('Authorization'))[1] ?? '';\n\n    if (!$this-&gt;basicAuthValidation-&gt;isTokenValid($token)) {\n        // Si le token n'est pas valide, on retourne une r\u00e9ponse vide avec le code \n        // de statut 401\n        return $this-&gt;responseFactory-&gt;createResponse()\n            -&gt;withStatus(401, 'Unauthorized');\n    }\n\n    // Sinon on retourne la r\u00e9ponse originale\n    return $handler-&gt;handle($request);\n}\n</code></pre>"},{"location":"notes_de_cours/slim/middleware/#ou-ajouter-le-middleware-dans-notre-structure-de-projet","title":"O\u00f9 ajouter le middleware dans notre structure de projet?","text":"<p>On peut ajouter le middleware au niveau de l'application, sur une route ou sur un groupe de routes. </p> <p>Application </p> <p>Dans le fichier <code>config\\middleware.php</code>, il suffit d'ajouter la classe \u00e0 l'objet $app \u00e0 l'aide de la fonction add() : </p> <pre><code>&lt;?php\n\n// ...\nuse App\\Middleware\\ExampleBeforeMiddleware;\n\nreturn function (App $app) {\n    // ...\n\n    $app-&gt;add(ExampleBeforeMiddleware::class);\n\n    // ...\n};\n</code></pre> <p>Le middleware sera ex\u00e9cut\u00e9 pour chaque requ\u00eate http envoy\u00e9e vers notre api. Dans notre exemple, chaque r\u00e9ponse d\u00e9butera par le mot BEFORE : </p> <pre><code>Voici la r\u00e9ponse -&gt;  {\"success\":true,\"message\":\"Hello world!\"}\n</code></pre> <p>Sur une route ou un groupe de routes</p> <p>Dans le fichier <code>config\\route.php</code>, il suffit d'ajouter la classe \u00e0 l'objet $app sur la route ou le groupe de routes souhait\u00e9s \u00e0 l'aide de la fonction add() : </p> <pre><code>&lt;?php\n\n// ...\nuse App\\Middleware\\ExampleBeforeMiddleware;\n\nreturn function (App $app) {\n\n    $app-&gt;get('/', \\App\\Action\\HomeAction::class)-&gt;setName('home')\n        -&gt;add(ExampleBeforeMiddleware::class);\n\n    // ...\n};\n</code></pre> <p>Dans cet exemple, le middleware ne sera appliqu\u00e9 que sur la route <code>GET /</code>.</p>"},{"location":"notes_de_cours/slim/middleware/#source","title":"Source","text":"<ul> <li>https://www.slimframework.com/docs/v4/concepts/middleware.html</li> </ul>"},{"location":"notes_de_cours/slim/monolog/","title":"Utilisation de journaux d'\u00e9v\u00e8nements (Log files)","text":""},{"location":"notes_de_cours/slim/monolog/#pourquoi-utiliser-des-fichiers-log","title":"Pourquoi utiliser des fichiers log?","text":"<ul> <li>C'est une bonne fa\u00e7on de d\u00e9bugger les erreurs</li> <li>\u00c7a nous permet de \"voir\" ce qui se passe dans notre application, de suivre comment les usagers l'utilisent</li> <li>Pour garder une trace des op\u00e9rations effectu\u00e9s par le serveur</li> </ul> <p>Il y a plusieurs choix possible pour cr\u00e9er des fichiers log et les utiliser. Nous allons utiliser la librairie Monolog pour php.</p>"},{"location":"notes_de_cours/slim/monolog/#installation","title":"Installation","text":"<p>Vous pouvez retrouver la documentation de Monolog \u00e0 cette adresse : https://seldaek.github.io/monolog/. L'installation se fait via composer avec l'instruction suivante : </p> <pre><code>composer require monolog/monolog\n</code></pre>"},{"location":"notes_de_cours/slim/monolog/#integration-a-notre-projet-slim","title":"Int\u00e9gration \u00e0 notre projet SLIM","text":"<p>Dans notre projet de d\u00e9part nous avons d\u00e9j\u00e0 une classe nomm\u00e9 <code>LoggerFactory</code> qui s'occupe de la cr\u00e9ation des fichiers et de l'\u00e9criture dans ceux-ci. Elle est situ\u00e9 dans le r\u00e9pertoire <code>src/Factory</code> Pour son utilisation nous avons aussi besoin d'un g\u00e9n\u00e9rateur de UUID qu'on peut installer aussi via composer : </p> <pre><code>composer require symfony/polyfill-uuid\n</code></pre> <p>Normalement monolog et le g\u00e9n\u00e9rateur de uuid devrait d\u00e9j\u00e0 avoir \u00e9t\u00e9 install\u00e9 dans votre projet quand vous avec fait la commande <code>composer update</code> apr\u00e8s avoir clon\u00e9 le projet. Pour v\u00e9rifier le tout allez dans le fichier composer.json, vous devriez avoir les lignes suivantes : </p> <pre><code>{\n    \"require\": {\n        \"monolog/monolog\": \"^2.2\",\n        \"symfony/polyfill-uuid\": \"^1.22\",\n        ...\n    },\n    ...\n}\n</code></pre> <p>Une fois les deux d\u00e9pendances install\u00e9es : </p> <ul> <li>Cr\u00e9ez un r\u00e9pertoire nomm\u00e9 logs \u00e0 la racine de votre application</li> <li>Ajouter le nom de se r\u00e9pertoire dans le fichier <code>.gitignore</code> pour exclure de vos commit Git les fichiers de log que vous allez cr\u00e9er.</li> </ul> <pre><code>vendor/\nlogs/\n</code></pre> <ul> <li>Assurez-vous d'avoir les lignes suivantes dans le fichier <code>config/settings.php</code></li> </ul> <p><pre><code>// Logger settings\n$settings['logger'] = [\n    'name' =&gt; 'app',\n    // C'est ici qu'on indique dans quel r\u00e9pertoire sera les fichiers\n    // \u00e0 modifier si vous avez utiliser un autre nom\n    'path' =&gt; __DIR__ . '/../logs',\n    'filename' =&gt; 'app.log',\n    'level' =&gt; \\Monolog\\Logger::DEBUG,\n    'file_permission' =&gt; 0775,\n];\n</code></pre> - C'est tout ce qu'on aurait \u00e0 faire pour utiliser Monolog, mais on va rendre notre code plus robuste en cr\u00e9ant une classe qui va se charger de l'\u00e9criture dans diff\u00e9rents fichiers.</p> <ul> <li> <p>Cr\u00e9ez le fichier <code>src/Factory/LoggerFactory.php</code> et copier le code disponible ici. Votre projet comporte probablement d\u00e9j\u00e0 ce fichier, juste vous assurez qu'il est bien l\u00e0 et que le code y est.</p> </li> <li> <p>Dans le fichier <code>config/container.php</code>, ajoutez les lignes suivantes si elles n'y sont pas d\u00e9j\u00e0</p> </li> </ul> <pre><code>&lt;?php\n\nuse App\\Factory\\LoggerFactory; \n// ...\n\nreturn [\n\n    // ...\n\n    LoggerFactory::class =&gt; function (ContainerInterface $container) {\n        return new LoggerFactory($container-&gt;get('settings')['logger']);\n    },\n\n    // ...\n\n];\n</code></pre> <p>Si vous voulez \"logger\" les erreurs g\u00e9n\u00e9r\u00e9s par SLIM automatiquement, modifiez le fichier <code>config/middleware.php</code> de la fa\u00e7on suivante : </p> <pre><code>// Remplacer cette ligne\n$app-&gt;add(ErrorMiddleware::class);\n\n// Par ces lignes\n$loggerFactory = $app-&gt;getContainer()-&gt;get(\\App\\Factory\\LoggerFactory::class);\n// Le nom du fichier o\u00f9 les erreurs seront inscrites\n$logger = $loggerFactory-&gt;addFileHandler('error.log')-&gt;createLogger();\n$app-&gt;addErrorMiddleware(true, true, true, $logger);\n</code></pre>"},{"location":"notes_de_cours/slim/monolog/#utilisation-dans-notre-projet-slim","title":"Utilisation dans notre projet SLIM","text":"<p>Pour \u00e9crire dans un fichier de log depuis une classe de notre projet, on doit r\u00e9cup\u00e9rer un objet <code>LoggerFactory</code> pass\u00e9 en param\u00e8tre dans le constructeur de la classe. On peut ensuite utiliser cette objet pour \u00e9crire le message souhait\u00e9.</p> <p>Exemple avec la classe HomeAction</p> <pre><code>&lt;?php\n\nnamespace App\\Action;\n\nuse App\\Factory\\LoggerFactory; // \u00c0 ajouter\n// ...\n\nfinal class HomeAction\n{\n\n    /**\n     * @var LoggerInterface\n     */\n    private $logger;\n\n    public function __construct(LoggerFactory $loggerFactory)\n    {\n        $this-&gt;logger = $loggerFactory\n            // Le nom de fichier de log utilis\u00e9\n            -&gt;addFileHandler('hello.log')\n            // On peut passer du texte en parametre ici qui identifiera\n            // la ligne de log, sinon un UUID sera utilis\u00e9\n            -&gt;createLogger('MessageFromMath');\n    }\n\n    public function __invoke(\n        ServerRequestInterface $request, \n        ResponseInterface $response\n    ): ResponseInterface {\n\n        // ...\n        // C'est ici qu'on inscrit notre message\n        $this-&gt;logger-&gt;info('Hello world');\n\n        // ...\n    }\n}\n</code></pre> <p>Le r\u00e9sultat sera inscrit dans le fichier <code>hello-[date-du-jour].log</code></p> <pre><code>[2022-02-11T05:52:53.347534+01:00] 73c96cc8-4c6c-42d7-8a39-593ab0f964c6.INFO: Hello World  \n[2022-02-11T05:52:56.912031+01:00] MessageFromMath.INFO: Hello World \n</code></pre>"},{"location":"notes_de_cours/slim/monolog/#niveaux-de-severite-des-messages","title":"Niveaux de s\u00e9v\u00e9rit\u00e9 des messages","text":"<p>Quand on inscrit un message d'\u00e9v\u00e9nement, on lui attache un niveau de s\u00e9v\u00e9rit\u00e9. \u00c7a nous permet de cat\u00e9goriser les messages et m\u00eame dans omettre selon la configuration. Les diff\u00e9rents niveaux support\u00e9s par Monolog sont les suivants, trier par ordre d'importance : </p> <ul> <li>DEBUG - Message de d\u00e9bogage</li> <li>INFO - Message d'information</li> <li>NOTICE - Il est arriv\u00e9 un \u00e9v\u00e9nement important</li> <li>WARNING - Message d'avertissement mais pas d'erreur</li> <li>ERROR - Message d'erreur mais qui ne requiert pas d'action imm\u00e9diate</li> <li>CRITICAL - Message de condition critique</li> <li>ALERT - Erreur qui n\u00e9cessite une action imm\u00e9diate</li> <li>EMERGENCY - Alerte rouge</li> </ul> <p>Pour chacun des niveaux, il y a une fonction du m\u00eame nom \u00e0 utiliser</p> <pre><code>// Message d'information\n$this-&gt;logger-&gt;info(\"Ceci est un message d'information\");\n// Message d'erreur\n$this-&gt;logger-&gt;error(\"Ceci est un message d'erreur\");\n</code></pre> <p>Pour modifier le niveau minimum de s\u00e9v\u00e9rit\u00e9, c'est-\u00e0-dire \u00e0 partir de quel niveau le message sera inscrit dans le fichier, on doit changer la valeur de la cl\u00e9 <code>level</code> du tableau settings dans le fichier <code>config/settings.php</code></p> <pre><code>// Logger settings\n$settings['logger'] = [\n    'name' =&gt; 'app',\n    'path' =&gt; __DIR__ . '/../logs',\n    'filename' =&gt; 'app.log',\n    'level' =&gt; \\Monolog\\Logger::DEBUG, // Changer la valeur de level ici\n    'file_permission' =&gt; 0775,\n];\n</code></pre> <p>Si on change cette valeur pour <code>'level' =&gt; \\Monolog\\Logger::ERROR</code>, dans l'exemple plus haut seulement le message d'erreur sera inscrit, pas le message \"info\". L'utilit\u00e9 principale est qu'on peut contr\u00f4ler les messages \u00e0 retenir quand notre projet est d\u00e9ployer sur le Internet.</p>"},{"location":"notes_de_cours/slim/monolog/#source","title":"Source","text":"<ul> <li>https://odan.github.io/2020/05/25/slim4-logging.html</li> </ul>"},{"location":"notes_de_cours/slim/recuperer_params/","title":"R\u00e9cup\u00e9rer les param\u00e8tres d'une requ\u00eate HTTP","text":"<p>On a vu qu'il y a plusieurs m\u00e9thodes pour passer des param\u00e8tres dans une requ\u00eate HTML : dans la section \"query\" de l'url, directement dans l'url et dans le corps (body) de la requ\u00eate. SLIM nous permet de facilement r\u00e9cup\u00e9rer ces donn\u00e9es avec l'objet <code>ServerRequestInterface</code></p> <p>Cette objet est re\u00e7u en param\u00eatre de la fonction <code>_invoke</code> des classes \"action\" de notre api. </p> <pre><code>public function __invoke(\n    ServerRequestInterface $request, \n    ResponseInterface $response\n): ResponseInterface {\n\n    // Avec la variable $request nous avons acc\u00e8s aux param\u00e8tres\n    // ...\n}\n</code></pre>"},{"location":"notes_de_cours/slim/recuperer_params/#parametre-de-la-section-query","title":"Param\u00e8tre de la section \"query\"","text":"<p>La fonction <code>getQueryParams()</code> de l'objet <code>ServerRequestInterface</code> nous retourne un tableau associatif qui contient tous les param\u00e8tres. L'exemple suivant avec la route <code>/livres?page=1</code> nous montres comment r\u00e9cup\u00e9rer la valeur du param\u00e8tre <code>page</code></p> <pre><code>public function __invoke(\n    ServerRequestInterface $request, \n    ResponseInterface $response\n): ResponseInterface {\n    // R\u00e9cup\u00e9ration des param\u00e8tres dans un tableau\n    // S'il n'y a pas de param\u00e8tre, retourne un tableau vide\n    $queryParams = $request-&gt;getQueryParams() ?? [];\n    // R\u00e9cup\u00e9ration de la valeur du param\u00e8tre page\n    $page = $queryParams['page'] ?? 1;\n\n    //...\n}\n</code></pre>"},{"location":"notes_de_cours/slim/recuperer_params/#parametre-dans-la-route","title":"Param\u00e8tre dans la route","text":"<p>La fonction <code>getAttribute('nomDuParam\u00e8tre', valeurPardefaut)</code> de l'objet <code>ServerRequestInterface</code> nous retourne la valeur du param\u00e8tre demand\u00e9. Quand on d\u00e9fini notre route, les valeurs qui seront d\u00e9fini comme param\u00e8tre sont entour\u00e9es d'accolades. Prenons comme exemple la route <code>/livres/13</code> qui affichera le livre avec le id 13. Dans notre code la route sera d\u00e9finie comme ceci dans le fichier <code>route.php</code></p> <pre><code>// Le nom de la classe importe peu, ici c'est la description de la route qui est importante\n$app-&gt;get('/livres/{id}', \\App\\Action\\Book\\BookViewByIdAction::class);\n</code></pre> <p>Exemple d'utilisation de <code>getAttribute()</code></p> <pre><code>public function __invoke(\n    ServerRequestInterface $request, \n    ResponseInterface $response\n): ResponseInterface {\n    // R\u00e9cup\u00e9ration du param\u00e8tre de route 'id'\n    $id = $request-&gt;getAttribute('id', 0);\n\n    // ...\n}\n</code></pre>"},{"location":"notes_de_cours/slim/recuperer_params/#parametre-dans-le-corps-de-la-requete","title":"Param\u00e8tre dans le corps de la requ\u00eate","text":"<p>La fonction <code>getParsedBody()</code> de l'objet <code>ServerRequestInterface</code> nous retourne un tableau associatif qui contient tous les param\u00e8tres du corps de la requ\u00eate. Prenons comme exemple une requ\u00eate HTTP de cr\u00e9ation d'un livre qui aurait les valeurs suivantes : </p> <pre><code>{\n    \"genreId\": \"1\",\n    \"titre\": \"Mon livre\",\n    \"isbn\": \"123456789\"\n}\n</code></pre> <p>Pour r\u00e9cup\u00e9rer le titre avec <code>getParsedBody()</code></p> <pre><code>public function __invoke(\n    ServerRequestInterface $request, \n    ResponseInterface $response\n): ResponseInterface {\n    // R\u00e9cup\u00e9ration des donn\u00e9es du corps de la requ\u00eate\n    $data = (array)$request-&gt;getParsedBody();\n    // R\u00e9cup\u00e9ration de la valeur de titre\n    $titre = $data['titre'] ?? '';\n\n    // ...\n}\n</code></pre>"},{"location":"notes_de_cours/slim/structure/","title":"Structure de nos projet avec SLIM","text":"<p>Pour tous nos projet avec SLIM nous allons adopter la structure suivante.</p>"},{"location":"notes_de_cours/slim/structure/#structure-des-repertoires","title":"Structure des r\u00e9pertoires","text":"R\u00e9pertoire Description config/ Les fichiers de configurations public/ Les fichiers du serveur web src/ Le code de notre application vendor/ R\u00e9serv\u00e9 \u00e0 composer"},{"location":"notes_de_cours/slim/structure/#config","title":"config/","text":"Fichier Description bootstrap.php Initialise l'application container.php Initialisation du conteneur de l'application middleware.php Lancement des Middlewares routes.php On y d\u00e9clare les routes settings.php Information de configuration (\u00e0 la BD, fichiers de logs)"},{"location":"notes_de_cours/slim/structure/#public","title":"public/","text":"<p>Dans ce r\u00e9pertoire on retrouve le fichier index.php qui est la porte d'entr\u00e9e de notre application. Il va juste lancer le fichier bootstrap.php qui lui s'occupera de tout le reste.</p>"},{"location":"notes_de_cours/slim/structure/#src","title":"src/","text":"<p>C'est dans se r\u00e9pertoire qu'on va placer le code de notre application. Pour chaque route on va diviser le code en trois sections : </p> <ul> <li>Action : Re\u00e7oit la requ\u00eate, lance la bonne proc\u00e9dure et retourne la r\u00e9ponse \u00e0 l'usager.</li> <li>Service : La logique de notre code se fait ici. On valide les param\u00eatres, on lance une fonction \u00e0 la bd, on formate la r\u00e9ponse qu'on retourne \u00e0 l'action.</li> <li>Repository : C'est la couche de donn\u00e9es, on lance simplement les requ\u00eates \u00e0 la BD et retourne le r\u00e9sultat. On ne fait pas de logique ici.</li> </ul> <p>On va cr\u00e9er un fichier par \"Action\", dans le r\u00e9pertoire src/Action. Ensuite dans le r\u00e9psertoire src/Domain on va cr\u00e9er un sous-r\u00e9pertoire qui va regrouper nos services et \"repositories\" (donnez-lui un nom significatif). Ensuite dans ce r\u00e9pertoire on va avoir deux sous-r\u00e9pertoire, Service et Repository qui vont contenir les fichiers de ces deux types.</p> <p>Dans l'exemple suivant j'ai une route qui affiche un message de salutation (greeting) </p>"}]}